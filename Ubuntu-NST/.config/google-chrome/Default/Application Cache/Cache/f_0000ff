NU.prototype.CVa=fa(253,function(a){this.J=Pb(arguments,0)});function HV(a,b){return B(a,2,b)}function epc(a,b,c,d,e){return gyb(a,u(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.J,!0)},a))}function IV(a){Wh(this,a,0,-1,null)}w(IV,Vh);function JV(a){Wh(this,a,0,-1,null)}w(JV,Vh);var fpc=[3],gpc=[1],hpc=[1],ipc=[1],jpc=[1,2],kpc=[2];
function lpc(a,b){var c=yc(a,1)?a.If():Number.MIN_VALUE;a=yc(a,2)?a.Eg():Number.MAX_VALUE;var d=yc(b,1)?b.If():Number.MIN_VALUE;b=yc(b,2)?b.Eg():Number.MAX_VALUE;return b>c&&a>d||c==d&&a==b}function mpc(a){return kc(emc,function(b){return b.match(a)}).getName()}function npc(a){Wh(this,a,0,-1,null)}w(npc,Vh);npc.prototype.Nf=function(){return M(this,2)};function opc(a){Wh(this,a,0,-1,null)}w(opc,Vh);opc.prototype.getChartType=function(){return M(this,1)};function ppc(a){Wh(this,a,0,-1,null)}
w(ppc,Vh);function qpc(a){Wh(this,a,0,-1,fpc)}w(qpc,Vh);qpc.prototype.getChartType=function(){return M(this,1)};function rpc(a){Wh(this,a,0,-1,gpc)}w(rpc,Vh);function spc(a){Wh(this,a,0,-1,hpc)}w(spc,Vh);function tpc(a){Wh(this,a,0,-1,ipc)}w(tpc,Vh);function upc(a){Wh(this,a,0,-1,jpc)}w(upc,Vh);var vpc={gzc:0,NBa:1,jCa:2};function wpc(a){Wh(this,a,0,-1,kpc)}w(wpc,Vh);
var xpc={F4a:0,SUM:1,AVERAGE:2,Nga:3,T4a:4,Z3a:5,MEDIAN:6,COUNT:7,U3a:8,V3a:9},ypc={UNKNOWN_ERROR:0,Fzc:1,Cqc:2,ucc:3},zpc={tzc:0,Mcc:1,aga:2,pk:3,mzc:4,x4b:5,iec:6},Apc={rzc:0,FE:1,Iqc:2,nqc:3,Vsc:4},Bpc={nzc:0,Eqc:1,dK:2,Nnc:3},Cpc={dzc:0,Pyc:1,Qgc:2,Nxc:3,Mxc:4,F7b:5,Eoc:6},Dpc={Vwc:0,fK:1,z_a:2,Lyc:3,Fvc:4,P2a:5,Ezc:6,uza:7,rxa:8,Xxa:9,HISTOGRAM:10},Epc={UNKNOWN:0,n4b:1,m4b:2,l4b:3,t5b:4,d7b:5,z7b:6,Z$b:7,ndc:8,jpc:9,gtc:10,qtc:11,fxc:12,gxc:13,ryc:14,Isc:15};function KV(){A.call(this)}w(KV,A);var Fpc=null;KV.prototype.xm=function(){return B(this,1)};function LV(){A.call(this)}w(LV,A);var Gpc=null;LV.prototype.getText=function(){return B(this,1)};LV.prototype.Sr=function(){return yc(this,1)};function MV(){A.call(this)}w(MV,A);var Hpc=null;MV.prototype.getStatus=function(){return B(this,1)};MV.prototype.getError=function(){return B(this,9)};function NV(){A.call(this)}w(NV,A);var Ipc=null;function OV(){A.call(this)}w(OV,A);var Jpc=null;
function PV(){A.call(this)}w(PV,A);var Kpc=null;PV.prototype.tba=function(){return yc(this,1)};PV.prototype.getType=function(){return B(this,3)};PV.prototype.setType=function(a){C(this,3,a)};function QV(){A.call(this)}w(QV,A);var Lpc=null;function RV(){A.call(this)}w(RV,A);var Mpc=null;
KV.prototype.Qa=function(){var a=Fpc;a||(Fpc=a=Fc(KV,{0:{name:"Error",Nb:"ritz.assistant.Error"},1:{name:"message",Ma:9,type:String},2:{name:"code",Ma:14,defaultValue:0,type:ypc},3:{name:"unsupported_op_reason",Ma:14,defaultValue:0,type:zpc}}));return a};KV.Qa=KV.prototype.Qa;
LV.prototype.Qa=function(){var a=Gpc;a||(Gpc=a=Fc(LV,{0:{name:"AnswerQueryPhrase",Nb:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Ma:9,type:String},2:{name:"start_byte",Ma:5,type:Number},3:{name:"num_bytes",Ma:5,type:Number}}));return a};LV.Qa=LV.prototype.Qa;
MV.prototype.Qa=function(){var a=Hpc;a||(Hpc=a=Fc(MV,{0:{name:"AnswerResponse",Nb:"ritz.assistant.AnswerResponse"},1:{name:"status",Ma:5,type:Number},10:{name:"parse_status",Ma:14,defaultValue:0,type:Apc},11:{name:"answer_status",Ma:14,defaultValue:0,type:Bpc},2:{name:"formula",Ma:9,type:String},3:{name:"debug_parse_response",Ma:9,type:String},4:{name:"interpretation",Ma:9,type:String},5:{name:"debug_interpretation_response",Ma:9,type:String},6:{name:"unused_phrase",Uc:!0,Ma:11,type:LV},7:{name:"used_entity_phrase",
Uc:!0,Ma:11,type:LV},8:{name:"unused_entity_phrase",Uc:!0,Ma:11,type:LV},9:{name:"error",Ma:11,type:KV},12:{name:"alternate_suggestion",Uc:!0,Ma:11,type:PV},14:{name:"deprecated_formula_builder_used",Ma:9,type:String},15:{name:"answer_visualization_type",Uc:!0,Ma:14,defaultValue:0,type:Dpc},16:{name:"formula_builder_used",Ma:14,defaultValue:0,type:Epc},17:{name:"charting_info",Ma:11,type:OV},18:{name:"answer_field_info",Uc:!0,Ma:11,type:NV},19:{name:"charting_formula",Ma:9,type:String},21:{name:"parse_info",
Uc:!0,Ma:11,type:QV},22:{name:"answer_field_info_for_ranges",Uc:!0,Ma:11,type:NV}}));return a};MV.Qa=MV.prototype.Qa;NV.prototype.Qa=function(){var a=Ipc;a||(Ipc=a=Fc(NV,{0:{name:"AnswerFieldInfo",Nb:"ritz.assistant.AnswerFieldInfo"},1:{name:"cell_data_type",Ma:14,defaultValue:0,type:Fea},2:{name:"range_ref",Ma:9,type:String}}));return a};NV.Qa=NV.prototype.Qa;
OV.prototype.Qa=function(){var a=Jpc;a||(Jpc=a=Fc(OV,{0:{name:"ChartingInfo",Nb:"ritz.assistant.ChartingInfo"},1:{name:"suggested_type",Uc:!0,Ma:14,defaultValue:0,type:Dpc},2:{name:"recommended",Ma:8,type:Boolean},3:{name:"user_requested_type",Uc:!0,Ma:14,defaultValue:0,type:Dpc},4:{name:"show_only_chart",Ma:8,type:Boolean}}));return a};OV.Qa=OV.prototype.Qa;
PV.prototype.Qa=function(){var a=Kpc;a||(Kpc=a=Fc(PV,{0:{name:"QuerySuggestion",Nb:"ritz.assistant.QuerySuggestion"},1:{name:"query",Ma:9,type:String},2:{name:"formula",Ma:9,type:String},3:{name:"type",Ma:14,defaultValue:0,type:Cpc},4:{name:"deprecated_formula_builder_used",Ma:9,type:String},5:{name:"formula_builder_used",Ma:14,defaultValue:0,type:Epc}}));return a};PV.Qa=PV.prototype.Qa;
QV.prototype.Qa=function(){var a=Lpc;a||(Lpc=a=Fc(QV,{0:{name:"ParseInfo",Nb:"ritz.assistant.ParseInfo"},1:{name:"intent_info",Uc:!0,Ma:11,type:RV}}));return a};QV.Qa=QV.prototype.Qa;RV.prototype.Qa=function(){var a=Mpc;a||(Mpc=a=Fc(RV,{0:{name:"IntentInfo",Nb:"ritz.assistant.IntentInfo"},1:{name:"intent_type",Ma:14,defaultValue:0,type:xpc}}));return a};RV.Qa=RV.prototype.Qa;function SV(a,b,c,d,e,f){H.call(this,a,b);this.C=b;this.qa=c;this.Z=d||null;this.Pa=e||null;this.F=f||null}w(SV,H);SV.prototype.zk=g("qa");SV.prototype.Ve=g("Z");function Npc(a,b,c,d,e,f){SV.call(this,"pe",null,d,e,f);this.J=a;this.L=b;this.xc=c}w(Npc,SV);Npc.prototype.Sd=g("xc");function Opc(a,b,c){SV.call(this,"se",null,2859);this.J=a;this.L=b;this.V=c}w(Opc,SV);function Ppc(){return V('<div class="waffle-assistant-card" tabindex="0" role="region">'+(Nm?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(Nm?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function TV(){}w(TV,RI);wa(TV);TV.prototype.Ec=n("waffle-assistant-link-button");function Qpc(){return V('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function Rpc(a,b){R.call(this,b);this.D=a;this.C=new es("",new TV,this.Ba());this.Wa(this.C)}w(Rpc,R);p=Rpc.prototype;p.Ga=function(){this.Ka=S(Qpc)};p.Sa=function(){Rpc.$.Sa.call(this);var a=this.$a("waffle-assistant-feedback-card-link");this.C.mb(a);this.getHandler().R(this.Ka,"mousedown",this.Rg).R(this.C,"action",this.Jsb);this.show(!1)};p.Rg=function(a){a.stopPropagation()};
p.show=function(a){var b=this.Ka,c=this.$a("waffle-assistant-feedback-card-link");ep(b,"waffle-assistant-feedback-card-hidden",!a);am(c,a)};p.Jsb=function(){P.My.Cc({source:this.D});this.show(!1);this.dispatchEvent(new H("feedback-dialog-opened"))};function UV(){}w(UV,cs);wa(UV);UV.prototype.Ec=n("waffle-assistant-button");function VV(a,b,c,d){a&&(t(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Wa(b),ks(a,b,d),Yic(a),a.setAttribute("data-tooltip-delay",500),pWb(a,t(c)?c:1))};function Spc(){var a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+U(zt({icon:"docs-icon-img docs-icon-thumb-up"}))+'</div><div class="waffle-assistant-thumbs-down-button">'+U(zt({icon:"docs-icon-img docs-icon-thumb-down"}))+"</div></div></div>");return V(a)};function WV(a){R.call(this,a);this.C=new es("",new UV,this.Ba());this.Wa(this.C);this.D=new es("",new UV,this.Ba());this.Wa(this.D)}w(WV,R);WV.prototype.Ga=function(){this.Ka=S(Spc)};WV.prototype.Sa=function(){WV.$.Sa.call(this);var a=this.$a("waffle-assistant-thumbs-down-button");this.C.mb(a);VV(a,"Not useful");a=this.$a("waffle-assistant-thumbs-up-button");this.D.mb(a);VV(a,"Useful");this.getHandler().R(this.C,"action",this.F).R(this.D,"action",this.H)};
function Tpc(a,b){a.Ba().rf(a.$a("waffle-assistant-thumbs-text"),b)}WV.prototype.F=function(){this.dispatchEvent(new H("thumbs-down"));Q(this.Ka,!1)};WV.prototype.H=function(){this.dispatchEvent(new H("thumbs-up"));Q(this.Ka,!1)};function XV(a,b){var c=this;R.call(this,b);this.D=a;this.V=this.O=this.Ca=null;this.gb=new ZU(!0,"#4285f4");this.Wa(this.gb);this.ib=this.Mb=this.gc=!1;this.Oa=new Ek(function(){c.Oa.stop();c.Ka.parentNode.querySelector(":hover")==c.Ka?c.Oa.start():c.KT()},100);F(this,this.Oa);this.Hd=this.Ib=!1}w(XV,R);p=XV.prototype;p.nE=Qf;p.vba=Rf;p.lM=Sf;p.kM=Sf;p.M$=Sf;p.una=Sf;p.tna=Sf;p.jf=da("Hd");p.Fd=g("Hd");p.fpa=va;p.Ga=function(){this.Ka=S(Ppc)};
p.Sa=function(){XV.$.Sa.call(this);var a=this.$a("waffle-assistant-card-spinner-container");this.gb.render(a);ip(this.$a("waffle-assistant-card-inner"),"visibility","hidden");if(this.nE()){var a=this.Ka,b=new hp(a);F(this,b);this.getHandler().R(b,"focusin",this.ynb).R(b,"focusout",this.xnb).R(a,"mouseenter",this.A1).R(a,"mouseleave",this.KT)}Upc(this,!1);Nm&&(this.V=new Rpc(this.sG(),this.Ba()),this.V.render(this.$a("waffle-assistant-card-feedback-container")),this.getHandler().R(this.V,"feedback-dialog-opened",
this.Ksb).R(this,"trigger_feedback",this.$Wb),this.vba()?(this.O=new WV(this.Ba()),this.O.render(this.$a("waffle-assistant-thumbs-container")),Vpc(this,!0),a=ib(this.M$()),Ua(a)||Tpc(this.O,a),a=ib(this.una()),Ua(a)||VV(this.O.$a("waffle-assistant-thumbs-up-button"),a),a=ib(this.tna()),Ua(a)||VV(this.O.$a("waffle-assistant-thumbs-down-button"),a),this.getHandler().R(this.O,"thumbs-down",this.t1b).R(this.O,"thumbs-up",this.u1b)):Vpc(this,!1));this.MI()};
function YV(a){return a.$a("waffle-assistant-card-content-container")}function Wpc(a){a.nE();return a.$a("waffle-assistant-card-options")}function Vpc(a,b){Nm&&Q(a.$a("waffle-assistant-thumbs-container"),a.vba()&&b)}p.UK=function(){this.isDisposed()||(this.gc=!0,Xpc(this))};function Ypc(a,b){!a.Mb&&b&&(a.Mb=!0,Xpc(a))}function Xpc(a){if(a.gc&&a.Mb){var b=u(a.s1b,a);a.WI(b)}}p.A1=function(){this.ib||(Upc(this,!0),this.ib=!0,this.Oa.start())};p.KT=function(){Upc(this,!1);this.ib=!1};
p.ynb=function(){Upc(this,!0)};p.xnb=function(){var a=this,b=new Ek(function(){Xl(a.Ka,document.activeElement)||a.Ka.parentNode.querySelector(":hover")==a.Ka||Upc(a,!1)},0);F(this,b);b.start()};p.t1b=function(){Zpc(this,!0);Vpc(this,!1);var a=this.kM();this.dispatchEvent(new SV("ue",this,a))};p.u1b=function(){Vpc(this,!1);var a=this.lM();this.dispatchEvent(new SV("ue",this,a))};p.Ksb=function(){Zpc(this,!1)};p.$Wb=function(){Zpc(this,!0)};
function Upc(a,b){var c=a.$a("waffle-assistant-card-options");a=a.nE();Q(c,a&&b)}p.s1b=function(){this.gb.setActive(!1);Q(this.gb.Ka,!1);ip(this.$a("waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new H("content-rendered"))};function Zpc(a,b){ep(a.$a("waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.V.show(b)};function $pc(a){a=""+('<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+U(a.title)+"</div>"+U(ls({Ce:"waffle-assistant-section-more-button",content:or("More"),style:4}))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>');return V(a)};function aqc(a){return V('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" height="'+W(a.iconSize)+'px" width="'+W(a.iconSize)+'px" viewBox="0 0 24 24" preserveAspectRatio="none"><path fill="'+W(a.color)+'" d="M19,2 L5,2 C3.9,2 3,2.9 3,4 L3,18 C3,19.1 3.9,20 5,20 L9,20 L12,23 L15,20 L19,20 C20.1,20 21,19.1 21,18 L21,4 C21,2.9 20.1,2 19,2 L19,2 Z M13.88,12.88 L12,17 L10.12,12.88 L6,11 L10.12,9.12 L12,5 L13.88,9.12 L18,11 L13.88,12.88 L13.88,12.88 Z"/></svg>')}
;function bqc(){var a=V;var b=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content">'+U(aqc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
b=V(b);return a('<div class="waffle-assistant-scroll-pane" style="display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">'+b+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}
function cqc(a){return V('<div class="waffle-assistant-panel-title-bar">'+U(ls({Ce:"waffle-assistant-panel-back-button",content:or(""+U(zt({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"}))),style:4}))+'<div class="waffle-assistant-title-text" role="heading">'+U(a.title)+"</div></div>")};function ZV(a){R.call(this,a);this.Hd=new ZU(!1,"#4285f4");this.Wa(this.Hd);this.O=new R(this.Ba());this.Wa(this.O);this.C=[];this.hf=this.Ye=!1;this.pe=this.$d=this.Mb=this.qa=null;this.Ac=new ms("",a,4);Lq(this.Ac,2,!1);this.Wa(this.Ac)}w(ZV,R);var dqc={defaultHelpArticleId:"6280499"};p=ZV.prototype;p.Ga=function(){ZV.$.Ga.call(this);this.Ka=S(bqc);this.$d=this.$a("waffle-assistant-panel-content-container");this.pe=this.$a("waffle-assistant-empty-list")};
p.Sa=function(){ZV.$.Sa.call(this);var a=this.$a("waffle-assistant-spinner-container");this.Hd.render(a);this.O.mb(this.$a("waffle-assistant-panel-card-holder"));this.Ac.mb(this.$a("waffle-assistant-empty-list-learn-more"));this.getHandler().R(this.Ac,"action",this.v1b).R(this.Ka,"scroll",jjc(this.tfa,10,this))};p.setVisible=function(a){var b=this;Q(this.Ka,a);x(this.C,function(a){if(!a.mc()){var c=b.O.kd();a.Ca=c;b.O.Wa(a,!0);a.UK()}});this.Ye=a};
p.Fta=function(a,b){var c=this.Ba();this.qa&&this.L8();this.qa=new R;this.Wa(this.qa);a=cr(a,cqc,{title:b});this.Mb=new ms("",this.Ba());this.qa.Wa(this.Mb);this.Mb.mb(c.$a("waffle-assistant-panel-back-button",a));VV(this.Mb.Ka,"Back");this.qa.getHandler().R(this.Mb,"action",this.Smb)};p.L8=function(){this.qa.dispose();this.qa=null};function eqc(a,b){a.Hd.setActive(b);Q(a.$a("waffle-assistant-panel-pane"),!b)}p.tI=function(a){Q(this.pe,a);Q(this.$d,!a)};
function fqc(a,b){Kb(a.C,b);a.O.removeChild(b);a.O.$h(b,0);a.C.push(b)}p.fI=function(a){Kb(this.C,a);-1!=Zp(this.O,a)&&this.O.removeChild(a,!0)};p.c_=function(){this.O.Gd(!0);Hc(this.C);this.C=[]};p.tfa=function(){for(var a=this.Ka,a=a.scrollTop+Ap(a).height,b=0,c=0;c<this.C.length;c++){var d=this.C[c];b<a?(Ypc(d,!0),b+=Ap(d.Ka).height):Ypc(d,!1)}};p.jf=function(a){this.hf=a;x(this.C,function(b){b.jf(a)})};p.Fd=g("hf");p.v1b=function(){P.Ho.Cc(dqc)};p.Smb=function(){this.dispatchEvent("me")};function $V(a,b,c,d){R.call(this,d);this.V=a;this.bb=b;this.Z=new ms("",this.Ba());this.Wa(this.Z);this.J=new R(this.Ba());this.Wa(this.J);this.C=null;this.Xa=[];this.Pa=this.Oa=!1;this.Kb=c}w($V,R);p=$V.prototype;p.OOa=Qf;p.Kua=Rf;p.Ga=function(){$V.$.Ga.call(this);this.Ka=S($pc,{title:this.Z4()})};
p.Sa=function(){$V.$.Sa.call(this);this.J.mb(this.$a("waffle-assistant-section-card-holder"));this.Z.mb(this.$a("waffle-assistant-section-more-button"));this.getHandler().R(this.Z,"action",this.Kxb);this.C=this.HEa();F(this,this.C);Q(gqc(this),this.OOa());this.setVisible(!1)};p.setVisible=function(a){if(this.mc()&&this.kb()!=a&&(Q(this.Ka,a),a)){Q(this.Z.Ka,this.nWa());a=new Dia;N(a,4,this.Mwa());var b=new fi;ai(b,58,a);a=pi(oi(new ni,10),b).build();this.Kb.fc(2774,a)}};
p.kb=function(){return this.mc()&&Dp(this.Ka)};p.nWa=function(){return this.Xa.length>this.V};p.HEa=function(){return new ZV(this.Ba())};p.jf=function(a){this.Pa=a;x(hqc(this),function(b){b.jf(a)});this.C.jf(a)};p.Fd=g("Pa");p.qh=va;
p.Lwa=function(a){this.Xa=a;for(var b=0;b<a.length;b++){if(this.J.kd()<this.V){var c=this.v8(a[b]);c.jf(this.Pa);var d=this.J.kd();c.Ca=d;this.J.Wa(c,!0)}if(this.Kua()&&(this.C.tI(!1),c=this.C,d=this.v8(a[b]),c.C.push(d),c.Ye)){eqc(c,!1);var e=c.O.kd();d.Ca=e;c.O.Wa(d,!0);d.UK()}}};function hqc(a){var b=[];a.J.Mf(function(a){b.push(a)});return b}function gqc(a){return a.$a("waffle-assistant-section-content")}p.Upa=function(){return this.J.pba()};
p.xW=function(){this.Xa=[];Hc(this.J.Gd(!0));this.setVisible(!1);this.Kua()&&(this.C.c_(),this.C.tI(!0))};function iqc(a){a.J.Mf(function(a,c){c<this.V&&a.UK()},a)}p.Nwa=function(a){var b=0;if(this.Oa)this.C.tfa();else if(this.Upa()){this.setVisible(!0);for(var b=Ap(this.$a("waffle-assistant-section-header")).height+Ap(gqc(this)).height,c=hqc(this),d=0;d<c.length;d++)b<a&&d<this.V?(this.YLa(c[d]),Ypc(c[d],!0),b+=Ap(c[d].Ka).height):Ypc(c[d],!1)}else this.setVisible(!1);return a-b};p.YLa=va;
p.setActive=function(a){(this.Oa=a)||this.C.L8()};p.$b=g("Oa");function jqc(a,b){a.C.Fta(b,a.Z4())}p.Kxb=function(){this.setActive(!0);this.dispatchEvent("re")};p.xu=g("Kb");var kqc={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}};function lqc(a){var b=new jC(sc(kqc));return vlc(a,b)}
function mqc(a,b){a.setOption("legend.position","none");a.setOption("hAxis.slantedText",!1);a.setOption("hAxis.textStyle.fontSize",11);a.setOption("vAxes.0.textStyle.fontSize",11);a.setOption("vAxes.1.textStyle.fontSize",11);a.setOption("fontStyle.size",10);a.setOption("fontStyle.italic",!1);a.setOption("titleTextStyle.bold",!1);a.setOption("titleTextStyle.fontSize",12);a.setOption("async",40);!1!==a.dc("useFirstColumnAsDomain")&&a.Sd()&&"number"===a.Sd().jd(0)&&a.setOption("hAxis.gridlines.count",
-1);var c=15;if(!1!==a.dc("useFirstColumnAsDomain")&&a.Sd()&&"string"===a.Sd().jd(0)){var c=0,d=Il("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";b.appendChild(d);for(b=0;b<a.Sd().getNumberOfRows();b++)Zl(d,a.Sd().Wf(b,0)),c=Math.max(c,Hp(d).width);Pl(d);c=Math.min(27,Math.max(15,10+100*c/271))}cn()||Vm||(a.setOption("chartArea.top","15%"),b=a.dc("hAxis.title"),a.setOption("chartArea.height",Ua(ib(b))?"80%":"65%"),a.setOption("chartArea.left",c+"%"),a.setOption("chartArea.width",
95-c+"%"),"PieChart"==a.getChartType()&&(a.setOption("chartArea.top",Ua(ib(a.dc("title")))?"12%":"15%"),a.setOption("chartArea.height","70%"),a.setOption("chartArea.left","0%"),a.setOption("chartArea.width","100%"),a.setOption("pieSliceText","none"),a.setOption("legend.position","labeled"),a.setOption("legend.textStyle.fontSize",10)));return a};function nqc(){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview"  tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function oqc(){return V(U(ls({Ce:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:or(""+U(zt({icon:"docs-icon-img docs-icon-insert-autovis-chart"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+U(ls({Ce:"waffle-assistant-zoom-button",content:or(""+U(zt({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4})))};function pqc(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(U(a.X7a)+"</span>"),d=0==a.XHa.length,b=b+('<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>');if(d)c=V('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">';a=a.XHa;for(var e=a.length,f=0;f<e;f++)var h=a[f],c=c+((0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">'),c=h?c+U(h):c+"(empty)",c=c+('</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":""));c=V(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+(d?" waffle-assistant-facet-white-section":
"")+'">'+c+(Nm?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return V(b)};function qqc(a,b,c,d,e,f,h){R.call(this,h);this.F=a;this.D=b;this.J=e;this.Kb=f;this.C=this.xc=null;this.H=oi(new ni,10).build()}w(qqc,R);p=qqc.prototype;p.Sa=function(){qqc.$.Sa.call(this);(new UT(yC,this.D.vf())).send(u(this.aqb,this,this.D))};p.fpa=function(a,b){a=new Npc(this.F.clone(),this.J,this.xc,2746,a,b);this.dispatchEvent(a)};p.aqb=function(a,b){b&&(b.Ci()?YB.DB(this.Ka,b):(b=b.Sd(),a.ke(b),oU(a,b),ZB(a,"ready",u(this.i1b,this,a)),CU(a,this.Ka,this.Kb,Vm),this.xc=b))};
p.i1b=function(a){a.ym()&&(ZB(a.ym(),"onmouseover",u(this.g1b,this)),ZB(a.ym(),"onmouseout",u(this.h1b,this)))};p.g1b=function(){this.C=Ka()};p.h1b=function(){sa(this.C)&&500<Ka()-this.C&&this.Kb.fc(2750,this.H);this.C=null};function rqc(a,b,c,d,e){R.call(this,e);this.J=a;this.Oa=b;this.Kb=c;this.O=d;this.L=Dc(this.J,23);this.Ia=B(this.J,22);this.D=B(this.J,26);this.Ca=[];this.De=new th;this.V=this.F=this.C=null;this.Z=!1;this.qa=new ms("",this.Ba());this.Wa(this.qa);this.H=null}w(rqc,R);p=rqc.prototype;p.Ga=function(){rqc.$.Ga.call(this);this.Ka=S(pqc,{X7a:this.D,XHa:this.L});this.Ka.style.visibility="hidden"};
p.Sa=function(){rqc.$.Sa.call(this);var a=this.$a("waffle-assistant-facet-toggle");this.qa.mb(a);this.getHandler().R(this.Ka,"mousedown",this.Rg).R(this.qa,"action",this.vFb);Nm&&(this.V=new Rpc("assistantAutovisFacetFeedback",this.Ba()),this.V.render(this.$a("waffle-assistant-facet-feedback-container")),this.C=new WV(this.Ba()),this.Wa(this.C),this.C.render(this.$a("waffle-assistant-facet-thumbs-container")),Tpc(this.C,this.L.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().R(this.C,
"thumbs-up",this.f1b).R(this.C,"thumbs-down",this.e1b));sqc(this,Nra)};p.Fd=g("Z");p.jf=function(a){this.Z=a;tqc(this)};p.Rg=function(a){a.stopPropagation()};p.vFb=function(){var a=$o(this.$a("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");sqc(this,a);uqc(this,a?2647:2646)};
function sqc(a,b){var c=a.$a("waffle-assistant-facet-toggle");Zl(c,b?"HIDE":"SHOW");ep(a.$a("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);x(a.Ui("waffle-assistant-faceted-chart"),function(a){am(a,b)});a.C&&Q(a.C.Ka,b);var d='Show chart broken down by "'+(a.D+'"');a='Hide chart broken down by "'+(a.D+'"');VV(c,b?a:d)}
function vqc(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function wqc(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function tqc(a){a.O&&!a.Z&&x(a.Ca,u(function(a){var b=a.Ka;if(!this.O.contains(b)){var d=this.O;a=new xqc(b,a);rnb(d,a)}},a))}p.f1b=function(){uqc(this,2649)};p.e1b=function(){uqc(this,2648);this.V.show(!0)};function uqc(a,b){var c=a.Kb,d=new yU,e=a.H.getChartType();d.C=e;e=a.H.Sd();d.F=e?e.clone():null;zU(c,b,d,10,a.H,a.H.vf())};function aW(a,b,c,d,e,f){XV.call(this,a,f);this.C=B(a,8);this.Kc=b;this.Ac=c;this.Kb=d;this.bb=e;this.L=new ms("",this.Ba());this.Wa(this.L);this.Z=new ms("",this.Ba());this.Wa(this.Z);this.De=new th;this.Xb=null;this.Pa=!1;this.Tb=[];this.Qb=[];this.zb=[];this.Xa=this.Ia=this.F=this.H=this.qa=null;this.J=oi(new ni,10).build()}w(aW,XV);
var bW={AZa:"waffle-assistant-after-chart-preview",UZa:"waffle-assistant-before-chart-preview",h_a:"waffle-assistant-card-draggable",i6:"waffle-assistant-chart-highlights",H1a:"waffle-assistant-insert-chart-button",lha:"waffle-assistant-chart-preview",C3a:"waffle-assistant-button-separator",b4a:"waffle-assistant-styled-border",c4a:"waffle-assistant-styled-rect",g5a:"waffle-assistant-zoom-button"};p=aW.prototype;p.WI=function(a){this.Xb=a;yqc(this)};
p.MI=function(){zqc(this,u(function(a){a=ymc(this.Kc,a);Yo(this.Ka,a)},this),!1)};p.nE=Rf;p.sG=n("autovisFeedback");p.lM=n(2208);p.kM=n(2207);p.M$=n("Was this chart useful?");p.Ga=function(){aW.$.Ga.call(this);YV(this).appendChild(S(nqc));Wpc(this).appendChild(S(oqc));yc(this.C,22)&&(this.F=new rqc(this.C,this.Ca,this.Kb,this.bb,this.Ba()),this.Wa(this.F,!0),this.F.jf(this.Fd()))};
p.Sa=function(){aW.$.Sa.call(this);ap(this.Ka,bW.h_a);var a=this.$a(bW.H1a);this.L.mb(a);VV(a,"Insert chart");a=this.$a(bW.g5a);this.Z.mb(a);VV(a,"View full size");var a=this.$a(bW.UZa),b=this.$a(bW.lha),c=this.$a(bW.AZa);this.getHandler().R(this.Ka,"keydown",this.b1b).R(b,"click",this.eob).R(a,"focus",this.anb).R(c,"focus",this.Slb).R(this.L,"action",this.nvb).R(this.L.Ka,"mousedown",this.Rg).R(this.Z,"action",this.hHb).R(this.Z.Ka,"mousedown",this.Rg).R(this.$a(bW.i6),"mousedown",this.Rg).R(Su(this.Kc),
"Da",this.c1b);Aqc(this);this.Kb.fc(2790,this.J);this.F&&this.Kb.fc(2791,this.J)};p.jf=function(a){aW.$.jf.call(this,a);Aqc(this);this.mc()&&Bqc(this)};function Aqc(a){if(a.mc()){var b=a.Fd();a.L.setVisible(!b);a=a.Ba().$a(bW.C3a,Wpc(a));Q(a,!b)}}p.b1b=function(a){13==a.keyCode&&a.target==this.Ka&&(a.preventDefault(),a.stopPropagation(),Cqc(this,2255))};
function Dqc(a){for(var b=a.getChartType(),c=!!B(a.C,14),d=B(a.C,16),e=!!B(a.C,15),f="Histogram"==b,b="PieChart"==b,h=fT(Dc(a.D,4)),k=1<h.length,l=[],m=0;m<h.length;m++){var q=Eqc(h[m].rect,c!=b);Ob(l,q)}var c=iB(a.Ac).ld(),r=[];for(v in Jg)r.push(c.Y4(Jg[v]));var v=ub(l,function(a){return ub(r,Ha(gh,a))});f&&e&&(v=Pb(v,1));a.zb=Fqc(v.length,b&&0<d||!f&&!b&&e,b&&k);d=iB(a.Ac);for(e=0;e<v.length;e++)for(f=a.zb[e],b=0;b<v[e].length;b++)v[e][b]&&ph(v[e][b])&&(k=rS(d,v[e][b],bW.c4a),F(a,k),PG(bI(d),k,
!0),ip(k.Ka,"background-color",f),k.setVisible(!0),a.Tb.push(k),k=IH(d,v[e][b],bW.b4a,1,0),F(a,k),Ygb(k,f),k.setVisible(!0),a.Qb.push(k))}function Gqc(a){Hc(a.Tb);Hc(a.Qb);a.Tb=[];a.Qb=[];a.zb=[]}p.c1b=function(){this.Pa&&(Gqc(this),Dqc(this))};p.A1=function(){aW.$.A1.call(this);this.Ia=Ka();this.Pa||(Dqc(this),this.Pa=!0)};p.KT=function(){aW.$.KT.call(this);sa(this.Ia)&&500<Ka()-this.Ia&&this.Kb.fc(2789,this.J);this.Ia=null;Gqc(this);this.Pa=!1};p.eob=function(){this.Ka.focus()};
p.anb=function(){var a=this.$a(bW.i6);Dp(a)?a.focus():this.Ka.nextSibling&&this.Ka.nextSibling.focus()};p.Slb=function(){var a;if(a=this.V)a=this.V,a.Hb("waffle-assistant-feedback-card-hidden")?a=!1:(a.$a("waffle-assistant-feedback-card-link").focus(),a=!0);a||this.Z.Ka.focus()};p.nvb=function(){this.Kb.fc(2255,this.J);Cqc(this,2255)};p.Rg=function(a){a.stopPropagation()};p.hHb=function(){X.p5.Cc(this)};p.fpa=function(a,b){Cqc(this,2257,a,b)};
function Cqc(a,b,c,d){zqc(a,u(function(a){a=new Npc(a,this.Ca,this.H&&this.H.Sd(),b,c,d);this.dispatchEvent(a)},a),!1)}
p.d1b=function(a,b){if(b){var c=this.$a(bW.lha);if(b.Ci())YB.DB(c,b);else{a.ke(b.Sd());oU(a,a.Sd());WS(a,"ready",u(this.a1b,this,a));b=[];try{var d=new df;d.setContext(a.toJSON());var e=!!B(this.C,14);C(d,3,e);var f=B(this.C,16);C(d,4,f);C(d,5,"ROWS"==(e?"ROWS":"COLS"));C(d,8,0);if(B(this.C,24)){var h=B(this.C,25);C(d,9,h)}for(var k=fT(Dc(this.D,4)),e=0;e<k.length;e++)d.addRange(xh(k[e].rect,k[e].Yc));var l=this.De.serialize(d);b=ub(jnc(Ha(ritz_api.RitzModelApi.getVerbalHighlightsForProto,l),a).call(),
gnc)}catch(m){b=[]}d=this.$a(bW.i6);Q(d,0<b.length);0<b.length&&(d.appendChild(b[0]),am(d,!0));this.H=a;CU(a,c,this.Kb,Vm)}}};p.a1b=function(a){null!==this.qa&&(Li(Ji.getInstance(),this.qa),this.qa=null);this.isDisposed()||(a.ym()&&(ZB(a.ym(),"onmouseover",u(this.Z0b,this)),ZB(a.ym(),"onmouseout",u(this.$0b,this))),this.Xb(),Bqc(this))};p.Z0b=function(){this.Xa=Ka()};p.$0b=function(){sa(this.Xa)&&500<Ka()-this.Xa&&this.Kb.fc(2795,this.J);this.Xa=null};
function Bqc(a){if(a.bb&&!a.Fd()){var b=a.$a(bW.lha);if(!a.bb.contains(b)){var c=a.bb;a=new xqc(b,a);rnb(c,a)}}}function Hqc(a){a.Ib&&(a.qa=Ki(Ji.getInstance(),uj.vxa),a.Ib=!1);B(a.C,16);var b=lqc(a.C);b.cea(yC);var c=xlc(a.D);b.Xh(c.toString());a.F&&(c=c.clone(),a.F.F=c);return b}
function yqc(a){var b=Hqc(a),b=mqc(b,a.$a("waffle-assistant-card-inner"));(new UT(yC,b.vf())).send(u(a.d1b,a,b));a.F&&zqc(a,u(function(a){var c=this.F,e=b;a=new jC(a.toJSON());var e=new jC(e.toJSON()),f=c.Ui("waffle-assistant-faceted-chart");if(1<f.length){wqc(a);var h=e;vqc(h);h.setOption("pieSliceText","percentage");h.setOption("axisFontSize",0);h.setOption("hAxis.title",null);h.setOption("hAxis.textPosition","none");h.setOption("vAxes.0.title",null);h.setOption("vAxes.0.textPosition","none");h.setOption("vAxes.1.title",
null);h.setOption("vAxes.1.textPosition","none");cn()||Vm||h.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"});h.setOption("legend","none");h.setOption("titleTextStyle.fontSize",0)}else h=a,wqc(h),h.setOption("applyAggregateData",void 0),h.setOption("legend","right"),vqc(e);h=fT(Dc(c.J,27));SZa(c.F,h);for(var h=B(c.J,25),k=0;k<f.length;k++){var l=qa(c.L[k])?c.L[k]:null,m=h.clone(),q=c.Ia,r=new kf;C(r,1,q);qa(l)&&r.fb(l);C(m,7,r);c.F.Sb("dt",encodeURIComponent(JSON.stringify(c.De.serialize(m))));
q=new jC(a.toJSON());q.Xh(c.F.toString());m=e.clone();m.Xh(c.F.toString());var v=c,y=q.dc("title");y||(y=mpc(q));r=y+(' when "'+(v.D+('" is "'+(l+'"'))));v=y+(' by "'+(v.D+'"'));r=l?r:v;q.setOption("title",r);m.setOption("title",r);v=new qqc(q,m,0,0,c.Oa,c.Kb,c.Ba());c.Wa(v);r=f[k];v.mb(r);c.Ca.push(v);v=c;y=mpc(q);q=y+(' broken down by "'+(v.D+('" for "'+(l+'"'))));v=y+(' broken down by "'+(v.D+'"'));Yo(r,l?q:v);c.H=m}tqc(c);c.Ka.style.visibility="visible"},a),!1)}
function zqc(a,b,c){var d=Hqc(a);(new UT(yC,d.vf())).send(function(a){a?(a=a.Sd(),c&&d.ke(a),oU(d,a),b(d)):b(null)})}p.getChartType=function(){return this.C.getChartType()};function Fqc(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=lkc("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Ob(d,d);return d}function Eqc(a,b){return b?Xhc(a,new Vg(a.width,1)):Xhc(a,new Vg(1,a.height))};function Iqc(){rI.call(this);this.Pa.push(this);this.Ca=this.Ia=!0;this.ib="waffle-assistant-dragged-card"}w(Iqc,qnb);Iqc.prototype.contains=function(a){return!!x(this.L,function(b){if(b.element==a)return!0})};Iqc.prototype.Fna=function(a){var b=Iqc.$.Fna.call(this,a);if(cn()||Vm){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=ub(b.querySelectorAll("clippath"),function(a){return a.id}),Jqc(b,a);return b};
function Jqc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];qa(c)&&bb(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=Sl(a);for(c=0;c<a.length;c++)Jqc(a[c],b)}function xqc(a,b){tI.call(this,a,b)}w(xqc,tI);xqc.prototype.Hna=g("element");function Kqc(){return V('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function cW(a,b){XV.call(this,a,b);this.C=B(a,8)}w(cW,XV);p=cW.prototype;p.MI=va;p.sG=n("assistantWordCloudFeedback");p.lM=n(2634);p.kM=n(2633);p.Ga=function(){cW.$.Ga.call(this);YV(this).appendChild(S(Kqc));ap(YV(this),"waffle-assistant-word-cloud-content-container")};
p.WI=function(a){for(var b=Dc(this.C,19),c=Dc(this.C,20),d=this.$a("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(Lqc(this,b,c,e),120<d.clientHeight){Lqc(this,b,c,e-1);break}b=this.Ba();c=B(this.C,2);c=km(b,c);d=this.$a("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function Lqc(a,b,c,d){var e=a.$a("waffle-assistant-word-cloud-words-container");for(a=a.Ba();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){0!=k&&e.appendChild(km(a," "));var l=a.createElement("SPAN");a.appendChild(l,km(a,b[k]));a.appendChild(e,l);ap(l,"waffle-assistant-word-cloud-word");var m=c[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-f)/(h-f)*15+9+"px"}};function dW(a,b,c,d,e){$V.call(this,20,d,c,e);this.O=a;this.L=b;this.D=new Iqc;F(this,this.D);this.F=null;this.H=0}w(dW,$V);p=dW.prototype;p.Sa=function(){dW.$.Sa.call(this);this.D.Re();this.getHandler().R(this.D,"drag",this.Y0b).R(this.D,"dragend",this.Vm)};p.Z4=n("Analysis");p.zja=function(a){return 0==a};p.v8=function(a){return"WordCloud"==B(a,8).getChartType()?new cW(a,this.Ba()):new aW(a,this.O,this.L,this.xu(),this.D,this.Ba())};p.jf=function(a){dW.$.jf.call(this,a);a&&Zmb(this.D)};
p.YLa=function(a){this.getHandler().Jc(a,"content-rendered",this.X0b);this.H++};p.X0b=function(){0==--this.H&&this.dispatchEvent("oe")};p.Y0b=function(){this.F=wp(this.D.dd.target)};p.Vm=function(a){var b=this.F,c=iB(this.L).Td();if(Zg(IF(c,"page",!1,!1)).contains(b)){var d=GF(c,b.x,b.y,"page"),c=KF(c,dh(d),"page"),b=new Ng(b.x-c.left,b.y-c.top);a.C.getData().fpa(d,b)}this.F=null};p.Mwa=n(2);function Mqc(a){var b=[];if(yc(a,25)&&(a=B(a,25)))for(var c=0;c<zc(a,1);c++){var d=B(a,1,c);if(yc(d,2)){var e=B(d,2);e&&b.push(Nqc(e,Oqc(d)))}}return b}function Pqc(a){var b=Mqc(a);yc(a,6)&&(a=B(a,6))&&b.push(Nqc(a,0));return b}function Oqc(a){return(a=yc(a,4)?B(a,4):0)?a:0}function Nqc(a,b){return{name:a,I5a:b}};function Qqc(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){do var f=Math.floor(Math.random()*a);while(d[f]);d[f]=1;c.push(f)}else{for(d=0;d<a;d++)c.push(d);for(d=0;d<b;d++)e=Math.floor(Math.random()*(a-d)+d),f=c[d],c[d]=c[e],c[e]=f}return c.slice(0,b)}function eW(a){return Qqc(a,1)[0]}function Rqc(a){var b=0;x(a,function(c,d){c.length>a[b].length&&(b=d)});return ub(a[b],function(b,d){return ub(a,function(a){return a[d]})})}
function Sqc(a){var b={};x(a,function(a){b[a]||(b[a]=0);b[a]++});Qb(a);Tb(a,function(a,d){return b[d]-b[a]})};function Tqc(a,b,c){this.Ca=a;this.Ia=b;this.D=[];this.F=[];this.L=[];this.O=[];this.V=[];this.Z=[];this.C=new jg;this.J=new jg;this.qa=new jg;this.H=new jg;Uqc(this,c)}function Vqc(a,b){return kg(a,b)?a.get(b).values.fd():[]}
function Uqc(a,b){for(var c=new pg,d=new pg,e=0;e<b.length;e++){for(var f=Pqc(b[e]),h=[],k=[],l=0;l<f.length;l++){var m=f[l].name.toLowerCase();if(kg(a.Ca,m)){var q=a.Ca.get(m);c.add(q);h.push(q)}kg(a.Ia,m)&&(m=a.Ia.get(m),d.add(m),k.push(m))}Wqc(a,h,k)}a.D=c.fd();a.F=d.fd();Tb(a.D);Tb(a.F);a.L=ub(a.C.fd(),function(a){return a.key});Tb(a.L);a.O=ub(a.J.fd(),function(a){return a.key});Tb(a.O);a.V=ub(a.qa.fd(),function(a){return a.key});Tb(a.V);a.Z=ub(a.H.fd(),function(a){return a.key});Tb(a.Z)}
function Wqc(a,b,c){for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)fW(a.C,b[d],b[e]),fW(a.C,b[e],b[d]);for(d=0;d<b.length;d++)for(e=0;e<c.length;e++)fW(a.J,b[d],c[e]),fW(a.qa,c[e],b[d]);for(b=0;b<c.length;b++)for(d=b+1;d<c.length;d++)fW(a.H,c[b],c[d]),fW(a.H,c[d],c[b])}function fW(a,b,c){var d;kg(a,b)?d=a.get(b).values:d=new pg;d.add(c);a.set(b,{key:b,values:d})};function Xqc(a,b){this.C=a;for(var c=new jg,d=0;d<zc(a,2);d++)c.set(a.Ed(d).getName().toLowerCase(),d);this.O=c;c=new jg;for(d=0;d<zc(a,1);d++)c.set(B(a,1,d).getName().toLowerCase(),d);this.Ca=c;c=[];for(d=0;d<zc(a,2);d++)gW(a.Ed(d).getName())&&c.push(d);this.J=c;c=[];for(d=0;d<zc(a,1);d++)gW(B(a,1,d).getName())&&c.push(d);this.L=c;c=[];for(d=0;d<zc(a,1);d++){for(var e=B(a,1,d).getName(),f=!0,h=0;h<Yqc.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+Yqc[h]+"(\\b|_)","i"))){f=!1;break}f&&c.push(d)}this.Ia=
c;this.qa=Zqc(a,0);this.V=Zqc(a,1);c=[];for(d=0;d<zc(a,2);d++).8<=B(a.Ed(d),6)&&c.push(d);this.Z=c;c=[];for(d=0;d<zc(a,2);d++)e=a.Ed(d),.95<=Dc(e,2).length/B(e,8)&&c.push(d);this.Pa=c;c=[];for(d=0;d<zc(a,3);d++)f=a.Ed(B(a,3,d)),e=Dc(f,2).length/B(f,8),f=zc(f,3)/zc(f,2),.5<e||.3>f||c.push(B(a,3,d));Tb(c);this.Oa=c;this.F=$qc(zc(a,2));this.H=$qc(zc(a,1));this.D=new Tqc(this.O,this.Ca,b)}function $qc(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}
function Zqc(a,b){for(var c=[],d=0;d<zc(a,2);d++)a.Ed(d).getType()==b&&c.push(d);return c}function arc(a,b){if(0==a.length&&0==b.length)return-1;for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=brc(c,a[d]);for(a=0;a<b.length;a++)d=brc(c,b[a]),c=0<d.length?d:c;return 0<c.length?c[eW(c.length)]:-1}function hW(a,b,c,d,e,f){var h=[a.J,a.D.D],k=[a.F];b&&(k.push(a.qa),k.push(a.Z));c&&k.push(a.Oa);d&&k.push(a.Pa);null!=f&&-1!=f?h.push(Vqc(a.D.J,f)):e&&h.push(a.D.O);return arc(k,h)}
function iW(a,b,c){var d=[a.L,a.D.F],e=[a.H];b&&e.push(a.Ia);c&&d.push(a.D.V);return arc(e,d)}function crc(a,b){for(var c=5;;){var d=a.C.Ed(b),e=eW(zc(d,2));c--;if(gW(HV(d,e))||0==c)return e}}function drc(a,b){for(var c=5;;){var d=a.C.Ed(b),e=eW(zc(d,3)),e=B(d,3,e);c--;if(gW(HV(d,e))||0==c)return e}}function jW(a,b){b=a.C.Ed(b);a=b.getName();gW(a)||(b=erc(Dc(b,7)),a=null==b?a:b);return a}function kW(a,b){b=B(a.C,1,b);a=b.getName();gW(a)||(b=erc(Dc(b,2)),a=null==b?a:b);return a}
function erc(a){for(var b=0;b<a.length;b++)if(gW(a[b]))return a[b];return null}function gW(a){return null==a?!1:50>=a.length}function frc(a){for(var b=Qqc(a.length,2),c=[],d=0;d<b.length;d++)c.push(a[b[d]]);return c}function brc(a,b){for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}var Yqc=["average","total","sum","mean","median"];function lW(){this.zA=[];this.C=this.O=this.jW=null;this.L=[];this.J=new pg;this.V=new pg}p=lW.prototype;p.Re=function(a,b,c){this.reset();this.jW=b;this.O=a;this.L=Gra?c:[];this.C=new Xqc(a,c)};
p.Ica=function(){var a=[];if(Gra)for(var b=0;b<this.L.length;b++){var c=this.L[b];switch(c.getChartType()){case "BarChart":if(this.Ol(13)||this.Ol(2)){var d=B(c,6);d&&-1!=this.C.O.get(d.toLowerCase(),-1)&&(d=grc(this,c),1<d.length&&(Tm&&this.Ol(23)?mW(this,a,"Scatter chart of "+d[0].name+" vs "+d[1].name,23,2):this.Ol(2)&&mW(this,a,"Correlation of "+d[0].name+" and "+d[1].name,2,1.5)))}break;case "ScatterChart":d=grc(this,c);1<d.length&&(Tm&&this.Ol(23)?mW(this,a,"Scatter chart of "+d[0].name+" vs "+
d[1].name,23,2):this.Ol(2)&&mW(this,a,"Correlation of "+d[0].name+" and "+d[1].name,2,1.5));break;case "PieChart":for(var d=[],c=Mqc(c),e=0;e<c.length&&-1!=this.C.O.get(c[e].name.toLowerCase(),-1);e++)d.push(c[e]);1==d.length&&4==d[0].I5a&&(Tm&&this.Ol(20)?mW(this,a,"Bar chart of distribution of "+d[0].name,20,2):this.Ol(14)&&mW(this,a,"Distribution of "+d[0].name,14,1.5))}}this.Ol(1)&&(d=this.C.C,b=iW(this.C,!1,!0),c=hW(this.C,!0,!1,!0,!0,b),-1!=c&&-1!=b&&(d=10<=zc(d.Ed(c),2)?"5 ":"",c=jW(this.C,
c),b=kW(this.C,b),c!=b&&mW(this,a,this.bKa(1)+" "+d+c+" by "+b,1)));if(this.Ol(2)&&1<zc(this.C.C,1)){a:if(d=this.C,2>d.H.length)b=[-1,-1];else{c=arc([d.H],[d.L,d.D.F,d.D.Z]);if(-1!=c&&(b=Vqc(d.D.H,c),0<b.length)){d=[c];c=eW(b.length);d.push(b[c]);b=d;break a}b=frc(2<=d.L.length?d.L:d.H)}d=b;b=kW(this.C,d[0]);d=kW(this.C,d[1]);b!=d&&mW(this,a,"Correlation of "+b+" and "+d,2)}this.Ol(3)&&(b=this.C.C,d=iW(this.C,!0),-1!=d&&mW(this,a,this.vS(Dc(B(b,1,d),3),3)+" of "+kW(this.C,d),3));if(this.Ol(5)){var b=
this.C.C,d=iW(this.C,!0,!0),f=hW(this.C,!0,!0,!1,!0,d);if(-1!=d&&-1!=f){var c=kW(this.C,d),e=b.Ed(f),h=jW(this.C,f);0<zc(e,3)&&h!=c&&(f=drc(this.C,f),mW(this,a,this.vS(Dc(B(b,1,d),3),5)+" of "+c+" when "+h+" is "+HV(e,f),5))}}this.Ol(9)&&(d=iW(this.C,!1,!0),b=hW(this.C,!0,!1,!0,!0,d),-1!=b&&-1!=d&&(d=kW(this.C,d),b=jW(this.C,b),b!=d&&mW(this,a,b+" with "+this.ena(9)+" "+d,9)));this.Ol(10)&&0<zc(this.C.C,1)&&(b=kW(this.C,iW(this.C)),mW(this,a,this.ena(10)+" "+b,10));this.Ol(11)&&(b=this.C.C,d=hW(this.C,
!0,!0,!1,!1,-1),-1!=d&&(c=jW(this.C,d),0<zc(b.Ed(d),3)&&mW(this,a,"Most frequent "+c,11)));if(this.Ol(12)){b=this.C.C;d=iW(this.C,!0);a:{c=this.C;if(1==c.V.length&&(e=c.V[0],!B(c.C.Ed(e),5))){c=e;break a}c=-1}h=c;-1!=h&&-1!=d&&(c=kW(this.C,d),e=b.Ed(h),0<zc(e,2)&&(h=crc(this.C,h),mW(this,a,this.vS(Dc(B(b,1,d),3),12)+" of "+c+" "+hrc[eW(hrc.length)]+" "+HV(e,h),12)))}this.Ol(15)&&(b=this.C.C,d=iW(this.C,!0),h=hW(this.C,!1,!0,!1,!0,d),-1!=d&&-1!=h&&(c=kW(this.C,d),e=jW(this.C,h),e!=c&&(h=b.Ed(h),2<=
zc(h,3)&&(f=Qqc(zc(h,3),2),mW(this,a,"Compare "+this.vS(Dc(B(b,1,d),3),15)+" "+c+" for "+e+" "+HV(h,B(h,3,f[0]))+" and "+HV(h,B(h,3,f[1])),15)))));this.Ol(16)&&(b=hW(this.C,!0,!0,!1,!1),-1!=b&&(b=jW(this.C,b),mW(this,a,"List unique values in "+b,16)));this.Ol(17)&&(d=this.C.C,b=hW(this.C,!0,!0,!1,!1),-1!=b&&(d=d.Ed(b),c=jW(this.C,b),1>zc(d,3)||(b=drc(this.C,b),mW(this,a,"What percentage of "+c+" is "+HV(d,b),17))));this.Ol(13)&&(b=this.C.C,d=iW(this.C,!0,!0),e=hW(this.C,!0,!0,!1,!0,d),-1!=d&&-1!=
e&&(c=kW(this.C,d),e=jW(this.C,e),e!=c&&mW(this,a,this.vS(Dc(B(b,1,d),3),13)+" of "+c+" by "+e,13)));Tm&&this.Ol(18)&&(b=iW(this.C),-1!=b&&mW(this,a,"Histogram of "+kW(this.C,b),18,2));((b=3>a.length)||0==eW(5))&&this.Ol(7)&&(c=this.C.C,h=iW(this.C,!1,!0),d=hW(this.C,!1,!1,!1,!0,h),-1!=d&&-1!=h&&(c=c.Ed(d),e=jW(this.C,d),h=kW(this.C,h),0<zc(c,2)&&e!=h&&(d=crc(this.C,d),mW(this,a,"Show "+h+" for "+e+" "+HV(c,d),7))));if((b||0==eW(5))&&this.Ol(8)){b=this.C.C;a:if(d=this.C,2>d.F.length)d=[-1,-1];else{c=
[d.J,d.D.D,d.D.L];e=[d.F];e.push(d.qa);e.push(d.Z);e=arc(e,c);if(-1!=e&&(c=Vqc(d.D.C,e),0<c.length)){d=[e];e=eW(c.length);d.push(c[e]);break a}d=frc(2<=d.J.length?d.J:d.F);d[0]!=e&&(d[1]=d[0],d[0]=e)}c=d;d=c[0];1<zc(b,2)&&-1!=d&&(c=c[1],b=b.Ed(c),e=jW(this.C,c),d=jW(this.C,d),0<zc(b,2)&&e!=d&&(c=crc(this.C,c),mW(this,a,"What is "+d+" where "+e+" is "+HV(b,c),8)))}this.zA=irc(a)};p.reset=function(){this.zA=[];this.V=new pg;this.J=new pg};p.Jca=function(){return wi(this.zA.slice())};
function irc(a){Tb(a,function(a,c){return c.weight-a.weight});return ub(a,function(a){return a.zva})}function mW(a,b,c,d,e){e=a.$Ja(d,void 0===e?1:e);a.V.contains(c)||(b.push({zva:{query:c,Iq:void 0,type:d},weight:e}),a.J.add(d),a.V.add(c))}p.Ol=function(a){return!this.J.contains(a)};function jrc(a,b){return a.Jca().then(function(a){return a.length<=b?a:Pb(a,0,b)},null,a)}
function grc(a,b){var c=[];b=Mqc(b);for(var d=0;d<b.length&&-1!=a.C.Ca.get(b[d].name.toLowerCase(),-1);d++)c.push(b[d]);return c}p.vS=function(a){a:{if(0<a.length)for(var b=0;b<a.length;b++)switch(a[b]){case 5:a=krc;break a;case 4:a=lrc;break a}a=mrc}return a[eW(a.length)]};p.bKa=function(){return nrc[eW(nrc.length)]};p.ena=function(){return orc[eW(orc.length)]};
var mrc=["Average","Median"],krc=["Total","Average","Median"],lrc=["Median"],orc="Minimum Maximum Most Least Highest Lowest".split(" "),nrc=["Top","Bottom"],hrc=["before","after"];function prc(a,b){lW.call(this);this.F=[];this.H=this.D=null;this.Z=a;this.Kb=b;this.qa=oi(new ni,10).build()}la(prc,lW);p=prc.prototype;p.Ica=function(){this.reset();lW.prototype.Ica.call(this);Fra&&qrc(this)};p.reset=function(){lW.prototype.reset.call(this);this.F=[];this.D&&(this.D.cancel(),this.D=null)};p.Jca=function(){return Fra&&this.D?this.D.then(function(){return this.F.slice()},null,this):lW.prototype.Jca.call(this)};p.$Ja=function(a,b){return Math.pow(Math.random(),1/(rrc(a)*b))};
p.qh=da("H");function rrc(a){switch(a){case 13:return.34;case 3:return.37;case 12:return.25;case 5:return.3;case 15:return.34;case 2:return.43;case 8:return.76;case 9:return.35;case 14:return.47;case 11:return.4;case 7:return.37;case 10:return.36;case 17:return.41;case 1:return.42;case 16:return.3;default:return.3}}
function qrc(a){var b=null;a.D=new ui(function(a){if(!this.H||3<=this.H.getStatus().getState().C)this.F=this.zA,a();var c=mv(this.jW.rect),e=ub(this.zA,function(a){return a.query});b=Bk(Ak(Nj(Pj(Qj(this.H.Tf("/answers/parsesuggestions").Zf("gid",this.jW.Yc,"range",c),u(function(b){src(this,b).then(a)},this)),u(function(b){8==b.errorCode&&this.Kb.fc(2833,this.qa);this.F=this.zA;a()},this)).setContent(["queries",Hi(e)]).setTimeout(2E3),1)),"POST").$e()},a);Bi(a.D,function(){b&&b.dispose()})}
function src(a,b){return a.Z.C.D.Ae.then(function(){var a=[];if(b.ul())for(var d=b.vg(),e=0;e<d.length;e++){var f;if(f=d[e])f=!!this.O&&!!B(this.O,4),f=trc(this.Z,d[e],this.jW,f),f=urc(f);f&&(this.zA[e].Iq=d[e],a.push(this.zA[e]))}this.F=a},function(){this.F.length=0},a)};function vrc(a,b,c){this.J=a;this.D=[];this.C=[];this.F=b;this.H=c}w(vrc,E);function nW(a,b){oW(a);wrc(a,b)}function wrc(a,b){if(null!=b){var c=iB(a.J),d=c.ld(),d=ub(fc(Jg),d.Y4,d);b=ub(d,Ha(gh,b.rect));for(d=0;d<b.length;d++)if(b[d]&&ph(b[d])){var e=rS(c,b[d],a.H);F(a,e);PG(bI(c),e,!0);e.setVisible(!0);a.D.push(e);e=IH(c,b[d],a.F,1,0);F(a,e);e.setVisible(!0);a.C.push(e)}}}function oW(a){Hc(a.D);Hc(a.C);a.D=[];a.C=[]};var xrc={};$b({F4a:{type:0,DA:"",xA:[]},SUM:{type:1,DA:"Sum",xA:[3,5,13,12,15]},AVERAGE:{type:2,DA:"Average",xA:[3,5,13,12,15]},Nga:{type:3,DA:"Mode",xA:[3]},T4a:{type:4,DA:"Variance",xA:[3]},Z3a:{type:5,DA:"Standard deviation",xA:[3]},MEDIAN:{type:6,DA:"Median",xA:[3,5,13,12]},COUNT:{type:7,DA:"Count",xA:[]},U3a:{type:8,DA:"Bottom",xA:[1,10,14]},V3a:{type:9,DA:"Top",xA:[1,11,10,14]}},function(a){xrc[a.type]=a});function yrc(a){if(a=xrc[a])return a};function zrc(){lW.call(this);this.D=[]}la(zrc,lW);p=zrc.prototype;p.reset=function(){lW.prototype.reset.call(this);this.D=[]};p.$Ja=n(1);p.Ol=function(a){return!this.J.contains(a)&&0<Arc(this,a).length};p.bKa=function(a){return Brc(this,a)};p.vS=function(a,b){return Brc(this,b)};p.ena=function(a){return Brc(this,a)};function Crc(a,b){a.reset();x(b,function(b){x(Dc(b,1),function(b){a.D.push(B(b,1))},a)},a);Sqc(a.D);a.Ica();return jrc(a,3)}
function Arc(a,b){return tb(a.D,function(a){return Bb(yrc(a).xA,b)},a)}function Drc(a,b){a=yb(a.D,function(a){return yrc(a).type==b},a);return yrc(a)}function Brc(a,b){b=Arc(a,b);return Drc(a,b[eW(b.length)]).DA};function Erc(a){var b=a.type;if(!t(b))return null;switch(b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":for(var b=[],c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return t(a.value)?a.value:null}}
function Frc(a,b){var c=a.type;if(t(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(qa(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":qa(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,f=0;e=b[f];f++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}};var Grc="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this;how does this".split(";"),Hrc=[{bk:["Thank you","Thankyou","Thanks"],Sg:"No problem"},{bk:["you are amazing","This is great","omg"],Sg:"Happy to help"},{bk:["I love you"],Sg:"Must be in the air"},{bk:["How do you know","How are you so smart"],Sg:"It's all in the data"},{bk:["Are you sure"],Sg:"Send feedback if this doesn't seem correct to help improve accuracy"},{bk:["How are you"],Sg:"Pretty good, thanks"},
{bk:["Hi","Hello","Hey"],Sg:"Hi, there. Try asking a question about your data."},{bk:["You are stupid","This is dumb","You are wrong"],Sg:"Help improve this experience by sending feedback"},{bk:["How smart are you"],Sg:"Pretty smart"}];function Irc(a){for(var b=0;b<Hrc.length;++b)if(-1!=zb(Hrc[b].bk,function(b){return Pa(a,b)}))return b;return-1};function pW(a,b){this.D=a;this.C=b}pW.prototype.getChartType=g("D");var qW={2:new pW("ColumnChart","Column chart"),3:new pW("LineChart","Time series"),4:new pW("ScatterChart","Scatter chart"),5:new pW("PieChart","Pie chart"),10:new pW("Histogram","Histogram"),7:new pW("LineChart","Line chart")};function rW(a,b,c,d,e,f,h){this.C=a;this.qZ=b;this.H=(void 0===h?null:h)||b;this.D=d;this.Iq=c;this.Ia=d?Dc(d,6):[];this.Oa=d?Dc(d,7):[];this.Ca=d?Dc(d,8):[];this.error=e||1;this.interpretation=d&&yc(d,4)?B(d,4):null;this.O=d?Dc(d,12):[];this.qa=d?Dc(d,21):[];this.Z=f;this.V=!1;this.L=[];this.J=!1;this.F=null;if(this.D&&yc(this.D,17))if(c=B(this.D,17),this.V=B(c,4)||!1,a=Dc(c,3),b=Dc(c,1),0<a.length)if(0==b.length||1>=this.H.length||1>this.H[0].length)this.L.push("Charts for this question are not supported.");
else{for(c=0;c<b.length;c++)if(Bb(a,b[c])){this.J=!0;this.F=b[c];break}null==this.F&&10==a[0]&&Bb(b,2)&&(this.J=!0,this.F=2);null==this.F&&(this.J=!0,this.F=Jrc(this,b),1==a.length&&6==a[0]||this.L.push("Requested chart type is not supported for this question."))}else 0<b.length&&1<this.H.length&&1<this.H[0].length&&(this.F=Jrc(this,b),this.J=B(c,2)||!1,20<=this.H.length||3<=this.H[0].length)&&(this.J=!0)}function Krc(a){return 1==a.error&&null!=a.Iq}
function Lrc(a){return{ZN:Mrc(a),interpretation:a.interpretation,qZ:a.qZ,Iq:a.Iq,q2:1<a.qZ.length&&1<a.qZ[0].length,Am:a.Am(),rVb:a.V,qIb:a.L}}rW.prototype.Am=function(){return Tm&&null!=this.F&&(this.F in qW?!0:!1)&&2<this.H.length};rW.prototype.getChartType=function(){if(!this.Am())return null;var a=this.F;if(a in qW)return qW[a].getChartType();throw Error("Unknown chart type.");};function Nrc(a){if(!a.D||!yc(a.D,17))return null;var b=B(a.D,17);C(b,2,a.J);return b}
function Orc(a){a.Am();return a.H[0][0]}function Prc(a){return ub(Dc(a.D,22),function(b){if(B(b,2)){var c=a.Z.C;return kv(B(b,2),c)}},a)}function Qrc(a){return{ZN:Mrc(a),error:Rrc(a)}}function Jrc(a,b){if(!Dc(a.D,18).length)return b[0];a=Src(a);a=ritz_api.AssistantApi.getAnswersChartsRecommedation(a.toJSON());for(var c=0;c<a.length;c++)if(Bb(b,a[c]))return a[c];return b[0]}function Trc(a,b,c){var d={};null!=b?(d.v=Urc(a,b,c),d.f=b):d.v=null;return d}
function Src(a){for(var b=new QB,c=a.H[0],d=Pb(a.H,1),e=Dc(a.D,18),f=[],h=0;h<c.length;h++)null!=e[h]&&yc(e[h],1)?f.push(Vrc(B(e[h],1))):f.push(0==h?"string":"number"),b.ot({type:f[h],label:c[h]||"",id:"Axis"+h});for(e=0;e<d.length;++e){for(var h=[],k=0;k<c.length;k++)h.push(Trc(a,d[e][k],f[k]));b.bx(h)}return b}
function Urc(a,b,c){switch(c){case "boolean":return"true"==b.toLowerCase()||"1"==b;case "number":return b=b||"0",a=uIa(a.Z.L.C).DECIMAL_SEP,b=b.replace(new RegExp("[^0-9"+a+"]","g"),""),b=b.replace(a,"."),ob(b);case "date":case "datetime":return new Date(b);case "timeofday":if(b){a=b.replace(/[^a-zA-Z0-9]/g," ").split(" ");c=[0,0,0,0];if(!(2>a.length)&&Va(a[0])&&Va(a[1])&&(Va(a[a.length-1])||"am"==a[a.length-1].toLowerCase()||"pm"==a[a.length-1].toLowerCase())){for(var d=0;d<b.length&&4>d;d++)Va(a[d])&&
(c[d]=ob(a[d]));"am"==a[a.length-1].toLowerCase()&&12==c[0]&&(c[0]=0);"pm"==a[a.length-1].toLowerCase()&&12!=c[0]&&(c[0]+=12)}b=c}else b=[0,0,0,0];return b;default:return b||""}}function Vrc(a){switch(a){case 1:return"boolean";case 9:return"number";case 2:return"date";case 3:return"datetime";case 12:return"timeofday";default:return"string"}}
function Wrc(a){if(!yc(a.D,9))return"";if(yc(a.D.getError(),3))switch(B(a.D.getError(),3)){case 1:return"Sorry, questions related to formatting are not supported at this time.";case 2:return"Answers provides formulas based on your data. Charts are currently not supported. Please use the menus to create a chart.";case 3:return"Sorry, this action is not supported at this time.";case 4:return"Sorry, this function is not supported at this time.";case 5:return"Sorry, your question is too generic. Please ask a more specific question.";
default:return"Sorry, this function is not supported at this time."}return a.D.getError().xm()||""}
function Rrc(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer at this time. Please try again later.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about your data.";case 6:return Wrc(a)||"Sorry, couldn't understand your question.";case 7:return a=Irc(a.C),-1!=a?Hrc[a].Sg:""}return""}
function Mrc(a){var b=[];if(Krc(a)){var c=[];x(Mb(a.Ia,a.Ca),function(a){c.push(Xrc(a,"waffle-assistant-answercard-question-unused-phrase"))});x(a.Oa,function(a){c.push(Xrc(a,"waffle-assistant-answercard-question-used-entity"))});Tb(c,function(a,b){return a.fW>b.fW?1:-1});var d=0;x(c,function(c){var e=c.length,h=c.fW;h>d?b.push({text:a.C.substring(d,h),className:null}):(e-=d-h,h=d);0<e&&(d=h+e,b.push({text:a.C.substring(h,d),className:c.dk}))});d<a.C.length&&b.push({text:a.C.substring(d),className:null})}else b.push({text:a.C,
className:null});return b}function Xrc(a,b){return{fW:B(a,2),length:B(a,3),dk:b}};function sW(a,b,c,d){I.call(this);this.O=a;this.V=b;this.qa=c;this.Pa=d;this.Ra=new J(this);F(this,this.Ra);this.C=new NU;F(this,this.C);this.L="";this.J=[];this.F=this.D=this.H=null;this.Z=!1;Mmc(this.C,this.O);this.C.Ca=10;this.C.gb=!0;this.C.O=!1;this.C.CVa("waffle-assistant-visible");this.C.qa=Wa("waffle-assistant-dragged-formula").split(" ");this.C.Re();this.Ra.R(this.C,"beforedragstart",this.Ia).R(this.C,"dragmove",this.Oa).R(this.C,"beforedragend",this.Ca)}w(sW,I);sW.prototype.jf=da("Z");
sW.prototype.Ia=function(a){a=rb(this.O.childNodes,a.C);this.L=this.J[a]};
sW.prototype.Oa=function(a){var b=a.event instanceof Up?a.event.rM:a.event;this.Z?(a.J.Jz(b,!0),a.preventDefault()):(op(a.F,a.event.clientX,a.event.clientY),a=pp(a.F),b=iB(this.V).Td(),Zg(IF(b,"page",!1,!1)).contains(a)?(a=GF(b,a.x,a.y,"page"),(b=jw(Uu(this.qa),a.y,a.x))?a=new Ng(b.jc(),b.qc()):b=dh(a),this.H=a,this.D&&this.D.getRect().equals(b)||(a=iB(this.V),G(this.D),this.D=rS(a,b,"waffle-assistant-formula-insertion-rect"),F(this,this.D),PG(bI(a),this.D),G(this.F),this.F=IH(a,b,"waffle-assistant-formula-insertion-border",
2,0),F(this,this.F),Ygb(this.F,"#000"),this.F.setVisible(!0))):Yrc(this))};sW.prototype.Ca=function(a){if(this.H){var b=this.H,c=Uu(this.qa),b=new $F(c,b,this.L);this.Pa.C(b);this.dispatchEvent(new H("formula_inserted"))}a.J.Jz(null,!0);a.preventDefault();this.L="";Yrc(this)};function Yrc(a){a.H=null;G(a.D);a.D=null;G(a.F);a.F=null};function Zrc(a){var b=a.error,c=a.showHelp;a='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+U(zt({icon:"docs-icon-img docs-icon-unsupported-black"}))+'</div><div class="waffle-assistant-errorcard-content">';c?(b=U(b)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',a+='<div class="waffle-assistant-errorcard-text">'+b+"</div>"):a+='<div class="waffle-assistant-errorcard-text">'+U(b)+"</div>";
return V(a+"</div></div>")};function $rc(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+asc({ZN:a.sF.ZN}),d=a.sF.qZ;var e=a.sF.Iq;var f=a.sF.interpretation,h=a.sF.q2,k=a.sF.Am,l=a.sF.rVb;a=a.sF.qIb;null==d||Ba(d);Ba(a);var m=""+('<div class="waffle-assistant-answercard-answer-container"><div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+rr("Answer")+'"><span aria-hidden="true">Answer</span></div>'+(f?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+
U(f)+"</div></div>":"")+'<div class="waffle-assistant-answercard-answer-content">');if(d){if(!l){k&&(m+='<div class="waffle-assistant-answercard-tabs"><div class="waffle-assistant-answercard-formula-tab">FORMULA</div><div class="waffle-assistant-answercard-chart-tab" id="waffle-assistant-answercard-chart-tab">CHART</div></div>');m+='<div class="waffle-assistant-answercard-answer">';if(h){m+='<div class="waffle-assistant-answercard-answer-rowheader">';for(var l=d[0],f=l.length,q=0;q<f;q++)m+='<span class="waffle-assistant-answercard-answer-col">'+
U(l[q])+"</span>";m+="</div>"}m+='<div class="waffle-assistant-answercard-answer-rows">';l=nr("waffle-assistant-answercard-answer-row"+(h?" waffle-assistant-answercard-answer-list-row":""));f=d.length;for(q=0;q<f;q++){var r=d[q];if(h&&0==q)r="";else{var v=l;Ba(r);for(var v='<div class="'+W(v)+'">',y=r.length,z=0;z<y;z++)var D=r[z],v=D?v+('<span class="waffle-assistant-answercard-answer-col">'+U(D)+"</span>"):v+('<span class="'+W("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+
'">N/A</span>');r=V(v+"</div>")}m+=r}m+="</div></div>"}m+=k?'<div class="waffle-assistant-answercard-chart-container"><div class="waffle-assistant-answercard-chart-type-select"></div><div class="waffle-assistant-answercard-chart"></div></div>':""}if(0<a.length){m+='<div class="waffle-assistant-answercard-info-msgs">';d=a.length;for(h=0;h<d;h++)m+='<div class="waffle-assistant-answercard-info-msg">* '+U(a[h])+"</div>";m+="</div>"}m+='<div class="waffle-assistant-answercard-footer">';k&&(m+='<div class="waffle-assistant-answercard-insert-chart">INSERT CHART</div>');
m+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-icon">'+U(zt({icon:"docs-icon-img docs-icon-insert-formula"}))+'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+
U(e)+"</div></div></div></div></div></div></div>";e=V(m);return b(c+e+"</div></div>")}
function asc(a){Ba(a.ZN);a=a.ZN;var b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+rr("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+W(e.className)+'">'+U(e.text)+"</span>":U(e.text)}return V(b+"</div></div></div>")}
function bsc(){var a=V;var b=V('<div class="waffle-assistant-answers-card-remove">'+U(zt({icon:"docs-icon-img docs-icon-trash"}))+"</div>");return a(U(b))};function csc(a){this.Kb=a}function dsc(a,b){var c=new JV;N(c,3,b);N(c,8,Zra);b=new zS;ai(b,4,c);c=new fi;ai(c,46,b);c=pi(oi(new ni,10),c).build();a.Kb.fc(2753,c)};function esc(a,b,c,d,e,f){H.call(this,"sqc");this.V=a;this.J=f||"";this.L=b;this.F=d;this.Z=e;this.C=c}w(esc,H);function fsc(a,b,c,d){var e=new rpc;N(e,2,c);x(b,function(a){M(e,1).push(a)});N(e,3,d);d=new IV;N(d,1,a);N(d,3,b[c]);ai(d,11,e);return d}function gsc(a,b,c,d){var e=new tpc;N(e,2,c);x(b,function(a){M(e,1).push(a)});N(e,3,d);d=new IV;N(d,1,a);N(d,2,b[c]);ai(d,10,e);return d}function hsc(a){var b=new upc;x(a,function(a){var c=a.type;M(b,1).push(c);a.xIa&&(a=a.xIa,M(b,2).push(a))});return b}function isc(a){var b=new spc;x(a,function(a){a=a.type;M(b,1).push(a)});return b}
function jsc(a){var b=new qpc,c=Dc(a,3),d=Dc(a,1);if(0<c.length){for(var e,f=0;f<d.length;f++)if(Bb(c,d[f])){e=d[f];break}e||(e=c[0]);N(b,2,e)}for(c=0;c<d.length;c++)e=d[c],M(b,3).push(e);a=B(a,2);N(b,4,a);return b};function tW(a,b,c,d,e,f,h,k,l,m,q){XV.call(this,new KU,q);this.C=a;this.hf=Prc(a);this.Xb=a.Am();this.Kc=a.Am()&&a.J;this.Tb=a.V;this.Pa=!1;this.Ac=b;this.Qb=c;this.bd=d;this.Bd=l;this.qg=h;this.Kb=e;this.pe=f;this.$d=k;this.Ue=m;this.Me=oi(new ni,10).build();this.zb=new es("",new UV,this.Ba());this.Wa(this.zb);this.L=null;this.J=new es("",new TV,this.Ba());this.Wa(this.J);this.qa=new es("",new TV,this.Ba());this.Wa(this.qa);this.Ia=new es("",new UV,this.Ba());this.Wa(this.Ia);this.H=new pT;this.Wa(this.H);
this.Z=new rH("");this.Wa(this.Z);this.F=null;this.xc=Src(this.C);this.Xa=new vrc(b,"waffle-assistant-answers-range-styled-border","waffle-assistant-answers-range-styled-rect");F(this,this.Xa);this.bb=!1}w(tW,XV);p=tW.prototype;p.Fma=g("$d");p.Ga=function(){tW.$.Ga.call(this);Wpc(this).appendChild(S(bsc))};
p.Sa=function(){tW.$.Sa.call(this);var a=this.$a("waffle-assistant-answers-card-remove");this.zb.mb(a);VV(a,"Remove card",0);this.getHandler().Jc(this.zb,"action",this.k1b).R(this.J,"action",this.OCb).R(this.qa,"action",this.qub).Jc(this.J,"action",u(this.SQa,this,!0)).Jc(this.qa,"action",u(this.SQa,this,!1))};
p.WI=function(a){YV(this).appendChild(S($rc,{sF:Lrc(this.C)}));this.J.mb(this.$a("waffle-assistant-answercard-see-formula-link"));this.qa.mb(this.$a("waffle-assistant-answercard-hide-formula-link"));this.L=new sW(this.$a("waffle-assistant-answercard-formula-text-container"),this.Ac,this.Qb,this.bd);this.L.jf(this.Fd());this.L.J=[this.C.Iq];F(this,this.L);var b=this.$a("waffle-assistant-answercard-formula-text");VV(b,"Click to copy or drag to insert",void 0,"Formula: "+(this.C.Iq+". Click/Press ENTER to copy or drag to insert on to sheet."));
Zic(b,this.Fd());Of(this.getHandler().Jc(this.L,"formula_inserted",this.cKb),this.$a("waffle-assistant-answercard-formula-text"),fd,this.Etb);ksc(this,this.Ue);if(this.Xb){if(this.Tb)lsc(this,this.C.getChartType()),this.Pa=!0;else{this.H.mb(this.$a("waffle-assistant-answercard-tabs"));b=new nT("");b.mb(this.$a("waffle-assistant-answercard-formula-tab"));this.H.Wa(b);var c=new nT("");c.mb(this.$a("waffle-assistant-answercard-chart-tab"));this.H.Wa(c);this.getHandler().R(this.H,"select",this.XEb).Jc(b,
"action",u(this.QQa,this,0)).Jc(c,"action",u(this.QQa,this,1));this.H.Ew(this.Kc?c:b)}b=Dc(B(this.C.D,17),1);for(c=0;c<b.length;c++)this.Z.re(msc(b[c]));this.Z.mb(this.$a("waffle-assistant-answercard-chart-type-select"));at(this.Z,msc(this.C.F));b=this.$a("waffle-assistant-answercard-insert-chart");this.Ia.mb(b);nsc(this);this.getHandler().R(this.Ia,"action",this.j1b).R(this.Z.Gc(),"action",this.iob)}a()};p.rea=function(){return this.Xb&&!this.Tb&&!this.Kc};
function msc(a){if(a in qW)return new Pq(qW[a].C,a);throw Error("Unknown chart type.");}p.iob=function(a){a=a.target.hb();if(a in qW)lsc(this,qW[a].getChartType());else throw Error("Unknown chart type model.");};
function lsc(a,b){a.F=new DU;C(a.F,1,b);C(a.F,2,a.C.interpretation||"");if("Histogram"===b)b=Orc(a.C),C(a.F,3,b),C(a.F,6,"Count");else if("LineChart"===b||"ColumnChart"===b)b=0,"number"!=a.xc.jd(0)&&(b=a.xc.eh(0),C(a.F,3,b),b=1),1==a.xc.getNumberOfColumns()-b?(b=a.xc.eh(b),C(a.F,6,b)):C(a.F,6,"Values");else{b=a.F;var c=Orc(a.C);C(b,3,c);c=a.C;c.Am();C(b,6,c.H[0][1]||"")}b=lqc(a.F);b.ke(a.xc);c=a.$a("waffle-assistant-answercard-chart");b=mqc(b,c);oU(b,b.Sd());b.setOption("title","");CU(b,c,a.Kb,Vm);
a.Pa=!0}
p.j1b=function(){if(this.F){var a=lqc(this.F);a.ke(this.xc);oU(a,a.Sd());var b=Uu(this.Qb),c=wv(b),d=Gic(b,c,!1),c=dB(b,d.y),b=eB(b,d.x),d=ZZa(this.Bd.J),c={oid:null,ar:c,ac:b,x:16,y:16,h:py.height,w:py.width,p:{context:{chartName:"Chart "+(d+1)}}},b=new nf;C(b,2,"0.6");d=this.xc.toJSON();C(b,1,d);c=new vC(Ou(this.Qb)||0,c,!1,!1,b);tS(c,a);this.Ac.dispatchEvent(new jD("objectRequest"));this.bd.C(new XF(this.Bd,c));c=this.C.F;a=new opc;N(a,1,c);c=new JV;ai(c,11,a);a=new zS;ai(a,4,c);c=new fi;ai(c,
46,a);a=pi(oi(new ni,10),c).build();this.Kb.fc(2874,a)}};p.MI=function(){Yo(this.Ka,"Answer Card for question: "+this.C.C)};p.nE=Rf;p.sG=n("assistantAnswersFeedback");p.lM=n(2628);p.kM=n(2627);p.M$=n("Was this answer correct?");p.una=n("Correct");p.tna=n("Incorrect");p.aP=g("C");p.jf=function(a){tW.$.jf.call(this,a);this.L&&this.L.jf(a);var b=this.Hb("waffle-assistant-answercard-formula-text");b&&Zic(b,a);nsc(this)};
p.A1=function(){tW.$.A1.call(this);if(!this.bb){var a=this.Xa,b=this.hf;oW(a);for(var c=0;c<b.length;c++)wrc(a,b[c]);this.bb=!0}};p.KT=function(){tW.$.KT.call(this);oW(this.Xa);this.bb=!1};p.XEb=function(){switch(qT(this.H)){case 0:osc(this,!1);break;case 1:osc(this,!0);break;default:qT(this.H)}};
function osc(a,b){Q(a.$a("waffle-assistant-answercard-chart-container"),b);Q(a.$a("waffle-assistant-answercard-answer"),!b);Q(a.$a("waffle-assistant-answercard-formula-holder"),!b);nsc(a);!a.Pa&&b&&lsc(a,a.C.getChartType())}function nsc(a){var b=(a.Tb||1==qT(a.H))&&!a.Fd();a.Ia.setVisible(b)}function ksc(a,b){a.J.setVisible(!b);a.qa.setVisible(b);Q(a.$a("waffle-assistant-answercard-formula"),b);b?a.$a("waffle-assistant-answercard-formula-text").focus():(a.J.Ka.focus(),a.J.iq(!0))}
p.k1b=function(){dsc(this.pe,!0);this.dispatchEvent(new H("rc"))};p.OCb=function(){ksc(this,!0)};p.qub=function(){ksc(this,!1)};p.SQa=function(a){var b=new JV;N(b,9,a);a=new zS;ai(a,4,b);b=new fi;ai(b,46,a);b=pi(oi(new ni,10),b).build();this.Kb.fc(2849,b)};
p.QQa=function(a){var b=this.C.F,c=Nrc(this.C),d=new qpc;c&&(d=jsc(c));N(d,1,b);b=new ppc;ai(b,1,d);switch(a){case 0:N(b,2,2);break;case 1:N(b,2,1);break;default:N(b,2,0)}a=new JV;ai(a,10,b);d=new zS;ai(d,4,a);a=new fi;ai(a,46,d);a=pi(oi(new ni,10),a).build();this.Kb.fc(2850,a)};p.cKb=function(){this.Kb.fc(2709,this.Me)};
p.Etb=function(){var a=this.Ba().Ub(),b=a.createElement("textarea");b.textContent=this.C.Iq;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&uW(this.qg,"Formula copied to clipboard",this.Ba())};function psc(){var a=nr("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<input type="text" class="waffle-assistant-answers-input-box" placeholder="'+W(a)+'" aria-label="'+W(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');a+='<div class="'+W("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+
'">'+U(zt({icon:"docs-icon-img docs-icon-cancel"}))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="display:none"></div></div></form></div>';return V(a)};function qsc(a){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+U(asc({ZN:a.KHa.ZN}))+U(Zrc({error:a.KHa.error,showHelp:a.showHelp}))+"</div></div>")}function rsc(){return V('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function vW(a,b,c,d,e){XV.call(this,new KU,e);this.H=a;this.Z=b;this.L=d;this.qa=c;this.J=new es("",new UV,this.Ba());this.Wa(this.J);this.C=new es("",new TV,this.Ba());this.Wa(this.C);this.F=new es("",new TV,this.Ba());this.Wa(this.F)}w(vW,XV);p=vW.prototype;p.MI=function(){Yo(this.Ka,"Error Card for question: "+this.H.C)};p.sG=n("assistantAnswersFeedback");p.nE=Rf;p.vba=Qf;p.Ga=function(){vW.$.Ga.call(this);Wpc(this).appendChild(S(bsc))};
p.Sa=function(){vW.$.Sa.call(this);var a=this.$a("waffle-assistant-answers-card-remove");this.J.mb(a);this.F.setVisible(this.L);VV(a,"Remove card",0);this.getHandler().Jc(this.J,"action",this.p1b).Jc(this.C,"action",this.ZCb).R(this.F,"action",this.o1b)};
p.WI=function(a){YV(this).appendChild(S(qsc,{KHa:Qrc(this.H),showHelp:this.L}));if(Nm){var b=S(rsc);this.Ba().appendChild(this.Ka,b);this.C.mb(this.$a("waffle-assistant-answercard-feedback-link"))}this.L&&this.F.mb(this.$a("waffle-assistant-answers-helpcenter-link"));a()};p.Fma=g("Z");p.aP=g("H");p.ZCb=function(){this.C.setVisible(!1);Q(this.$a("waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new H("trigger_feedback"))};p.p1b=function(){dsc(this.qa,!1);this.dispatchEvent(new H("rc"))};
p.o1b=function(){P.Ho.Cc()};function ssc(a){XV.call(this,new KU,a);this.C=this.Ba().createElement("div");Zl(this.C,"Previous")}w(ssc,XV);p=ssc.prototype;p.MI=function(){Yo(this.Ka,"Previous questions below")};p.Ga=function(){ssc.$.Ga.call(this);cp(this.Ka,"waffle-assistant-card");ap(this.Ka,"waffle-assistant-answers-previousheadercard")};p.WI=function(a){0<this.Ba().ji(YV(this)).length||YV(this).appendChild(this.C);a()};p.vba=Qf;p.sG=n("assistantAnswersFeedback");function tsc(a){var b=""+((a.G9?U(Zrc({error:a.G9,showHelp:a.showHelp})):"")+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+U(a.title)+"</div>":""));var c=nr("Suggested question");b+='<div class="waffle-assistant-suggested-questions">';a=a.zA;for(var d=a.length,e=0;e<d;e++){var f=a[e];b+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+W(c)+'">'+U(zt({icon:"docs-icon-img docs-icon-help"}))+
'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+U(f)+"</div></div></div>"}return V(b+"</div>")};function wW(a,b,c,d,e,f){XV.call(this,a,f);this.C=e||null;this.Z=b;this.F=d;this.qa=c;this.L=this.C?5==this.C.error:!1;this.H=new es("",new TV,this.Ba());this.Wa(this.H);this.J=new es("",new UV,this.Ba());this.Wa(this.J)}w(wW,XV);p=wW.prototype;p.Ga=function(){wW.$.Ga.call(this);this.nE()&&Wpc(this).appendChild(S(bsc))};
p.Sa=function(){wW.$.Sa.call(this);ap(this.Ka,"waffle-assistant-answers-suggestioncard");this.H.setVisible(this.L);this.getHandler().R(this.H,"action",this.q1b);if(this.nE()){var a=this.$a("waffle-assistant-answers-card-remove");this.J.mb(a);VV(a,"Remove card",0);this.getHandler().Jc(this.J,"action",this.r1b)}};p.lM=function(){return Bb([usc,xW],this.F)?2799:Bb([vsc,wsc],this.F)?2801:null};p.kM=function(){return Bb([usc,xW],this.F)?2798:Bb([vsc,wsc],this.F)?2800:null};p.M$=n("Were these interesting?");
p.una=n("Interesting");p.tna=n("Not interesting");p.sG=n("assistantAnswersFeedback");p.nE=function(){return this.C?!Krc(this.C):!1};p.MI=function(){var a=this.F.title;a&&this.C?Yo(this.Ka,a+(" for question : "+this.C.C)):Yo(this.Ka,"Suggested questions")};
p.WI=function(a){var b=this;this.qa.then(function(c){if(0==c.length)Q(b.Ka,!1);else{var d=b.Ba(),e=YV(b);if(0==d.ji(e).length){var f=S(tsc,{title:b.F.title,zA:ub(c,function(a){return a.query}),G9:b.C?Rrc(b.C):"",showHelp:b.L});e.appendChild(f);var h=ub(c,function(a){return a.type}),e=b.Ui("waffle-assistant-answercard-question-container");x(e,function(a,e){var f=new es("",new UV,d);b.Wa(f);f.mb(a);b.getHandler().R(f,"action",u(b.JEb,b,c[e],h,e))});b.L&&b.H.mb(b.$a("waffle-assistant-answers-helpcenter-link"))}}a()})};
p.r1b=function(){dsc(this.Z,!1);this.dispatchEvent(new H("rc"))};p.JEb=function(a,b,c){this.dispatchEvent(new esc(this.F.p4,a.Iq||null,b,c,this.F.XZ,a.query))};p.q1b=function(){P.Ho.Cc()};var xsc={title:"",XZ:0,p4:null},usc={title:"",XZ:5,p4:1},xW={title:"Suggested questions",XZ:5,p4:1},wsc={title:"Did you mean?",XZ:2,p4:4},vsc={title:"Related questions",XZ:4,p4:4};function ysc(a){this.F=[];this.D={};this.J=a;this.C=new lN}function zsc(a,b,c,d){function e(a){return a.toLowerCase()}Qb(b,void 0,e);Qb(c,void 0,e);Qb(d,void 0,e);x(b,a.H,a);x(c,a.H,a);x(d,a.H,a)}ysc.prototype.H=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,f=b.substr(d),h=this.C.get(f);h||(h=[],this.C.add(f,h));h.push(e)}};
function Asc(a,b){a.D[b.toLowerCase()]||(a.D[b.toLowerCase()]=b)}ysc.prototype.hI=function(a,b,c){if(Wa(a||"")){var d=this.J.Pm();d=Bsc(this,a.substring(0,d));var e=Csc(this,b-d.length,a);d=Mb(d,e)}else d=Csc(this,b);d.length>b&&(d=Pb(d,0,b));c(a,d)};
function Csc(a,b,c){var d=c||"";c=ac(a.D,function(a){return Pa(a,d)});var e=Dsc(fc(c),d?1:2,1);a=tb(a.F,function(a){return Pa(a.query,d)&&!e[a.query.toLowerCase()]});b=Dsc(a,b-ec(e),2);b=fc(b);var f=ub(b,function(a,b){a.Ava=b;return a.gXa});x(b,function(a){a.yva=f});return Mb(b,fc(e))}
function Bsc(a,b){for(var c=[],d=3,e={},f=b.toLowerCase(),h={},k=0;k<f.length&&0<d;h={Nea:h.Nea,S2:h.S2,UU:h.UU},++k)if(0==k||" "==f[k-1]&&" "!=f[k]){h.UU={};h.S2=0;h.Nea=f.substr(k);var l=a.C.Ie(h.Nea);x(l,function(b){return function(c){var d=c.length-b.Nea.length;b.S2=Math.max(d,b.S2);c=a.C.get(c);b.UU[d]||(b.UU[d]=[]);Ob(b.UU[d],c)}}(h));for(l=0;l<=h.S2&&0<d;++l){var m=h.UU[l];if(m)for(var q=0;q<m.length&&0<d;++q){var r=m[q];bb(b.toLowerCase(),r.toLowerCase())||e[r]||(--d,c.push({text:r,Iq:"",
yA:0,PDa:f.length-k,gXa:void 0,yva:[],Ava:-1}),e[r]=!0)}}}return c}function Dsc(a,b,c){b=Qqc(a.length,Math.min(a.length,b));var d={};x(b,function(b){b=a[b];var e=qa(b)?b:b.query;d[e.toLowerCase()]={text:e,Iq:qa(b)?"":b.Iq,yA:c,PDa:0,gXa:qa(b)?void 0:b.type,yva:[],Ava:-1}});return d};function yW(){EG.call(this,"",null,!1)}w(yW,EG);yW.prototype.PD=function(a,b){if(2==a.yA||1==a.yA)return yW.$.PD.call(this,a.text,b);var c=this.Za(),d=this.Pm(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var f=c.substring(0,d-a.PDa)+a.text;e||(f+=" ");a=yW.$.PD.call(this,{toString:function(){return f+c.substring(d)}},b);b=this.rk;b.blur();b.focus();this.U3(f.length);return a};
yW.prototype.Og=function(a){var b=yW.$.Og.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,Dfb(b)&&b.WG()&&a.preventDefault(),b=!0);return b};function Esc(){return V('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+U(zt({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+U(zt({icon:"docs-icon-img docs-icon-clock"}))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+U(zt({icon:"docs-icon-img docs-icon-arrow-tilted"}))+'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')}
;function Fsc(a){this.wb=a||wl()}
Fsc.prototype.nA=function(a,b,c){b=S(Esc);var d=this.wb.$a("waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.wb.rf(d,a.text);var d=this.wb.$a("waffle-assistant-answers-ac-entity-icon",b),e=this.wb.$a("waffle-assistant-answers-ac-suggested-query-icon",b),f=this.wb.$a("waffle-assistant-answers-ac-session-query-icon",b);Q(d,0==a.yA);Q(e,2==a.yA);Q(f,1==a.yA);d="";switch(a.yA){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&ap(c,d);this.wb.appendChild(c,b)};function zW(a,b,c,d,e,f,h,k,l,m,q,r,v){ZV.call(this,v);this.Gg=c;this.Gi=d;this.Qh=e;this.qg=a;this.Kc=new zrc;this.Ib=h;this.Oa=m;this.Hi=q;this.Tg=r;this.Xa=this.V=this.L=this.gc=this.H=null;this.Ia=new yW;this.Ia.AIa=!0;this.Ia.Oa=!0;this.bb=new ysc(this.Ia);a=new CG(null,new Fsc(v));this.J=new yG(this.bb,a,this.Ia);F(this,this.J);this.Kb=f;this.ib=this.Pa=this.F=null;this.zb=k;this.Ue=this.Qb=!1;this.pb=oi(new ni,10).build();this.De=new th;this.Xb=l;this.Ca={};this.Z=this.Bd=this.D=this.bd=null;
this.Me=Ji.getInstance();this.Tb="";this.gb=null}w(zW,ZV);p=zW.prototype;p.Ga=function(){zW.$.Ga.call(this);var a=this.J.xe();a.className="waffle-assistant-answers-ac-renderer";a.eO="waffle-assistant-answers-ac-row";a.x7="waffle-assistant-answers-ac-active";a.dqa="waffle-assistant-answers-ac-highlighted"};p.Sa=function(){zW.$.Sa.call(this);this.Ia.C=this.J;this.J.yZ=!1;this.J.yca=6;this.getHandler().R(this.J,"update",this.Emb);this.tI(null==this.F)};
p.Fta=function(a,b){zW.$.Fta.call(this,a,b);b=this.Ba();var c=this.qa;b.appendChild(a,S(psc));this.Bd=b.$a("waffle-assistant-answers-input",a);this.Z=b.$a("waffle-assistant-answers-query-box",a);this.L=new es("",new UV,this.Ba());c.Wa(this.L);this.L.mb(b.$a("waffle-assistant-answers-clear-query-button",this.Z));this.Xa=new ZU(!1,"#4285f4");c.Wa(this.Xa);this.bd=b.$a("waffle-assistant-answers-spinner-container",this.Z);this.Xa.render(this.bd);this.D=b.$a("waffle-assistant-answers-input-box",this.Z);
Sfb(this.Ia,this.D);VV(this.L.getElement(),"Clear query");c.getHandler().R(this.Z,"submit",u(this.sGb,this)).R(this.Z,"focus",u(this.EHa,this,!0),!0).R(this.Z,"blur",u(this.EHa,this,!1),!0).R(this.L,"action",u(this.Q7a,this)).R(this.D,"input",u(this.tXb,this)).R(this.D,"focus",u(this.HUa,this));this.L.setVisible(!1)};p.L8=function(){Ufb(this.Ia,this.D);this.L.setVisible(!1);this.Xa.dispose();this.Xa=null;zW.$.L8.call(this)};
p.tI=function(a){var b=this;if(this.Bd){Q(this.Bd,!a);var c=tu;c&&c.dispatchEvent("resize")}a?(this.gb&&this.gb.dispose(),this.gb=new Ek(function(){zW.$.tI.call(b,a)},300,this),F(this,this.gb),this.gb.start()):(this.gb&&this.gb.stop(),zW.$.tI.call(this,a))};p.qh=da("gc");
function Gsc(a,b,c,d,e){e=void 0===e?[]:e;a.Kc.Re(c,b,e);e=ub(Dc(c,1),function(a){return a.getName()});var f=[],h=[];x(Dc(c,2),function(a){f.push(a.getName());h=h.concat(Dc(a,2))});zsc(a.bb,e,f,h);a.qg.Jca().then(function(a){this.bb.F=a;nm(this.Ba())==this.D&&this.HUa()},null,a);e=a.F&&a.Pa&&b&&d&&(!a.F.equals(b)||!a.Pa.equals(d));a.F=b;a.Pa=d;a.ib=c;if(e&&Zm)for(c=ub(a.C,function(a){if(a instanceof tW||a instanceof vW)return a.aP().C}),a.c_(),d=0;d<c.length;d++)if(e=c[d]){var k=new IV;N(k,1,5);AW(a,
k,void 0,e)}a.tI(null==b)}p.reset=function(){hT(this.Ca);hT(this.bb.D);var a=this.bb;a.F=[];a.C.clear();this.V=null;this.mFa()};p.Emb=function(a){if(a.row)if(a=a.row,2==a.yA){var b=fsc(1,a.yva,a.Ava,2);AW(this,b,a.Iq);this.Kb.fc(2652,this.pb)}else 0==a.yA?(this.Qb=!0,this.Kb.fc(2651,this.pb)):1==a.yA&&(a=new IV,N(a,1,3),AW(this,a))};p.EHa=function(a){ep(this.Z,"waffle-assistant-answers-query-box-focused",a);this.J.Of()&&!a&&this.J.Jj()};p.tXb=function(){this.L.setVisible(!!Erc(this.D))};
p.HUa=function(){this.J.Fw(this.D);var a=ib(Erc(this.D));this.Ia.U3(a.length);Afb(this.J,a||"  ");this.J.update(!0)};
function AW(a,b,c,d){var e=a.Oa.L.Ts();N(b,13,e);e=new JV;ai(e,5,b);d=d||Wa(Erc(a.D));a.D.blur();a.L.setVisible(!!d);a.J.Of()&&a.J.Jj();if(!a.gc||3<=a.gc.getStatus().getState().C)if(a.Ca[d])Hsc(a,d,!1);else{c=new rW(d,null,null,null,2,a.Oa);Isc(a,c,!0,e);return}else{var f=a.Ca[d];f&&f instanceof vW&&2==f.aP().error&&delete a.Ca[d]}if(d&&a.F)if(a.Ca[d])a.Kb.fc(2681,a.pb),Hsc(a,d,!0);else{var f=Jsc(),h=Zh(Zh(f,zS,46),JV,4);N(h,2,a.Qb);f=pi(oi(new ni,10),f).build();a.Kb.fc(2635,f);a.Qb=!1;f=mv(a.F.rect);
b=Ak(Nj(Bk(Pj(Qj(a.gc.Tf("/answers/parse").Zf("q",d,"qt",M(b,1),"gid",a.F.Yc,"range",f),u(a.Pk,a,d,e)),u(a.l1b,a,d,e)),"POST"),2));Zm&&a.Pa&&(e=0==a.Pa.rect.width||0==a.Pa.rect.height?"":mv(a.Pa.rect),b.Zf("headerRange",e));c&&b.Zf("sgfml",c);b.$e();a.Tb=Ki(a.Me,uj.qxa);Ksc(a,!0)}else Frc(a.D,"")}function Hsc(a,b,c){var d=a.Ca[b];d!=qb(a.C)&&(1<a.C.length&&Lsc(a),c&&Msc(a,d.aP()).then(function(a){Nsc(this,d,a)},null,a),fqc(a,d))}
p.sGb=function(a){a.stopPropagation();a.preventDefault();a=new IV;N(a,1,2);AW(this,a)};p.Q7a=function(){Frc(this.D,"");this.L.setVisible(!1)};p.l1b=function(a,b){if(this.F){var c=M(Zh(b,IV,5),1),c=1==c||4==c?vpc.NBa:vpc.jCa,d=Jsc(),e=Zh(Zh(d,zS,46),JV,4);N(e,1,c);N(b,1,c);c=pi(oi(new ni,10),d).build();this.Kb.fc(2640,c);Osc(this,a,b)}};function Osc(a,b,c){Ksc(a,!1);b=new rW(b,null,null,null,3,a.Oa);Isc(a,b,!1,c);Psc(a)}
p.Pk=function(a,b,c){this.F&&this.zb.C.D.Ae.then(function(){var d=null,e=null,f=!1,h=Zh(b,IV,5),k=M(h,1),l=Jsc(),k=1==k||4==k?vpc.NBa:vpc.jCa,m=Zh(Zh(l,zS,46),JV,4);N(m,1,k);N(b,1,k);l=pi(oi(new ni,10),l).build();if(c.ul()){e=this.De.cd(MV.Qa(),c.vg());if(f=e.getStatus()){switch(f){case 1:var q=2639;break;case 2:q=2643;break;case 3:q=2644;break;case 4:q=2638;break;case 5:q=2707;break;case 6:q=2706}q&&this.Kb.fc(q,l)}q=B(e,10);N(h,4,q);q=B(e,11);N(h,5,q);yc(e,16)&&(q=B(e,16),N(h,16,q));if(1==f){Osc(this,
a,b);return}if(2==f){e=-1!=Qsc(a);h=-1!=Irc(a);f=4;d=Zh(b,IV,5);e?(f=5,N(d,8,2)):h&&(f=7,N(d,8,1));h=new rW(a,null,null,null,f,this.Oa);e?(e=new vW(h,!0,this.Xb,!0,this.Ba()),Rsc(this,h,e,b)):Isc(this,h,!0,b);Ksc(this,!1);Psc(this);return}q=yc(e,2)?B(e,2):null;f=!0;if(q){k="";d=trc(this.zb,q,this.F,!!this.ib&&!!B(this.ib,4));N(h,14,!!d);if(!d){if(m=q.match(/([A-Z]*)\(/)){var r=Zh(Zh(l.C?Zh(l.C,fi,4):null,zS,46),JV,4);N(r,7,m[1]);N(b,7,m[1])}this.Kb.fc(2645,l)}d&&urc(d)||(l=this.zb,r=this.F,k="="!=
q[0]?"="+q:q,m=Ssc(l),r=Tsc(m,r),k=hyb(l.C,k,m,r.row,r.zj));l=yc(e,19)?trc(this.zb,B(e,19)||"",this.F,!!this.ib&&!!B(this.ib,4)):d;d=new rW(a,d,"="!=q[0]?"="+q:q,e,null,this.Oa,l);k&&d.L.push(k);d.Am()&&(q=Nrc(d),l=new qpc,q&&(l=jsc(q)),N(l,1,d.F),ai(h,15,l))}else yc(e,9)&&(q=e.getError(),d=new rW(a,null,null,e||null,6,this.Oa),l=B(q,2),N(h,6,l),yc(q,3)&&(q=B(q,3),N(h,12,q)))}else this.Kb.fc(2640,l);d||(d=new rW(a,null,null,e||null,4,this.Oa));Ksc(this,!1);Krc(d)?Usc(this,d,f,b):Isc(this,d,f,b);Psc(this)},
function(){Osc(this,a,b)},this)};function Psc(a){""!=a.Tb&&(Li(a.Me,a.Tb),a.Tb="")}function Vsc(a){if(null!=a.Iq)return vsc;switch(a.error){case 4:case 6:return 0<a.O.length?wsc:xW;case 5:return xW}return xsc}function Jsc(){var a=new JV;N(a,8,Zra);var b=new zS;ai(b,4,a);a=new fi;ai(a,46,b);return a}function Qsc(a){return zb(Grc,function(b){return Pa(a,b)})}
function Wsc(a,b){var c=[];b=b.O;for(var d=0;d<b.length&&3>c.length;++d){var e=B(b[d],2),f=!!a.ib&&!!B(a.ib,4),e=trc(a.zb,e,a.F,f);urc(e)&&(e={query:B(b[d],1),Iq:B(b[d],2),type:b[d].getType()},yc(b[d],5)&&(e.xIa=B(b[d],5)),c.push(e))}return wi(c)}function Usc(a,b,c,d){c=new tW(b,a.Gg,a.Gi,a.Qh,a.Kb,a.Xb,a.Ib,c,a.Oa,a.Ue,a.Ba());Rsc(a,b,c,d)}
function Xsc(a,b,c){if(a.H&&a.H.kb())oG(a.H);else{var d=a.Hi.D.C["ritz-ap"]||null;c.rea()&&(a.H=qG(a.Tg,a.Ba(),d,void 0,"answersChartsPromo"),a.H&&(a.H.show(),F(a,a.H),a.getHandler().Jc(a,"me",a.mFa)));b.Am()&&h0a(d,"answersChartsPromo")}}p.tfa=function(){zW.$.tfa.call(this);this.H&&this.H.kb()&&this.H.C.ud()};p.mFa=function(){this.H&&this.H.kb()&&oG(this.H)};function Isc(a,b,c,d){c=new vW(b,c,a.Xb,!1,a.Ba());Rsc(a,b,c,d)}
function Rsc(a,b,c,d){Lsc(a);var e=Msc(a,b,d);Ysc(a,c);c instanceof tW&&Xsc(a,b,c);Zsc(a);Krc(b)&&Asc(a.bb,b.C);e.then(function(a){if(d){var b=Jsc(),e=Zh(b,zS,46);ai(e,4,d);b=pi(oi(new ni,10),b).build();this.Kb.fc(2781,b)}Nsc(this,c,a)},null,a);c.Fma()&&(a.Ca[b.C]=c);a.getHandler().R(c,"rc",a.YNa)}function Nsc(a,b,c){b instanceof vW&&null!=c&&Dp(c.getElement())&&(b=b.getElement(),Q(b,!1),a.getHandler().R(c,"rc",a.YNa))}
function Lsc(a){$sc(a);x(a.C,function(a){a instanceof vW&&(a=a.getElement(),Q(a,!0))});atc(a)}function atc(a){0!=a.C.length&&(a.V?fqc(a,a.V):(a.V=new ssc(a.Ba()),Ysc(a,a.V)))}function $sc(a){x(a.C,function(b){b instanceof tW||b instanceof vW||b==a.V||a.fI(b)})}function btc(a,b){var c=wi([]);b=b.qa;0<b.length&&(c=Crc(a.Kc,b));return c=c.then(function(b){var c=3-b.length;return 0<c?jrc(a.qg,c).then(function(a){return Mb(b,a)}):wi(b)})}
function Msc(a,b,c){var d=Vsc(b),e=null;d==vsc||d==wsc?0<b.O.length&&(e=Wsc(a,b)):d==xW&&(e=btc(a,b));var f=null;return e?(f=new wW(new KU,a.Xb,e,d,b,a.Ba()),Ysc(a,f),a.Kb.fc(2769,a.pb),a.getHandler().R(f,"sqc",u(a.IEb,a)),e.then(function(a){if(c){var b=Zh(c,IV,5);Bb([vsc,wsc],f.F)?(a=hsc(a),ai(b,7,a)):Bb([usc,xW],f.F)&&(a=isc(a),ai(b,9,a))}return f},null,a)):wi(f)}
p.IEb=function(a){Frc(this.D,a.J);this.D.focus();var b=a.V,b=1==b?fsc(b,a.C,a.F,3):gsc(b,a.C,a.F,a.Z);AW(this,b,a.L);this.Kb.fc(2762,this.pb)};function Ksc(a,b){Q(a.bd,b);Q(a.Ba().$a("waffle-assistant-answers-button-container",a.Z),!b);a.Xa&&a.Xa.setActive(b)}function Ysc(a,b){b.jf(a.Fd());a.C.push(b);a.Ye&&(a.O.$h(b,0,!0),b.UK());Ypc(b,!0)}function Zsc(a){for(var b=a.C;5<b.length;)a.fI(b[0])}p.c_=function(){zW.$.c_.call(this);this.reset()};
p.YNa=function(a){var b=this,c=this.Ba();a=a.target;if(a instanceof tW)this.fI(a),uW(this.Ib,"Answer removed",c,u(this.DBb,this,a));else if(a instanceof vW)this.fI(a),uW(this.Ib,"Card removed",c);else if(a instanceof wW&&a.C&&!Krc(a.C)){var d=a.C.C;x(this.C,function(a){a instanceof vW&&a.aP().C==d&&(b.fI(a),uW(b.Ib,"Card removed",c))})}a=this.C;!this.V||a[0]!=this.V&&a[a.length-1]!=this.V||(this.fI(this.V),this.V=null)};
p.DBb=function(a){Usc(this,a.aP(),a.Fma());uW(this.Ib,"Remove answer undone",this.Ba())};p.fI=function(a){if(a.mc()){if(a instanceof tW||a instanceof vW)delete this.Ca[a.aP().C],a==qb(this.C)&&$sc(this);zW.$.fI.call(this,a)}G(a)};function ctc(){var a=""+(V('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
U(zt({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+rr("Ask a question about your data")+'" /></div></form></div>');return V(a)};function dtc(a,b){this.C=a;this.D=b}function trc(a,b,c,d){b="="!=b[0]?"="+b:b;var e=Ssc(a);c=Tsc(e,c);(a=epc(a.C,b,e,c.row,c.zj))&&d&&a.length<a[0].length&&(a=Rqc(a));return a}function urc(a){if(a)for(var b=1<a.length?1:0;b<a.length;b++){for(var c=!1,d=a[b],e=0;e<d.length;e++)if(!d[e]){c=!0;break}if(!c)return!0}return!1}function Ssc(a){a=Ou(a.D);return null!=a?a.toString():"0"}
function Tsc(a,b){var c={row:0,zj:0};ritz_api.RitzModelApi.getActiveFilterId(a)&&b&&(b=b.rect,ritz_api.RitzModelApi.getNumberOfRows(a)>b.Lc()+1?c.row=b.Lc()+1:ritz_api.RitzModelApi.getNumberOfColumns(a)>b.Sc()+1&&(c.zj=b.Sc()+1));return c};function BW(a,b,c,d,e,f,h,k,l,m){$V.call(this,1,f,e,m);this.pb=c;this.Ca=null;this.qa=new es("",new TV,this.Ba());this.Wa(this.qa);this.Ia=new es("",new TV,this.Ba());this.Wa(this.Ia);a=new eyb(a,!0,!0);a=new dtc(a,c);this.gb=new csc(e);this.O=new prc(a,e);this.L=new zW(this.O,0,b,c,d,e,this.bb,a,this.gb,h,k,l,m);c=etc;this.D=new vrc(b,c.t1a,c.u1a);F(this,this.D);this.F=this.H=null;this.ib=oi(new ni,10).build()}w(BW,$V);
var etc={t1a:"waffle-assistant-answers-styled-border",u1a:"waffle-assistant-answers-styled-rect",F1a:"waffle-assistant-answers-input-box",a3a:"waffle-assistant-answers-query-box",Htc:"waffle-assistant-answers-query-box-focused",V1a:"waffle-assistant-answers-learn-more",Aoc:"waffle-assistant-answers-logging-message-container",G2a:"waffle-assistant-answers-logging-opt-out"};p=BW.prototype;p.Ga=function(){BW.$.Ga.call(this);var a=S(ctc);this.Ba().appendChild(gqc(this),a)};
p.Sa=function(){BW.$.Sa.call(this);var a=etc,b=this.$a(a.a3a),c=this.$a(a.F1a);this.Ia.mb(this.$a(a.G2a));this.qa.mb(this.$a(a.V1a));this.getHandler().R(b,"focus",this.SAb,!0).R(b,"blur",this.QAb,!0).R(b,"mouseover",this.UAb).R(b,"mouseout",this.TAb).R(b,"click",this.RAb).R(c,"input",this.m1b).R(this.Ia,"action",this.ozb).R(this.qa,"action",this.Wvb).R(Su(this.pb),"Da",jjc(this.n1b,25,this));this.setVisible(null!=this.H);ftc(this,Era&&Hra&&$m("showAnswersLoggingOptOut"))};p.nWa=Qf;p.OOa=Rf;
p.Kua=Qf;p.Z4=n("Answers");p.Mwa=n(1);p.zja=function(a){return 3==a||0==a};p.Lwa=function(a,b){Tb(a,function(a,b){return B(b,2)-B(a,2)});for(var c=[],d=null,e=0;e<a.length;e++){var f=Ec(a[e],1);3==f?d=a[e]:0==f&&c.push(B(a[e],8))}d&&B(d,2)?(e=b||null,f=0==B(d,11)?pS(B(d,10)):null,0<zc(d,4)?gtc(this,pS(B(d,4,0)),B(d,9),f,c):gtc(this,e,B(d,9),f,c),this.F||(BW.$.Lwa.call(this,a,b),this.getHandler().R(this.F,"sqc",this.HEb))):this.xW(!0)};
p.v8=function(a){if(!this.F){var b=jrc(this.O,3);this.F=new wW(a,this.gb,b,usc,void 0,this.Ba())}return this.F};p.HEa=g("L");p.Upa=function(){return this.kb()};
p.xW=function(a,b,c){this.O.reset();(a||b)&&this.F&&(BW.$.xW.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||t(b)&&!b)this.F&&(BW.$.xW.call(this,a,b,c),this.F.dispose(),this.F=null),this.mc()&&(this.O.reset(),this.H=null,a=this.L,a.mc()&&(b=a.bb,b.F=[],b.C.clear(),a.D&&Frc(a.D),a.c_(),a.Kc.reset(),a.F=null,a.tI(!0),a.L&&!a.L.isDisposed()&&a.L.setVisible(!1),a.Qb=!1),this.setVisible(!1),this.$b()&&oW(this.D));c&&this.L.reset()};p.qh=function(a){this.Ca=a;this.L.qh(a);this.O.qh(a)};
p.setActive=function(a){BW.$.setActive.call(this,a);a?nW(this.D,this.H):oW(this.D)};function htc(a,b){a.$b()&&(b?oW(a.D):nW(a.D,a.H))}function ftc(a,b){Q(a.$a("waffle-assistant-answers-logging-message-container"),b)}function itc(a,b){a=a.$a("waffle-assistant-answers-query-box");ep(a,"waffle-assistant-answers-query-box-focused",b)}p.n1b=function(){this.$b()&&nW(this.D,this.H)};p.SAb=function(){itc(this,!0);nW(this.D,this.H)};p.QAb=function(){itc(this,!1);this.$b()||oW(this.D)};
p.UAb=function(){nW(this.D,this.H)};p.TAb=function(){this.$b()||oW(this.D)};p.RAb=function(){jtc(this,"")};p.m1b=function(){var a=this.$a("waffle-assistant-answers-input-box");jtc(this,a.value);a.value=""};p.HEb=function(a){var b=this;jtc(this,a.J);var c=fsc(1,a.C,a.F,1),d=new Ek(function(){AW(b.L,c,a.L)},300);F(this,d);d.start();this.xu().fc(2652,this.ib)};
function jtc(a,b,c){a.setActive(!0);a.dispatchEvent("re");var d=new Ek(function(){var d=a.L;Frc(d.D,b);d.D.focus();a.L.Ue=c||!1},300);F(a,d);d.start()}function gtc(a,b,c,d,e){c=c||new HU;a.H=b;a.O.Re(c,b,e);a.O.Ica();a.setVisible(null!=b);Gsc(a.L,b,c,d,e);a.$b()&&nW(a.D,a.H)}p.ozb=function(a){a.stopPropagation();a.preventDefault();this.Ca&&(Bk(Pj(Qj(this.Ca.Tf("/answers/logoptout"),u(this.Kwb,this)),u(this.Jwb,this)),"POST").$e(),this.xu().fc(2663,this.ib))};
p.Wvb=function(a){a.stopPropagation();a.preventDefault();Io("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};p.Kwb=function(a){a.ul()&&ftc(this,!1)};p.Jwb=ca();function ktc(){var a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+ltc()+"</div>");return V(a)}
function mtc(){return V('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+ltc()+"</div>")}function ltc(){var a=""+U(ls({Ce:"waffle-assistant-formatting-edit-button",content:nr("Edit"),style:4}));return V(a)};function ntc(a,b,c){XV.call(this,a,c);a=ub(Dc(this.D,7),Bjc);this.C=new AT(!1,a,7);this.Wa(this.C);this.J=new ms("",this.Ba());this.Wa(this.J);this.Kb=b;this.H=!1;this.F=-1}w(ntc,XV);var otc={dga:"waffle-assistant-banding-color-picker-container",oga:"waffle-assistant-formatting-edit-button",OJ:"waffle-assistant-banding-range"};p=ntc.prototype;p.Ga=function(){ntc.$.Ga.call(this);YV(this).appendChild(S(ktc))};
p.Sa=function(){ntc.$.Sa.call(this);this.getHandler().R(this.J,"action",this.Vrb).R(this.C,"banding-scheme-changed",this.Wmb);this.Kb.C(2768)};p.WI=function(a){var b=this.$a(otc.dga);this.C.render(b);Hjc(this.C);var b=this.$a(otc.OJ),c=B(this.D,4,0),d=zh(c);Zl(b,mv(d));ptc(this,c);b=this.$a(otc.oga);this.J.mb(b);a()};p.MI=function(){Yo(this.Ka,"Suggested alternating background colors");Gq(this.C,"Choose a color scheme")};p.sG=n("assistantBandingFeedback");p.lM=n(2672);p.kM=n(2671);
p.Vrb=function(a){xn.dispatchEvent({type:"show-banding-pane-recommendation",nUa:this.D,T8a:Ijc(this.C)});a.stopPropagation()};p.Wmb=function(a){if(!this.H&&BT(this.C)){var b=this.F;this.F=this.C.Kh();this.F==b?this.dispatchEvent(new SV("qe",this,2797)):this.dispatchEvent(new SV("ke",this,2673));a.stopPropagation()}};
function ptc(a,b){a.H=!0;var c=b.Jb();b=zh(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.qc(),b.jc(),b.Lc(),b.Sc(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=(new th).cd(xd.Qa(),c),c=Bjc(c)):c=null;c?(c=Jjc(a.C,c),hI(a.C,c?c.getElement():null)):hI(a.C,null);a.F=a.C.Kh();a.H=!1};function qtc(a,b){XV.call(this,a,b);this.C=new ms("",this.Ba());this.Wa(this.C);this.pb=Dc(a,6)}w(qtc,XV);var CW={oga:"waffle-assistant-formatting-edit-button",e1a:"waffle-assistant-conditionalformat-format-preview",x3a:"waffle-assistant-conditionalformat-rule-holder",G5:"waffle-assistant-conditionalformat-description",D2a:"one-rule",C4a:"two-rules",p4a:"three-rules",V2a:"waffle-assistant-conditionalformat-format-preview-label"};p=qtc.prototype;p.Ga=function(){qtc.$.Ga.call(this);YV(this).appendChild(S(mtc))};
p.Sa=function(){qtc.$.Sa.call(this);var a=this.$a(CW.oga);this.C.mb(a);VV(a,"Apply and edit conditional format rules");this.getHandler().R(this.C,"action",this.rmb)};p.WI=function(a){Zl(this.$a(CW.G5),Ec(this.D,3));var b=this.$a(CW.x3a),c=new rtc(this,this.Ba());this.Wa(c);c.mb(b);VV(b,"Apply conditional format rules");a()};p.MI=va;p.sG=n("assistantConditionalFormatFeedback");p.lM=n(2630);p.kM=n(2629);
p.rmb=function(){this.dispatchEvent(new SV("le",this,2563));this.dispatchEvent(new SV("ne",this,2670,void 0,void 0,zh(B(this.pb[0],1,0))));Bn()};function rtc(a,b){Dq.call(this,void 0,void 0,b);this.C=a}w(rtc,Dq);
rtc.prototype.Jd=function(a){rtc.$.Jd.call(this,a);var b=this.C.pb;switch(b.length){case 0:break;case 1:var c=CW.D2a;break;case 2:case 4:c=CW.C4a;break;default:c=CW.p4a}for(var d=0;d<b.length;d++){var e=b[d],f=Hl("DIV");bp(f,[CW.e1a,c]);var h=Hl("DIV");ap(h,CW.V2a);f.appendChild(h);Zl(h,"123");if(yc(e,2)){var k=B(B(e,2),1);switch(B(B(k,1),1)){case 9:case 13:var k=Dc(B(k,1),2)[0],l=Dc(e,1)[0];Zl(h,kz(k,Ec(l,1),Ec(l,2),Ec(l,4)))}}Nic(e,f);a.appendChild(f)}};
rtc.prototype.Di=function(){var a=this.C;a.dispatchEvent(new SV("le",a,2563));return!0};function stc(a,b,c){$V.call(this,2,b,a,c)}w(stc,$V);p=stc.prototype;p.Z4=n("Formatting");p.zja=function(a){return 2==a||4==a};p.v8=function(a){var b=B(a,1);switch(b){case 2:return new qtc(a,this.Ba());case 4:return a=new ntc(a,this.xu(),this.Ba()),this.getHandler().R(a,"ke",this.TUb).R(a,"qe",this.AHb),a;default:throw Error("Unsupported recommendation type: "+b);}};p.TUb=function(a){uW(this.bb,"Alternating colors applied",this.Ba(),u(this.Xmb,this,a.C))};p.AHb=function(){this.bb.clear()};
p.Xmb=function(a){this.dispatchEvent(new SV("ve",a,2796))};p.jf=function(a){stc.$.jf.call(this,a);this.setVisible(!a)};p.Nwa=function(a){return this.Fd()?(this.setVisible(!1),a):stc.$.Nwa.call(this,a)};p.Mwa=n(3);function DW(a,b,c,d,e){R.call(this);this.J=a;this.Oa=b;this.Z=c;this.D=d;this.H=e}la(DW,R);DW.prototype.getTableRange=g("Z");DW.prototype.kea=function(a,b){this.Z=a;this.D=b};DW.prototype.Sa=function(){R.prototype.Sa.call(this);this.getHandler().R(this.J.C,"M",this.Pa)};DW.prototype.Pa=function(){this.Oa.Cc()};function ttc(a,b,c){var d=a.Lc(),e=a.Sc();switch(b){case 0:d=Math.min(d,a.qc()+c);break;case 1:e=Math.min(e,a.jc()+c)}return uh(a.Jb(),a.qc(),a.jc(),d,e)};function utc(a,b){E.call(this);this.F=a;this.H=b;this.C=new vrc(a,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");F(this,this.C);this.D=new vrc(a,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");F(this,this.D)}la(utc,E);utc.prototype.Ja=function(){oW(this.C);oW(this.D);E.prototype.Ja.call(this)};
function vtc(a,b,c,d,e,f){uxb(b);var h=zh(d),h=new bh(h.qc(),h.jc(),Math.min(h.Lc(),h.qc()+6),Math.min(h.Sc(),h.jc()+3)),k=o4a(b),l=iB(a.F).Td(),m=l.Df(new Rg(h.qc(),h.Lc()),"r",!0,!1,!0,!0)-1,l=l.Df(new Rg(h.jc(),h.Sc()),"c",!0,!1,!0,!0)-1,m=Math.min(200,m),l=Math.min(c.offsetWidth-2,l);vxb(b,k,l,m);c=ttc(d,e,f);a.H.render(b,h,c);b=a.C;h=d.qc();k=d.jc();switch(e){case 0:h=Math.min(d.Lc(),d.qc()+f);break;case 1:k=Math.min(d.Sc(),d.jc()+f)}d=uh(d.Jb(),h,k,d.Lc(),d.Sc());nW(b,pS(d));nW(a.D,pS(c))};function wtc(a){var b=a.ETa,c=a.aSa,d=a.EDa;return V('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">'+U(a.FTa)+'</div></div><div class="waffle-tables-popup-content">'+U(b)+'<div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"></canvas></div></div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">'+U(c)+
'</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">'+U(d)+"</div></div></div></div>")}
function xtc(){var a=nr("Edit data range");var b=""+('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper">Data Range'+U(zjc({Fba:!0}))+'</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper">Headers<div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div>');b=V(b);a=""+wtc({FTa:a,ETa:or(""+b),aSa:nr("Update"),EDa:nr("Cancel")});
return V(a)}function ytc(){var a=""+wtc({FTa:nr("Improve suggestions"),ETa:or('<div class="waffle-tables-popup-header-message"></div>'),aSa:nr("No"),EDa:nr("Yes")});return V(a)}function ztc(a){a='For <span class="waffle-assistant-table-bar-range">'+(U(a.jW)+"</span>");return V(""+a)}function Atc(a){a='Is <span class="waffle-assistant-table-first-header">'+(U(a.xHb)+"</span> a header row, containing titles that describe the columns below?");return V(""+a)};function EW(a,b,c,d,e,f){DW.call(this,a,X.OY,d,e,f);this.C=(new eL).build();F(this,this.C);this.L=new es("",new UV,this.Ba());this.Wa(this.L);Mt(this.C,this.L,X.m7);this.F=new es("",new UV,this.Ba());this.Wa(this.F);Mt(this.C,this.F,X.OY);this.V=new utc(b,c);F(this,this.V);this.O=new Eo(this);F(this,this.O)}la(EW,DW);EW.prototype.Ga=function(){this.Ka=S(ytc)};
EW.prototype.Sa=function(){DW.prototype.Sa.call(this);this.L.mb(this.$a("waffle-tables-popup-done"));this.F.mb(this.$a("waffle-tables-popup-cancel"));var a=ttc(this.getTableRange(),this.H,1),a=mv(zh(a)),a=S(Atc,{xHb:a});this.$a("waffle-tables-popup-header-message").appendChild(a);this.O.subscribe(X.m7,"action",this.Ca).subscribe(X.OY,"action",this.qa);var a=this.$a("waffle-assistant-table-canvas"),b=this.$a("waffle-assistant-canvas-container");vtc(this.V,a,b,this.getTableRange(),this.H,this.D)};
EW.prototype.qa=function(){this.dispatchEvent("te")};EW.prototype.Ca=function(){var a=zh(this.getTableRange());switch(this.H){case 0:a=Xga(a.top+1,a.left,a.top+a.height,a.left+a.width);break;case 1:a=Xga(a.top,a.left+1,a.top+a.height,a.left+a.width)}a=mv(a);this.dispatchEvent(new Opc(a,this.D-1,this.H));this.dispatchEvent("te")};function Btc(a,b,c,d,e,f,h){DW.call(this,a,X.CQ,d,e,f);this.Xa=b;this.Ia=d;this.bb=e;a=zh(d);this.F=mv(a);this.Ca=new utc(b,c);F(this,this.Ca);this.C=null;this.Kb=h;this.L=(new eL).build();F(this,this.L);this.V=new es("",new UV,this.Ba());this.Wa(this.V);Mt(this.L,this.V,X.NY);this.O=new es("",new UV,this.Ba());this.Wa(this.O);Mt(this.L,this.O,X.CQ);this.qa=new Eo(this);F(this,this.qa)}la(Btc,DW);p=Btc.prototype;p.Ga=function(){this.Ka=S(xtc)};
p.Sa=function(){DW.prototype.Sa.call(this);this.V.mb(this.$a("waffle-tables-popup-done"));this.O.mb(this.$a("waffle-tables-popup-cancel"));var a=this.$a("waffle-range-selection-input");a.focus();this.getHandler().R(this.Ka,"keydown",this.NKb).R(a,"keyup",this.OKb).R(a,Xba,this.cFb).R(this.Xa,"selectionChange",this.PKb);this.qa.subscribe(X.NY,"action",this.QKb).subscribe(X.CQ,"action",this.tnb);dD(this.J,"selection-input");Ctc(this)};p.Ja=function(){dD(this.J,"normal");DW.prototype.Ja.call(this)};
function Dtc(a){var b=a.$a("waffle-assistant-table-canvas"),c=a.$a("waffle-assistant-canvas-container");vtc(a.Ca,b,c,a.getTableRange(),a.H,a.D)}p.tnb=function(){this.dispatchEvent("te")};p.QKb=function(){var a=this.bb!=this.D,b=!hjc(this.Ia,this.getTableRange());if(a||b)a&&this.Kb.fc(35506),b&&this.Kb.fc(35507),this.dispatchEvent(new Opc(this.F,this.D,this.H));this.dispatchEvent("te")};function Ctc(a){var b=a.$a("waffle-range-selection-input"),c=zh(a.Ia);a.F=mv(c);b.value=a.F;Etc(a);Dtc(a)}
p.kea=function(a,b){DW.prototype.kea.call(this,a,b);Dtc(this)};function Ftc(a){var b=Uu(a.J.C),c=b.wc(),b=mIa(a.F,b);null!=b&&(c=xh(b,c),a.kea(c,Gtc(a,c)),Etc(a))}function Gtc(a,b){b=Htc(b);return a.D>b?b:a.D}function Htc(a){var b=Ec(a,2);a=a.Lc();return Math.min(a-b-1,3)}
function Etc(a){G(a.C);a.C=new rH;a.Wa(a.C);Mt(a.L,a.C,X.Rha);yS(a.C,DT.getInstance());a.C.render(a.$a("waffle-assistant-tables-edit-headers-button"));a.getHandler().R(a.C,"action",a.iub);for(var b=Htc(a.getTableRange()),c=0;c<=b;c++){var d=(new Jn("{NUM_ROWS, plural,=0 {none}=1 {1 row}other {# rows}}")).format({NUM_ROWS:c});a.C.re(new Pq(d))}a.C.Yf(a.D)}p.cFb=function(){var a=this.$a("waffle-range-selection-input");this.F!==a.value&&(this.F=a.value,Ftc(this))};
p.PKb=function(a){var b=a.rect;!b||a.V||ih(b)||(this.F=a=mv(b),b=this.$a("waffle-range-selection-input"),b.value=a,b.select(),Ftc(this))};p.NKb=function(a){var b=this.$a("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.F=b.value;Ftc(this);X.NY.Cc();break;case 27:a.stopPropagation(),a.preventDefault(),Ctc(this),X.CQ.Cc()}};p.OKb=function(){this.F=this.$a("waffle-range-selection-input").value;Ftc(this)};
p.iub=function(){var a=this.C.Kh();this.kea(this.getTableRange(),a)};function FW(a,b,c,d){Et.call(this,a,b,c,d,void 0,void 0,!0)}w(FW,Et);FW.prototype.Ga=function(){FW.$.Ga.call(this);ap(this.Ka,"waffle-assistant-toast");ap(this.$a("docs-ui-toast-content"),"waffle-assistant-toast-content")};FW.prototype.qF=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=Wp(this,b);FW.$.qF.call(this,a,b,c)};FW.prototype.Zh=function(a,b,c,d){this.qF(a,b,d);a=Yp(this,b);Of(this.getHandler(),a,fd,u(function(){this.setVisible(!1);c()},this))};function Itc(){this.C=null}w(Itc,E);Itc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function uW(a,b,c,d){a.clear();a.C=new FW(b,c,!1,5E3);a.C.render();d&&a.C.Zh("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}Itc.prototype.Ja=function(){Itc.$.Ja.call(this);this.clear()};function Jtc(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+W(a.title)+'">'+U(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+rr("Press enter to insert formula")+'"></span></div>');return V(a)};function GW(a,b){R.call(this);this.C=a;this.D=b}w(GW,R);p=GW.prototype;p.Ga=function(){this.Ka=S(Jtc,{name:this.C,title:this.D})};p.Sa=function(){GW.$.Sa.call(this);var a=this.$a("waffle-assistant-quicksum-entry-name");VV(a);this.getHandler().R(this.Ka,"keypress",this.W0b);Q(this.Ka,!1)};p.getFunctionName=g("C");p.fb=function(a){Zl(this.$a("waffle-assistant-quicksum-entry-value"),a||"");Q(this.Ka,!!a)};p.kb=function(){return Dp(this.Ka)};
p.W0b=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new H("insert",this)))};function HW(a,b,c,d,e){R.call(this,e);this.Oa=a;this.Ca=b;this.L=c;this.Kb=d;this.D=a.C;this.Ia=new th;this.V=oi(new ni,17).build();this.O=oi(new ni,2).build();this.J=!1;this.F=[];this.C=null;this.H=[]}w(HW,R);
HW.prototype.Sa=function(){HW.$.Sa.call(this);this.$h(new GW(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.$h(new GW(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.$h(new GW(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.$h(new GW(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.$h(new GW(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new sW(this.Ka,
this.Ca,this.D,this.L);this.C.jf(this.J);F(this,this.C);this.getHandler().R(this,"insert",this.Z).R(this.C,"formula_inserted",this.qa)};
function Ktc(a){function b(a){return l?ritz_api.RitzModelApi.renderNumberAsFormattedString(a,m):null}if(Tu(a.D)){var c=Uu(a.D),d=c.ek(),e=RC(a.D);if(xb(d,c.Qt,c)){c=[];a.F=[];for(var f=0;f<d.length;f++){var h=d[f],k=uh(e+"",h.qc(),h.jc(),h.Lc(),h.Sc());c.push(a.Ia.serialize(k));a.F.push(h)}if(d=ritz_api.RitzModelApi.quickSum(c)){Q(a.Ka,!0);var e=d.count,c=d.countNumberFormat,l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.qd(0).fb(b(d.sum));a.qd(1).fb(b(d.average));a.qd(2).fb(b(d.min));a.qd(3).fb(b(d.max));
1<e?a.qd(4).fb(ritz_api.RitzModelApi.renderNumberAsFormattedString(e,c)):Q(a.Ka,!1);if(a.C){a.C.J=[];a.H=[];for(d=0;d<a.kd();++d)e=a.qd(d),a.H.push(Ltc(a,e.getFunctionName()));a.C.J=a.H}}else Q(a.Ka,!1)}else Q(a.Ka,!1)}else Q(a.Ka,!1)}HW.prototype.jf=function(a){this.J=a;this.C&&this.C.jf(a);ep(this.Ka,"waffle-assistant-quicksum-panel-readonly",a)};
HW.prototype.Z=function(a){var b=a.target;a=this.F[0];a=new Ng(a.left,a.Lc());b=b.getFunctionName();b=Ltc(this,b);a=new $F(Uu(this.D),a,b);this.L.C(a);this.Kb.fc(2624,this.O)};HW.prototype.qa=function(){this.Kb.fc(2624,this.V)};function Ltc(a,b){var c=tv(a.Oa.L);a=ub(a.F,function(a){return mv(a)});return"="+b+"("+a.join(c)+")"};function Mtc(a){a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+U(ls({content:nr("INSERT CHART"),style:4,Ce:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"}))+U(ls({Ce:"waffle-autovis-lightbox-close",content:or(""+U(zt({icon:"docs-icon-img docs-icon-close-white"}))),style:4,title:nr("Close")}))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">'+
U(ls({content:or("&#10094;"),style:4,Ce:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:pr('aria-label="'+rr("Previous chart")+'"')}))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+U(ls({content:or("&#10095;"),style:4,Ce:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:pr('aria-label="'+rr("Next chart")+'"')}))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
U(a.ZLb)+"</div></div></div>");return V(a)}function Ntc(){return V('<div class="waffle-autovis-lightbox-chart"></div>')};function IW(a,b,c,d){R.call(this,d);this.F=a;this.D=b;this.Kb=c;this.H=[];this.C=new ms("",this.Ba());this.Wa(this.C);this.O=new ms("",this.Ba());this.Wa(this.O);this.L=new ms("",this.Ba());this.Wa(this.L);this.J=new ms("",this.Ba());this.Wa(this.J)}w(IW,R);p=IW.prototype;p.Ga=function(){IW.$.Ga.call(this);this.Ka=S(Mtc,{ZLb:this.F.length})};
p.Sa=function(){IW.$.Sa.call(this);var a=X.gP.isEnabled();this.jf(!a);a=this.$a("waffle-autovis-lightbox-close");this.C.mb(a);a=this.$a("waffle-autovis-lightbox-insert");this.O.mb(a);var b=this.$a("waffle-autovis-lightbox-previous");this.L.mb(b);b=this.$a("waffle-autovis-lightbox-next");this.J.mb(b);Otc(this);Ptc(this,this.D,!1);this.getHandler().R(document.body,Wba,this.RXb).R(this.Ka,"keydown",this.SXb).R(Gl(),"resize",this.VXb).R(this.C,"action",this.close).R(this.O,"action",this.ovb).R(this.L,
"action",this.UXb).R(this.J,"action",this.TXb);b=new kG(this.Ka,this.Ba());lG(b);F(this,b);a.focus()};function Otc(a){var b=a.$a("waffle-autovis-lightbox-content"),c=a.$a("waffle-autovis-lightbox-content-inner");a=a.$a("waffle-autovis-lightbox-page-count");var d=El();a=Ap(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;xp(c,d,e);xp(b,d,e+a.height+35)}p.jf=function(a){ep(this.Ka,"waffle-autovis-lightbox-readonly",a)};
function Ptc(a,b,c){c&&zn("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?Qtc(a,b):a.F[b]&&zqc(a.F[b],u(a.lob,a,b),!0)}p.lob=function(a,b){if(!this.isDisposed()&&b){var c=this.$a("waffle-autovis-lightbox-container"),d=S(Ntc);c.appendChild(d);this.H[a]=d;CU(b,d,this.Kb,Vm);Qtc(this,a)}};function Qtc(a,b){Q(a.H[a.D],!1);Q(a.H[b],!0);a.L.eb(0!=b);a.J.eb(b!=a.F.length-1);var c=a.$a("waffle-autovis-lightbox-page-number");Zl(c,b+1);a.D=b}p.RXb=function(a){!Xl(this.Ka,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
p.SXb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&Ptc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||Rtc(this);a.stopPropagation()};p.VXb=function(){var a=this.$a("waffle-autovis-lightbox-container");Ml(a);this.H=[];Otc(this);Ptc(this,this.D,!0)};p.ovb=function(){this.close();Cqc(this.F[this.D],2256)};p.UXb=function(){0!=this.D&&Ptc(this,this.D-1,!0);0==this.D&&this.J.Ka.focus()};p.TXb=function(){Rtc(this);this.D==this.F.length-1&&this.L.Ka.focus()};
function Rtc(a){a.D!=a.F.length-1&&Ptc(a,a.D+1,!0)}p.close=function(){this.dispose()};p.od=function(){IW.$.od.call(this);var a=this.F[this.D];a&&a.Ka&&a.Ka.focus()};function Stc(a,b,c){I.call(this);this.Xb=a;this.Qb=b;this.Ab=c;this.J=a.C;this.De=new th;this.bb=ck();this.L=new Vj;this.Tb=this.C=this.F=this.V=this.O=this.Oa=this.qa=null;this.Mb=!1;this.D=null;this.gc=!0;this.gb=this.zb=!1;this.Ib=this.ib=null;this.Z=Ji.getInstance();this.Xa=this.Pa="";this.Ca=this.Ia=null;b=this.Xb.L.Ts();this.H=new LU;C(this.H,15,!0);C(this.H,2,lra);a=Ora&&!a.Fd();C(this.H,3,a);C(this.H,4,!0);a=Sm&&($ra||"en"==GC(b));C(this.H,5,a);C(this.H,6,Kra);C(this.H,7,!0);C(this.H,10,!1);
C(this.H,11,Zra);C(this.H,12,asa);C(this.H,14,Zm);this.pb=-1!=window.location.href.indexOf("eeos=false");a=new J(this);F(this,a);a.R(this.Qb,"C",this.y1b)}w(Stc,I);var Ttc={i7b:"cu",f_a:"cs",e_a:"ce",d2a:"ls",b2a:"le"};function Utc(a){a.gb=!0;a.L.cancel(!0);a.Oa=null;a.O=null;a.V=null;a.F=null;a.qa&&(a.qa.cancel(!0),a.qa=null)}p=Stc.prototype;
p.update=function(a,b,c){c&&this.C&&!yb(c,function(a){return kha(a,this.C.rect)},this)||!a&&this.C&&c&&1==c.length&&1==c[0].Hh()&&this.C.rect.contains(c[0])||(this.bb.cancel(!0),a&&Utc(this),this.bb=Vtc(),this.bb.addCallback(this.$6a,this),this.bb.addCallback(Ha(this.a7a,b),this))};p.qh=da("ib");p.y1b=function(){this.qa&&3==this.Qb.getState()&&(this.qa.Yb(),this.qa=null)};function Vtc(){var a=null,b=new Vj(function(){null===a||Fi(a)}),a=Ei(function(){b.Yb()});return b}
function Wtc(a,b,c,d,e){b&&(a.Xa=Ki(a.Z,uj.Fya,!1,Xtc(a)));a.Ia=d;a.Ca=e;a.L.cancel(!0);a.L=new Vj;Ytc(a);a.L.addCallback(a.y9a,a);b&&(a.L.addCallback(Ha(a.u9a,c),a),a.pb||null==a.ib||lw(a.Xb)?(a.L.addCallback(a.f7a,a),a.L.addCallback(a.g7a,a)):a.L.addCallback(a.Lib,a),a.L.addCallback(a.t9a,a));Yj(a.L,a.x1b,a)}p.x1b=function(a){this.zb=!0;a instanceof Wj||this.Ab.qq(Error("Assistant cancelled"),{cause:a})};
p.$6a=function(){var a=this.J.getActiveGrid();if(a){var b=Uu(this.J),c=b.ek(),d=Ztc(this,c||[]),e=Ztc(this,this.Tb||[]);d&&!e||!d&&!$tc(c,this.Tb)?(this.F=null,this.Mb=!0):this.Mb=!1;this.Tb=c;var f=RA(b).clone();x(b.ek(),function(a){f.Nn(a)});this.D=new qh(a.Jb(),"",f)}else this.D=null};
p.a7a=function(a){this.Pa=Ki(this.Z,uj.Eya,!1,Xtc(this));var b=this.J.getActiveGrid(),c=this.D&&this.D.Yc;this.C&&this.C.Yc!=c&&(this.C=null);if(!b||b.Jb()!=c||null===c)return this.D=null;var d=this.J.getActiveGrid().D,b=ez(d,this.D.rect);b.addCallback(function(){if(!this.J.getActiveGrid()||Ou(this.J)!=c)return null;var b=Uu(this.J),f=auc(this,a),h=bz(b.D,"r"),k=b.Wn("r");return!b.Qt(f)||h>=f.qc()&&eQa(b)||k<=f.Lc()&&dQa(b)?(this.dispatchEvent(new H("ls")),fz(d,f,fc(Ig),a?void 0:500).addCallback(this.B9a,
this)):f},this);b.addCallback(function(a){var b=this.J.getActiveGrid();return a&&b&&b.Jb()==c&&null!==c?buc(this,a,Uu(this.J)):null},this);b.addCallback(function(b){var d=this.C;b&&3<b.Hh()&&(d=b&&new qh(c,"",b));if(null===d&&null!==this.C||null!==d&&!d.equals(this.C))this.F=this.V=this.O=this.Oa=null;b=null!==d&&d.equals(this.C);if(b=this.gb||this.Mb||!b&&(null===this.O||null!==this.V&&null===this.F))this.gc=this.zb&&this.gc||!this.C||!d||!d.rect.intersects(this.C.rect);var e=null!==d&&d.contains(this.C);
this.C=d;""!=this.Pa&&(Li(this.Z,this.Pa),this.Pa="");b&&Wtc(this,a,e,this.Ia,this.Ca)},this);return b};function auc(a,b){return null!=a.D?ritz_api.AssistantApi.getExploreTableRectForSelection(""+a.D.Yc,a.D.rect.top,a.D.rect.height+a.D.rect.top,a.D.rect.left,a.D.rect.width+a.D.rect.left,b,Tra,bh):null}
function Ytc(a){if(null===a.C||null===a.C.rect||null!==a.Oa)a.L.Yb();else{var b=Ki(a.Z,uj.uxa,!1,Xtc(a)),c=a.L;ritz_api.AssistantApi.getAssistantConfidence(""+a.C.Yc,a.C.rect.top,a.C.rect.height+a.C.rect.top,a.C.rect.left,a.C.rect.width+a.C.rect.left,a.De.serialize(a.H),function(d){Li(a.Z,b);a.Oa=d+0;c.C||c.Yb()})}}p.B9a=function(){this.dispatchEvent(new H("le"))};p.y9a=function(){this.dispatchEvent(new cuc(this.C,this.Oa))};p.u9a=function(a){a=new duc(a,this.gb);this.gb=!1;this.dispatchEvent(a)};
p.Lib=function(){if(null===this.C||null===this.C.rect||null!==this.V&&null!==this.F)return null;G(this.Ib);return 3!=this.Qb.getState()?(this.qa=new Vj,this.qa.addCallback(this.lVa,this),this.qa):this.lVa()};
p.lVa=function(){var a=Ki(this.Z,uj.Hya,!1,Xtc(this)),b=euc(this),c=b&&!b.pQa,d=this.Ia||xh(this.C.rect,this.C.Yc),b=ritz_api.AssistantApi.getAssistantRequestProto(Aha.serialize(d),c?b.rows:[],c?b.He:[],this.Ca?Aha.serialize(this.Ca):null);this.Ca=this.Ia=null;b=this.De.cd(JU.Qa(),b);c=new th;c.tv=!0;var b=Hi(c.serialize(b)),e=new Vj;this.Ib=Pj(Qj(Nj(Ak(Bk(this.ib.Tf("/explore/getrecommendations").Zf("rp",b),"GET")).setTimeout(6E4),1),function(b){var c=Ki(this.Z,uj.Gya,!1,Xtc(this));b=fuc(this,b.vg());
Li(this.Z,c);this.V=Dc(b,1);this.F=Dc(b,2);this.Ib=null;Li(this.Z,a);e.Yb()},this),function(){this.V=[];this.F=[];e.Yb()},this).$e();return e};
p.f7a=function(){function a(){d=null;ritz_api.AssistantApi.continueAssistantRecommendation(this.O)?(this.V=Dc(fuc(this,ritz_api.AssistantApi.getAssistantRecommendations(this.O)),1),e.Yb()):d=Ei(a,5,this)}if(null===this.C||null===this.C.rect||null!==this.O&&null!==this.V)return null;this.O=ritz_api.AssistantApi.newAssistantRecommender(this.De.serialize(this.H));this.F=this.V=null;if(this.Ia&&this.Ca){var b=pS(this.Ia),c=pS(this.Ca);ritz_api.AssistantApi.startAssistantRecommendationWithHeader(this.O,
""+b.Yc,b.rect.top,b.rect.height+b.rect.top,b.rect.left,b.rect.width+b.rect.left,c.rect.top,c.rect.height+c.rect.top,c.rect.left,c.rect.width+c.rect.left)}else ritz_api.AssistantApi.startAssistantRecommendation(this.O,""+this.C.Yc,this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left);var d=null,b=u(function(){null!==d&&(Fi(d),this.F=this.V=this.O=d=null)},this),e=new Vj(b),d=Ei(a,5,this);return e};
p.g7a=function(){var a=euc(this);a&&this.O&&null===this.F&&(this.F=a.pQa?[]:Dc(fuc(this,ritz_api.AssistantApi.getAssistantRecommendationsOnlySelection(this.O,a.rows,a.He)),2))};p.t9a=function(){this.zb=!1;var a=this.F&&0<this.F.length?this.F:this.V;""!=this.Xa&&(Li(this.Z,this.Xa),this.Xa="");this.dispatchEvent(new guc(this.C,a||[]))};function fuc(a,b){return a.De.cd(IU.Qa(),b)}
function buc(a,b,c){b=b.clone();dc(Ig,function(a){for(var d=!0;d&&b;){for(var f=Mg(a),h=0;h<(f?b.width:b.height);h++){var k=oh(b,a),l=f?b.jc():b.qc(),k=f?c.Lf(k,l+h):c.Lf(l+h,k);if(!oTb(k)&&k.Qr()){d=!1;break}}d&&(nha(b,-1,a),0==b.width||0==b.height)&&(b=null)}return!!b},a);return b}function $tc(a,b){return Vb(a,b,function(a,b){return hh(a,b)})}
function euc(a){var b=a.J.getActiveGrid();if(!b||!a.C||b.Jb()!=a.C.Yc)return null;for(var c=Uu(a.J).ek(),c=ub(c,Ha(gh,a.C.rect)),c=tb(c,Aa),d=ub(c,function(a){return new Yg(a.left-this.C.rect.left,a.top-this.C.rect.top,a.width,a.height)},a),b=new pg,e=new pg,f=0;f<d.length;f++){for(var h=0;h<d[f].width;h++)e.add(d[f].left+h);for(h=0;h<d[f].height;h++)b.add(d[f].top+h)}a=Ztc(a,c);return{rows:b.fd(),He:e.fd(),pQa:a}}
function Ztc(a,b){a.J.getActiveGrid();if(0==b.length)return!0;if(1!=b.length)return!1;b=b[0];if(ih(b)||0==b.Hh())return!0;a=rUa(Uu(a.J).Z,b.top,b.left);return b.equals(a)}function Xtc(a){var b=new ii;N(b,5,a.pb||null==a.ib||lw(a.Xb)?1:2);N(b,6,!a.pb);N(b,11,dsa);return qi(oi(new ni,41),b).build()}function cuc(a,b){H.call(this,"cu");this.C=a;this.F=b}w(cuc,H);function guc(a,b){H.call(this,"ce");this.C=a;this.F=b}w(guc,H);function duc(a,b){H.call(this,"cs");this.C=a;this.F=b}w(duc,H);function JW(a,b,c,d,e,f){sT.call(this,f);this.Ia=a;this.Bd=b.C;this.Ib=c;this.hf=d;this.Kb=e;this.bb=new HW(b,c,d,e,this.Ba());this.Wa(this.bb);this.L=new ZU(!1,"#4285f4");this.Wa(this.L);this.J=null;this.Ac=this.gc=!1;this.Qb=!0;this.Mb=Ji.getInstance();this.ib=this.gb="";this.Oa=oi(new ni,10).build()}w(JW,sT);p=JW.prototype;p.Ga=function(){JW.$.Ga.call(this);this.Ka=S(huc,{PUb:Sm})};
p.Sa=function(){JW.$.Sa.call(this);var a=this.$a("waffle-assistant-quicksum-panel");this.bb.mb(a);a=this.$a("waffle-assistant-spinner-container");this.L.render(a);this.getHandler().R(this,"close-sidebar",this.Ipa).R(this.Ia,Ttc.d2a,this.zpa).R(this.Ia,Ttc.b2a,this.ypa).R(this.Ia,Ttc.f_a,this.Xoa).R(this.Ia,Ttc.e_a,this.Woa).R(this.$a("waffle-assistant-scroll-pane"),"scroll",jjc(this.Owa,10,this));a=X.gP.isEnabled();this.jf(!a)};
p.resize=function(){var a=this.$a("waffle-assistant-sidepane-content"),a=Ap(a).height,b=this.$a("waffle-assistant-spinner-container");ip(b,"margin-top",a/2-16+"px")};p.qh=va;function iuc(a,b){var c=juc(a);0!=c.length&&(G(a.J),c=c.filter(function(a){return a instanceof aW}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.J=new IW(c,b,a.Kb,a.Ba()),a.J.render(),F(a,a.J),a.J.jf(a.Ac)))}p.jf=function(a){this.Ac=a;ep(this.Ka,"waffle-assistant-readonly",a);this.bb.jf(a);this.J&&!this.J.isDisposed()&&this.J.jf(a)};
p.setVisible=function(a){var b=this.kb();JW.$.setVisible.call(this,a);if(a&&!b){var c=auc(this.Ia,a);c?(b=new npc,N(b,1,nh(c,"r")),N(b,2,nh(c,"c")),c=c.Hh(),N(b,3,c),c=new ii,ai(c,4,b),b=qi(ri(this.Oa),c).build()):b=this.Oa;this.ib=Ki(this.Mb,uj.Lya,!1,b);this.L.setActive(!0);KW(this)}a||kuc(this,!0)};p.zpa=function(){this.kb()&&(kuc(this,!0),this.L.setActive(!0),KW(this))};p.ypa=function(){this.kb()&&(this.L.setActive(!1),KW(this))};
p.Xoa=function(a){this.kb()&&(this.Kb.C(2775,this.Oa),kuc(this,void 0,a.C,a.F),luc(this)||this.L.setActive(!0),KW(this),this.Qb=!1)};
p.Woa=function(a){if(this.kb()){this.Kb.C(2776,this.Oa);var b=a.F;0<b.length&&(this.gb=Ki(this.Mb,uj.Jya));kuc(this,!1);this.L.setActive(!1);a=a.C;for(var c=0;c<b.length;c++){var d=Ec(b[c],1);if(Zm&&5==d){this.Z=B(b[c],12);this.V=B(b[c],4,0);this.qa=B(b[c],11);muc(this);for(var d=this.V,e=!1,f=this.Pa.length-1;0<=f;f--){var h=this.Pa[f],k=d;h.Wh()&&h.Jb()==k.Jb()&&lpc(vh(h),vh(k))&&lpc(wh(h),wh(k))&&(e=!0,this.Pa.splice(f,1))}this.Pa.push(d);d=e;2!=this.Z||d||(this.O=new EW(this.zb,this.Ib,this.bd,
this.V,this.Z,this.qa),this.Wa(this.O),this.O.render(this.getElement()))}}for(c=0;c<this.D.length;c++){d=[];for(e=0;e<b.length;e++)f=Ec(b[e],1),this.D[c].zja(f)&&d.push(b[e]);0<d.length?this.D[c].Lwa(d,a):this.D[c].xW(!0)}b=juc(this);0<b.length&&this.gc&&(b[b.length-1].Ib=!0);this.gc=!1;KW(this);nuc(this);this.Owa()}};function KW(a){var b=luc(a),c=Dp(a.$a("waffle-assistant-quicksum-panel")),d=a.L.$b(),b=b||c||d;a=a.$a("waffle-assistant-empty-list");Q(a,!b)}p.Fc=va;p.Kta=va;p.xu=g("Kb");p.Fd=g("Ac");
p.Ipa=va;p.wKb=function(){""!=this.gb&&(Li(this.Mb,this.gb),this.gb="");""!=this.ib&&(Li(this.Mb,this.ib),this.ib="");this.Qb||(this.Kb.fc(2777,this.Oa),this.Qb=!0)};function huc(a){a=a||{};var b=V,c=or('<div class="waffle-assistant-replaceable-title">'+ouc()+"</div>");var d=d=a||{};var e=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+U(aqc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">Get insights instantly</div><div class="waffle-assistant-empty-list-body">');e=d.PUb?e+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
e+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";d=V(e+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');d=V(""+('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Edit</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
d+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));return b(U(CT(mr({title:c,bl:or(""+d),id:nr("autovis"),yO:nr("waffle-assistant-sidepanel"),Jea:nr("waffle-assistant-title"),l_:nr("waffle-assistant-sidepane-content")},a))))}
function ouc(){return V('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+U(aqc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+U("Explore")+"</div></div>")};function LW(a,b,c,d,e,f,h,k,l,m){JW.call(this,a,b,c,d,e,m);this.Me=f;this.zb=b;this.Xa=new R(this.Ba());this.Wa(this.Xa);this.Ca=new Itc;F(this,this.Ca);this.D=[];this.F=null;this.pb=new ms("",m,4);Lq(this.pb,2,!1);this.Wa(this.pb);this.bd=h;this.Ue=k;this.pe=l;this.V=null;this.Z=0;this.qa=null;this.Tb=new es("",new UV,this.Ba());this.Wa(this.Tb);this.Xb=new R(this.Ba());this.Wa(this.Xb);this.Kc=(new eL).build();F(this,this.Kc);Mt(this.Kc,this.Tb,X.l7);this.O=this.H=null;this.Pa=[]}w(LW,JW);
var MW={xE:"waffle-assistant-scroll-pane-feature-content",Zac:"waffle-assistant-empty-list",S0a:"waffle-assistant-features",U1a:"waffle-assistant-empty-list-learn-more",gha:"waffle-assistant-expanded-panel",EAa:"waffle-assistant-replaceable-title",dwc:"waffle-assistant-scroll-pane",k4a:"waffle-assistant-sidepane-tables-range",l4a:"waffle-sidebar-tables-bar",m4a:"waffle-assistant-tables-edit-range-button",DQ:"waffle-assistant-title"},puc={defaultHelpArticleId:"6280499"};p=LW.prototype;
p.Sa=function(){var a=this;LW.$.Sa.call(this);this.Xa.mb(this.$a(MW.gha));VV(this.C.Ka,"Close");Zm&&(this.Xb.mb(this.$a(MW.k4a)),muc(this),this.Tb.mb(this.$a(MW.m4a)));var b=this.zb.L.Ts();Sm&&($ra||"en"==GC(b))&&(b=new BW(this.Me,this.Ib,this.Bd,this.hf,this.xu(),this.Ca,this.zb,this.Ue,this.pe,this.Ba()),this.Wa(b),this.D.push(b));b=new stc(this.xu(),this.Ca,this.Ba());this.Wa(b);this.D.push(b);b=new dW(this.Bd,this.Ib,this.xu(),this.Ca,this.Ba());this.Wa(b);this.D.push(b);var c=this.$a(MW.S0a);
x(this.D,function(b){b.render(c);a.Xa.Wa(b.C,!0)});this.pb.mb(this.$a(MW.U1a));this.getHandler().R(this.pb,"action",this.w1b).R(this,"te",this.Nja);quc(this)};p.w1b=function(){P.Ho.Cc(puc)};function nuc(a){x(a.D,function(a){iqc(a)})}function kuc(a,b,c,d){x(a.D,function(a){a.xW(b,c,d)})}function luc(a){return!!yb(a.D,function(a){return a.Upa()})}
p.Owa=function(){var a=this,b=this.$a("waffle-assistant-scroll-pane").scrollTop+Ap(this.$a("waffle-assistant-sidepane-content")).height;x(this.D,function(c){a.F&&a.F!=c||(c instanceof dW&&a.getHandler().Jc(c,"oe",a.wKb),b=c.Nwa(b))})};function juc(a){if(a.F)return a.F.C.C;var b=[];x(a.D,function(a){Ob(b,hqc(a))});return b}p.jf=function(a){LW.$.jf.call(this,a);quc(this)};p.qh=function(a){x(this.D,function(b){b.qh(a)})};p.Kta=function(){var a=this.$a(MW.EAa),b=this.$a(MW.DQ);zp(b,Ap(a).height)};
p.Fc=function(){var a=this,b=this.$a(MW.xE),c=this.$a(MW.EAa),d=this.Xa.Ka;if(this.F)this.F.C.setVisible(!1),this.F.setActive(!1),this.F=null,Q(b,!0),Q(d,!1),cr(c,ouc),Wo(c,"label"),this.resize();else if(this.F=yb(this.D,function(a){return a.$b()}))Q(b,!1),Q(d,!0),this.F.C.setVisible(!0),jqc(this.F,c),Yo(c,this.F.Z4());this.Kta();b=new Ek(function(){var b=tu;b&&b.dispatchEvent("resize");a.Owa()},300);F(this,b);b.start()};
p.setVisible=function(a){var b=this.kb();LW.$.setVisible.call(this,a);a&&!b&&ruc(this,!0);a||this.Ca.clear()};p.Ipa=function(){LW.$.Ipa.call(this);this.F&&this.Fc();this.Nja()};p.zpa=function(){LW.$.zpa.call(this);ruc(this,!0)};p.ypa=function(){LW.$.ypa.call(this);ruc(this,!1)};p.Xoa=function(a){LW.$.Xoa.call(this,a);ruc(this,!0,a.C)};p.Woa=function(a){LW.$.Woa.call(this,a);ruc(this,!1)};
function suc(a,b){b?(zYb(a.H),a.H=new Btc(a.zb,a.Ib,a.bd,a.V,a.Z,a.qa,a.xu()),a.Wa(a.H),a.H.render(a.getElement())):a.H&&(a.removeChild(a.H,!0),G(a.H),a.H=null);(a=tuc(a))&&htc(a,b)}function quc(a){x(a.D,function(b){b.jf(a.Fd())})}function tuc(a){a=yb(a.D,function(a){return a instanceof BW});return null!=a?a:null}function ruc(a,b,c){x(a.D,function(a){c||eqc(a.C,b)});Zm&&(b&&(a.V=null,a.Z=0,a.qa=null,a.Nja()),muc(a))}
function muc(a){var b=a.$a(MW.l4a),c="";a.V&&0==a.qa?(c=zh(a.V),c=mv(c),Q(b,!0)):Q(b,!1);b=S(ztc,{jW:c});a=a.Xb.Zb();Ml(a);a.appendChild(b)}p.Nja=function(){suc(this,!1);this.O&&(this.removeChild(this.O,!0),G(this.O));this.O=null;var a=tuc(this);a&&htc(a,!1)};function uuc(a,b,c,d,e,f,h,k,l,m,q,r){var v=this;yT.call(this,b,h);this.Z=a;this.C=b;this.O=c;this.Ia=d;this.bb=e;this.L=f;this.J=c.C;this.Oa=this.Ca=!1;this.Kb=l;this.Xa=r;this.De=new th;this.F=null;vuc(this);X.o5.eb(!0);a=new Dia;N(a,6,wuc());b=new fi;ai(b,58,a);this.H=oi(pi(new ni,b),10).build();this.Pa=Ji.getInstance();this.qa=Ki(this.Pa,uj.Iya);a=new Ek(function(){return xuc(v,!1)},100);F(this,a);a.start()}w(uuc,yT);
function vuc(a){var b=Su(a.bb);a.Gf().R(a.Ia,"selectionChange",a.B1b).R(a.J,"M",a.z1b).R(b,"ea",a.xxb).R(a.C,"le",a.tmb).R(a.C,"ke",a.smb).R(a.C,"qe",a.CBb).R(a.C,"ne",a.Mnb).R(a.C,"pe",a.A1b).R(a.C,"ue",a.rEb).R(a.C,"re",a.dDb).R(a.C,"me",a.Rmb).R(a.C,"ve",a.C1b).R(a.Z,"cu",a.opb).R(a.C,"se",a.hDb);Fo(a.V,X.gP,Wn,a.rvb).subscribe(X.hP,"action",a.Omb).subscribe(X.p5,"action",a.cEb).subscribe(X.Kfa,"action",a.USa).subscribe(X.Ly,"action",a.czb).subscribe(X.l7,"action",a.nEb)}p=uuc.prototype;p.vh=function(){return X.Lfa};
p.Bu=function(){return X.wxa};p.hs=function(a){uuc.$.hs.call(this,a);X.p5.eb(a);xuc(this,!1);!this.Ca&&a&&(this.Ca=!0);Mn(this.Xa,{Lb:a})};p.D1=function(a){var b=this;this.C.Kta();var c=new Ek(function(){uuc.$.D1.call(b,a)},300);F(this,c);c.start()};p.qh=function(a){this.C.qh(a);this.Z.qh(a)};p.Omb=function(){var a=this.C.kb();this.vh().setVisible(!a);a?this.Kb.fc(2226,this.H):(this.C.focus(),this.Kb.fc(2253,this.H))};p.USa=function(){this.C.kb()||this.hs(!0)};
p.czb=function(){var a=tuc(this.C);a&&!a.$b()&&(this.USa(),jtc(a,"",!0))};p.cEb=function(a){iuc(this.C,a)};p.nEb=function(){suc(this.C,!0)};p.B1b=function(){xuc(this,!0)};function xuc(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.F&&c[0].equals(a.F)){a.F=null;return}}var d=a.C;d.kb()&&(Ktc(d.bb),KW(d));a.Z.update(!b,a.C.kb(),c)}
p.opb=function(a){""!=this.qa&&(Li(this.Pa,this.qa),this.qa="");var b=a.F||0;a=a.C;var c=!!a&&a.rect,d=(c=!!c&&c.Hh()>=Ura&&nh(c,"r")>=Wra&&nh(c,"c")>=Xra&&c.Hh()<=Vra)&&.6<=b;d!==this.Oa&&(this.Oa=d,X.o5.Cc(d));c&&a&&a.rect&&(c=.9<=b,d=1E3>=a.rect.Hh(),a=ritz_api.RitzModelApi.isFormsRegion(""+a.Yc,a.rect.top,a.rect.left,a.rect.height+a.rect.top,a.rect.width+a.rect.left),c=!this.C.kb()&&!this.Ca&&c&&d&&!lw(this.O),a=Lra&&a,d=Mra&&this.O.Fd(),c&&(a||d)&&(c=new Dia,N(c,1,b),N(c,2,a),N(c,3,d),N(c,5,
asa),N(c,6,wuc()),b=new fi,ai(b,58,c),b=pi(oi(new ni,10),b).build(),this.gDa(b)))};p.gDa=function(a){var b=this;this.C.gc=!0;var c=bWa(Uu(this.J));if(!ZUb.C&&!c){var d=a||this.H;this.vh().setVisible(!0);this.Kb.fc(2225,d);this.Kb.fc(2253,this.H);a=new Ek(function(){b.C.kb()||b.Kb.fc(2752,d)},5E3);F(this,a);a.start()}};function wuc(){switch(Yra){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}p.Rmb=function(){this.C.Fc()};
p.C1b=function(a){var b=a.C,c=B(b.D,4,0),d=parseInt(c.Jb(),10);this.F=zh(c);this.L.C(new RVb(d));ptc(b,c);this.Kb.fc(a.zk(),this.H)};p.z1b=function(){Tu(this.J)?(this.C.eb(!0),xuc(this,!1)):(this.vh().setVisible(!1),this.C.eb(!1))};p.rvb=function(){this.C.jf(!X.gP.isEnabled())};p.xxb=function(a){xuc(this,!1,BHa(a))};
p.tmb=function(a){var b=Uu(this.J),c=""+b.wc(),d=[],e=Oic(b);if(e){var b=new Ue,f=Ec(e,2);C(b,3,f);f=Ec(e,2);C(b,2,f);e=Ec(e,1);C(b,1,e);d.push(b)}b=a.C.pb;for(e=0;e<b.length;e++)f=new Ue,C(f,2,b[e]),d.push(f);this.L.C(new MU(d,c));this.Kb.C(a.zk(),this.H)};
p.smb=function(a){var b=a.C,c=Ijc(b.C),d=B(b.D,4,0),e=c.hv?c.Nx:null,f=c.C?c.ux:null,h=parseInt(d.Jb(),10),k=yuc(d);this.F=zh(d);k?this.L.C(new xT(k,h,this.F,e,c.Ms,c.Kt,f)):this.L.C(new vT(h,this.F,e,c.Ms,c.Kt,f));d=new ejc;N(d,1,1);c=new zS;b=B(b.D,2);N(c,2,b);ai(c,5,d);b=new fi;ai(b,46,c);b=pi(oi(new ni,10),b).build();this.Kb.C(a.zk(),b)};p.CBb=function(a){a=a.C;var b=B(a.D,4,0),c=parseInt(b.Jb(),10),d=yuc(b);this.F=zh(b);this.L.C(new wT(d,c));ptc(a,b)};
p.hDb=function(a){var b=Uu(this.O.C),c=b.wc(),b=xh(mIa(a.J,b),c);a=ttc(b,a.V,a.L);c=this.Z;Utc(c);Wtc(c,!0,!0,b,a)};function yuc(a){var b=a.Jb();a=zh(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.qc(),a.jc(),a.Lc(),a.Sc(),7,!1);return 0<b.length?b[0]:null}p.Mnb=function(a){XA(Uu(this.J),a.F);this.Kb.C(a.zk(),this.H)};
p.rEb=function(a){var b=a.C;a=a.zk();if(b instanceof tW||b instanceof wW)this.Kb.C(a,this.H);else{var c=juc(this.C),d=new zS,e=B(b.D,2),c=c.indexOf(b);N(d,1,c);N(d,2,e);e=new fi;ai(e,46,d);if(b instanceof aW){(d=b.H)?(b=zuc(this,b,d),b=nmc(b,d,d.vf())):b=null;if(!b)return;ai(e,39,b)}else if(b instanceof cW){var f=b.D,c=new wpc;if(b instanceof cW)b=1;else throw Error("Unknown text analysis card type.");f=Dc(B(f,8),20).slice(0,10);N(c,2,f||[]);N(c,1,b);ai(d,3,c)}e=pi(oi(new ni,10),e).build();this.Kb.C(a,
e)}};p.dDb=function(){this.C.Fc()};
p.A1b=function(a){var b=a.J;if(b){var c=Uu(this.J),d=a.Ve();d||(d=iB(this.Ia).ld().C.Ve());var e=16,f=16,h=a.Pa;h&&(e=h.x,f=h.y);h=ZZa(this.O.J);c={oid:null,ar:dB(c,d.y),ac:eB(c,d.x),x:e,y:f,h:py.height,w:py.width,p:{context:{chartName:"Chart "+(h+1)}}};c=new vC(Ou(this.J)||0,c,!1,!1);d=b.vf();e=new om(d);f=ym(e,"headers");f=null!=f&&qa(f)&&Va(f)?parseInt(f,10):-1;c.bb=f;c.Z=0;f="1"==ym(e,"transpose");c.Pa=f;c.L=f?"ROWS":"COLS";f=ym(e,"range");f=Sic(XS(f,","),this.J);c.nI(f);tS(c,b);(e=ym(e,"dt"))&&
JZa(c,this.De.cd(ef.Qa(),JSON.parse(decodeURIComponent(e))));this.Ia.dispatchEvent(new jD("objectRequest"));this.L.C(new XF(this.O,c));e=Auc(this,b,a.L,a.Sd());e.Wk(c.getId()||0);zU(this.Kb,a.zk(),e,10,b,d)}};function zuc(a,b,c){var d=juc(a.C).filter(function(a){return a instanceof aW});return Auc(a,c,d.indexOf(b),b.H&&b.H.Sd())}
function Auc(a,b,c,d){var e=new yU;a=juc(a.C).filter(function(a){return a instanceof aW}).map(function(a){return a.getChartType()});e.O=a;e.H=c;kmc(e,b.getChartType());e.F=d?d.clone():null;return e};function Buc(){E.call(this)}w(Buc,gn);Buc.prototype.C=function(){return Stc};Buc.prototype.F=function(){return LW};Buc.prototype.D=function(){return uuc};un("assistant",Buc);
