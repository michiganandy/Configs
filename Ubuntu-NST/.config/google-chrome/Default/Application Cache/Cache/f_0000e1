fi.prototype.ZS=fa(48,function(){return M(this,56)});function Wqd(a,b){var c=new YE,d;for(d in a.C)d in b.C||(c.C[d]=null);return c}function Xqd(a){a=a||{};return V(ZEa(mr({F_:nr("docs-icon-close-small")},a)))}
function Yqd(a){return V("<div "+(a.id?'id="'+W(a.id)+'"':"")+' class="'+(a.Cg?W(a.Cg)+" ":"")+'goog-flat-menu-button goog-flat-menu-button-disabled goog-inline-block" role="button" '+(a.Zt?'aria-label="'+W(a.Zt)+'"':"")+'><div class="goog-flat-menu-button-caption goog-inline-block">'+U(a.MB)+'</div><div class="goog-flat-menu-button-dropdown goog-inline-block" aria-hidden="true">&nbsp;</div>'+(a.wl?U(a.wl):"")+"</div>")}function Zqd(a){Wh(this,a,0,-1,null)}w(Zqd,Vh);
Zqd.prototype.getContext=function(){return M(this,1)};Zqd.prototype.setContext=function(a){N(this,1,a)};Zqd.prototype.gx=function(){N(this,1,void 0)};function $qd(a,b){Kn.call(this);this.F=a;this.D[a]=b}w($qd,Kn);$qd.prototype.C=function(a){var b={};b[this.F]=a;Mn(this,b)};function W5(){UC.call(this);this.C=new YE;VC(this,new SC(TC,{},{wordList:[]}));this.J=new rg;F(this,this.J)}w(W5,UC);wa(W5);W5.prototype.F=function(a){ard(this,a,!0)};function ard(a,b,c){var d=a.C.contains(b.toLowerCase()),e=b.toLowerCase();a.C.add(e);if(!d){var f={};f.value=e;WC(a).get("wordList").push(f);c&&brd(a,[b],[])}return!d}W5.prototype.L=function(a){crd(this,a,!0)};
function crd(a,b,c){var d=a.C.contains(b.toLowerCase());if(d){var e=b.toLowerCase();a.C.remove(e);for(var f=WC(a).get("wordList"),h=0;h<f.length;h++)if(f[h].value===e){f.splice(h,1);break}c&&brd(a,[],[b])}return d}W5.prototype.H=function(a){a=a.get("wordList");for(var b=0;b<a.length;b++)ard(this,a[b].value,!1);a.length&&this.J.dispatchEvent(null)};function brd(a,b,c){var d={};d.dictSAdd=b;d.dictSRemove=c;a.J.dispatchEvent(null);a.D.dispatchEvent(new YC(new XC("docs-user_dictionary",d),WC(a)))};function X5(a,b,c){zr.call(this,a,b,c);dq(this,"Preferences")}w(X5,zr);p=X5.prototype;p.Sa=function(){X5.$.Sa.call(this);this.getHandler().R(this,"dialogselect",this.b$a)};p.setVisible=function(a){X5.$.setVisible.call(this,a);a&&this.update()};p.update=va;p.b$a=function(a){"ok"==a.key&&this.XUa()};p.XUa=va;function drd(a){a='<b>"'+(U(a.DW)+'"</b> added to your personal dictionary.');return V(""+('<span class="docs-userdictionary-butterbar-item">'+a+"</span>"))}function erd(a){a='<b>"'+(U(a.DW)+'"</b> removed from your personal dictionary.');return V(""+('<span class="docs-userdictionary-butterbar-item">'+a+"</span>"))}
function frd(a){a=""+('<div class="docs-userdictionarydialog-content"><div class="docs-userdictionarydialog-top-container"><div><input class="docs-userdictionarydialog-input jfk-textinput" type="text" aria-label="'+W(a.OPa)+'" placeholder="'+W(a.OPa)+'"></div><div class="docs-userdictionarydialog-button-add-container">'+U(ls({Ce:"docs-userdictionarydialog-button-add",style:0,content:or("Add")}))+'</div></div><div class="docs-userdictionarydialog-list-container"></div></div>');return V(a)}
function grd(a){return V('<div class="docs-userdictionarydialog-row-container" role="option"><div title="'+W(a.DW)+'" class="docs-userdictionarydialog-row-content">'+U(a.DW)+"</div></div>")};function Y5(a,b){Dq.call(this,void 0,new hrd);this.dxa=a;this.C=b}w(Y5,Dq);Y5.prototype.Qp=ca();Y5.prototype.OT=function(a){a.relatedTarget&&Xl(this.C,a.relatedTarget)||Y5.$.OT.call(this,a)};Y5.prototype.Dj=function(a){return(46==a.keyCode||8==a.keyCode)&&this.Di(a)};function hrd(){}w(hrd,xq);hrd.prototype.Ec=n("docs-userdictionarydialog-row-container");hrd.prototype.Ga=function(a){return S(grd,{DW:a.dxa})};function Z5(a){ss.call(this,void 0,new ird);this.D=a;this.C=this.F=null}w(Z5,ss);p=Z5.prototype;p.Sa=function(){Z5.$.Sa.call(this);Yo(this.Ka,"Personal dictionary entries.  Press DELETE or BACKSPACE to remove words from the dictionary.");Uo(this.Ka,"listbox");var a=this.F;Q(a,!1);Fp(a,!0);this.C=new uq(a);this.getHandler().R(this,"action",this.Usa).R(this.F,"click",this.Usa).R(this.C,"key",this.onb)};p.od=function(){Z5.$.od.call(this);G(this.C);this.C=null};
function jrd(a){var b=[];a.Mf(function(a){b.push(a.dxa)});return b}p.Usa=function(){var a=vs(this),b=this.gk==this.kd()-1;xs(this);this.removeChild(a,!0);b||ys(this);krd(this);this.dispatchEvent("change")};p.onb=function(a){return 13==a.keyCode||32==a.keyCode?(this.Usa(),a.preventDefault(),a.stopPropagation(),!0):!1};p.xC=function(){0==this.Ui("docs-userdictionarydialog-row-container-hover").length&&ws(this)};p.cw=function(a){a.stopPropagation();a.preventDefault()};
p.fk=function(a){return 27==a.keyCode?!1:Z5.$.fk.call(this,a)};p.V0=function(a){Z5.$.V0.call(this,a);krd(this)};p.Rna=function(a){var b=fm(document);Z5.$.Rna.call(this,a);b&&$o(b,"docs-userdictionarydialog-list-remove-button")?this.Ka.focus():krd(this)};function krd(a){if(vs(a)){var b=vs(a),c=Math.round((Ap(b.Ka).height-Ap(a.F).height)/2);a.F.style.top=pp(b.Ka).y+c+"px";Yo(a.F,"Remove "+b.dxa);Q(a.F,!0)}else Q(a.F,!1)}function ird(){this.C=void 0}w(ird,rs);
ird.prototype.Tr=function(a){var b=S(Xqd,{enabled:!0,Cg:"docs-userdictionarydialog-list-remove-button"});a.F=b;a.getElement().appendChild(b)};function $5(a,b,c,d){X5.call(this,b,c,d);this.V=a;this.F=new ms(null,d);this.Wa(this.F);this.L=this.C=null;this.J=new Z5(a);this.Wa(this.J);this.O=null;dq(this,"Personal dictionary");a=qq((new lq).set("ok","Save",!0),tq,!1,!0);oq(this,a)}w($5,X5);p=$5.prototype;p.Ga=function(){$5.$.Ga.call(this);cr(this.Zb(),frd,{OPa:"Add a new word"});Xq(this,"ok");this.F.mb(this.$a("docs-userdictionarydialog-button-add"));this.J.mb(this.$a("docs-userdictionarydialog-list-container"));this.C=this.$a("docs-userdictionarydialog-input")};
p.Sa=function(){$5.$.Sa.call(this);this.F.eb(!1);this.L=new Yq(this.C);this.getHandler().R(this.F,"action",this.Alb).R(this.C,"keypress",this.Eab).R(this.L,"input",this.Dab).R(this.J,"change",this.Hqb);this.getHandler().R(this.F.getElement(),"focus",this.vla).R(this.C,"focus",this.vla);for(var a=iza(this.D),b=0;b<a.length;b++)this.getHandler().R(a[b],"focus",this.vla);this.O=new vI(this.J)};p.od=function(){$5.$.od.call(this);Hc(this.L,this.O);this.O=this.L=null};p.Alb=function(){lrd(this)};
p.Dab=function(){this.F.eb(!Ua(ib(this.C.value)))};p.Eab=function(a){13==a.keyCode&&(this.F.isEnabled()&&lrd(this),a.stopPropagation(),a.preventDefault())};p.vla=function(){this.J.hk(-1)};p.Hqb=function(){pq(this.D,"ok").disabled=!1};p.update=function(){var a=this.J;a.Gd(!0);var b=a.D.C.fd();b.sort(Dnc());for(var c=0;c<b.length;c++)a.Wa(new Y5(b[c],a.F),!0);mrd(this,"");pq(this.D,"ok").disabled=!0};
p.XUa=function(){var a=this.J;var b=new YE(a.D.C.fd());var c=new YE(jrd(a));a=Wqd(c,b).fd();b=Wqd(b,c).fd();for(var c=this.V,d=[],e=[],f=0;f<a.length;f++)ard(c,a[f],!1)&&d.push(a[f]);for(f=0;f<b.length;f++)crd(c,b[f],!1)&&e.push(b[f]);(0<d.length||0<e.length)&&brd(c,d,e)};
p.setVisible=function(a){$5.$.setVisible.call(this,a);if(a){var b=this.C;b&&(b.focus(),a=b.value.length,iGa(b)?(b.selectionStart=a,b.selectionEnd=a):Mc&&!Wc("9")&&(a=kGa(b,a),b=b.createTextRange(),b.collapse(!0),b.move("character",a),b.select()))}};function mrd(a,b,c){a.C.value=b;a.F.eb(!Ua(ib(a.C.value)));c&&a.C.select()}
function lrd(a){var b=a.J,c=a.C.value,c=c.toLowerCase().trim();-1==jrd(b).indexOf(c)&&(c=new Y5(c,b.F),b.$h(c,0,!0),b.Ka.scrollTop=0,b.dispatchEvent("change"));nm(a.Ba())==a.C&&a.C.blur();mrd(a,"");a.C.focus()};function nrd(a,b){var c=new $5(W5.getInstance());a.Aj(c);return Ha(ord,c,b)}function ord(a,b,c){a.setVisible(!0);b().setVisible(!1);c&&mrd(a,c,!0)};function prd(){E.call(this);this.C=new pg;this.D=new rg;F(this,this.D)}w(prd,E);function qrd(a,b,c){this.C=a;this.D=b;this.F=c||null}qrd.prototype.equals=function(a){return this.C.equals(a.C)&&this.D.equals(a.getSelection())};qrd.prototype.getSelection=g("D");function rrd(a,b){this.D=a;this.C=b};function srd(a,b,c){this.C=a;this.F=b;this.D=c||null}srd.prototype.Zv=g("F");function trd(a,b,c,d,e,f){this.F=a;this.L=b;this.C=c;this.D=d;this.H=e;this.J=f||null;this.Ra=new J(this);F(this,this.Ra)}w(trd,E);p=trd.prototype;p.Cab=function(a){var b=this.C.C;urd(this.D,a);a6(this,b,!0)};
p.Knb=function(a){var b=this.C.C,c=this.D,d=eb(a.C.Zv()),e=a.D;a=new uw;C(a,1,"\\b"+d+"\\b");C(a,3,e);C(a,6,!1);C(a,7,!1);C(a,8,!0);a.setType(2);C(a,11,0);var d=c.C.F;switch(c.C.Z){case "RANGE":C(a,5,0);a.setSelection(xh(d.rect,d.Yc));var f=Uy(c.D,d.Yc);break;case "SHEET":C(a,5,1);f=new Md;C(f,1,""+d.Yc);a.setSelection(f);f=Uy(c.D,d.Yc);break;case "WORKBOOK":C(a,5,2),f=c.D.v$(-1,0,!1)}f=f.Qc();c.F.C(new kV(f,a));a6(this,b,!0)};
p.Jub=function(a){var b=this.C.C;if(qa(a)){var c=this.L;c.C.contains(a.toLowerCase())||(c.C.add(a.toLowerCase()),c.D.dispatchEvent(null))}a6(this,b,!1)};p.xpb=function(a){var b=this.C.C;if(a instanceof qrd){var c=this.D.H,d=a.C.Zv();a=a.getSelection();if(!vrd(c,d,a)){var e=c.C[""+a.Yc];e||(e=Qu(c.D,a.Yc),e.getSheetType(),e=e.Qc(),e=new iz(e,!0),c.C[""+a.Yc]=e);c=a.Vc.y;a=a.Vc.x;var f=e.Cf(c,a);f||(f=new pg,jz(e,c,a,f));f.add(d.toLowerCase())}}a6(this,b,!1)};
p.Gzb=function(a){var b=this.C.C;qa(a)&&(this.J?this.J.F(a):W5.getInstance().F(a));a6(this,b,!1)};p.mMa=function(){P.Jha.zd(!1);this.Ra.Oc(this.F,"docs-text-spellcheckdialogcontroller-closed",this.mMa);wrd(this.D.C)};p.qLb=function(){a6(this,null,!1)};p.CNa=function(a){var b=this.F.C;Q(b.Oa,!1);Q(b.Pa,!0);var b=this.C,c=u(this.hYa,this,this.C.C,!1);this.H.C.getSelection();b.C&&(a?b.L.unshift(b.C):b.qa.push(b.C));xrd(b,c,!!a)};
function a6(a,b,c){var d=a.F.C;Q(d.Oa,!1);Q(d.Pa,!0);b=u(a.hYa,a,b,c);a.H.C.getSelection();xrd(a.C,b,!1)}
p.hYa=function(a,b){a=this.F;a.C.setVisible(!0);var c=a.C;Q(c.Oa,!0);Q(c.Pa,!1);var c=a.C,d=c.J.C;Fi(c.zb);var e=c.Ba().Hb("docs-slidingdialog-content",c.getElement());e&&Vo(e,"label",d?"Spellcheck":"No spelling suggestions");if(d){var e=d.C,f=c.Ba();c.getHandler().Oc(c.F,"focus",c.$Na).Oc(c.F,"blur",c.ZNa).Oc(c.O,"input",c.bOa).Oc(c.F,"keydown",c.aOa);c.H.fb("");var h=c.F;var k=h.cloneNode(!0);Ql(k,h);c.F=f.getElement("docs-spellcheckslidingdialog-replacement-input");if(!c.F)throw Error("Replacement input not in DOM.");
G(c.removeChild(c.H));c.H=new sO("",f);c.Wa(c.H);c.H.mb(c.F);G(c.O);c.O=new Yq(c.F);for(c.getHandler().R(c.F,"focus",c.$Na).R(c.F,"blur",c.ZNa).R(c.O,"input",c.bOa).R(c.F,"keydown",c.aOa);0<c.D.kd();)c.D.Hn(0).dispose();f="Next misspelling. Change "+(e.Zv()+" to:");Vo(c.F,"label",f);c.Ba().rf(c.bd,e.Zv());f=e.C;if(0==f.length)c.H.fb(e.Zv()),h=new Pq("No suggestions"),c.D.Wa(h,!0),h.Pf(2,!1),h.eb(!1),c.Xb.C(!1);else{c.H.fb(f[0]);for(e=0;e<f.length;e++)h=new Pq(f[e]),c.D.Wa(h,!0),c.getHandler().R(h,
"action",c.iGb).R(h.getElement(),"dblclick",c.dxb),1<f.length&&(h.Sq(!0),h=Cl("goog-menuitem-checkbox",h.Ka),ap(h,"goog-inline-block"));(e=c.D.qd(0))&&1<c.D.kd()&&e.vc(!0);c.D.hk(0);c.Xb.C(!0)}Gnc(c.bb,d.getSelection());c.EPb.call(c,0,-1);yrd(c.qa);c.DPb.call(c,-1);yrd(c.V);Q(c.pb,!1);Q(c.ib,!0)}else Q(c.ib,!1),Ml(c.Tb),c.Qb&&c.Tb.appendChild(c.Qb),Q(c.pb,!0),c.zb=Ei(u(c.Lu,c),c.gc),c.bb.gx();a.C.focus();(a=this.C.C)?zrd(this.D,a.getSelection()):b&&zrd(this.D)};function Ard(a,b,c,d,e,f){WU.call(this,f);this.L=a;this.J=b;this.Bd=e;this.bb=new Fnc(c);this.Wa(this.bb);this.Ca=new ms(null,f);this.Wa(this.Ca);this.V=new Fs(f);this.Ac=new Ls(null,this.V,qH.getInstance());this.Wa(this.Ac);this.gb=new ms(null,f);this.Wa(this.gb);this.qa=new Fs(f);this.Kc=new Ls(null,this.qa,qH.getInstance());this.Wa(this.Kc);this.Ib=this.Ia=this.Z=null;this.H=new sO("",f);this.Wa(this.H);this.D=new Brd(f);Gs(this.D,!1);this.Wa(this.D);this.Qb=this.Tb=this.pb=this.ib=this.O=this.F=
null;this.gc=5E3;this.zb=this.bd=null;this.Xb=d;this.Oa=this.Pa=this.Xa=null}w(Ard,WU);function yrd(a){bp(a.Ka,["goog-menu-no-icon","goog-menu-noaccel"])}p=Ard.prototype;
p.Cla=function(){var a=nr("Spellcheck");var b=""+('<div id="docs-spellcheckslidingdialog-loading"><div class="docs.spellcheckslidingdialog-loading-text">Loading spelling suggestions...</div><div class="docs-spellcheckslidingdialog-loading-spinner">'+U(Bnc())+'</div></div><div id="docs-spellcheckslidingdialog-content"><div id="docs-spellcheckslidingdialog-no-misspellings" tabindex="-1"><div class="docs-spellcheckslidingdialog-title-text docs-spellcheckslidingdialog-no-misspellings">No spelling suggestions</div><div id="docs-spellcheckslidingdialog-no-misspellings-footer"></div></div><div id="docs-spellcheckslidingdialog-misspellings"><div class="docs-spellcheckslidingdialog-title-text goog-inline-block">Change <span id="docs-spellcheckslidingdialog-original-word"></span> to:</div><div class="docs-spellcheckslidingdialog-container"><table cellspacing="0" role="presentation"><tbody><tr><td class="docs-spellcheckslidingdialog-replacement-input-container"><input id="docs-spellcheckslidingdialog-replacement-input" autocomplete="off" type="text" class="docs-spellcheckslidingdialog-replacement-input" spellcheck="false"></input>'+U(Cnc({id:"docs-spellcheckslidingdialog-replacement-context"}))+
"</td><td>"+U(ls({id:"docs-spellcheckslidingdialog-button-change",style:2,Ce:"docs-spellcheckslidingdialog-buttons-action",content:or("Change")}))+U(Yqd({id:"docs-spellcheckslidingdialog-button-change-menu",MB:""}))+'</td></tr><tr><td><div id="docs-spellcheckslidingdialog-suggestion-list"></div></td><td id="docs-spellcheckslidingdialog-ignore-buttons">'+U(ls({id:"docs-spellcheckslidingdialog-button-ignore",style:0,Ce:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",
content:or("Ignore")}))+U(Yqd({id:"docs-spellcheckslidingdialog-button-ignore-menu",Cg:"docs-spellcheckslidingdialog-buttons-white-menu",MB:""}))+"<br/>"+U(ls({id:"docs-spellcheckslidingdialog-button-dictionary",style:0,Ce:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",content:or("Add to Dictionary")}))+U(Yqd({id:"docs-spellcheckslidingdialog-button-dictionary-menu",Cg:"docs-spellcheckslidingdialog-buttons-white-menu",MB:""}))+"</td></tr></tbody></table></div></div></div>");
b=V(b);a=""+U(anc({iFa:a,bl:or(""+b)}));return V(a)};p.m$=function(){var a=this.J.C,b=a?a.C.ZS():null,c=this.Bd.C.replace(/_/g,"-"),d=a?a.F:null,e=Dg(K(),"docs-anddc"),f=new fi;Ua(ib(b))||N(f,56,b);N(f,60,c);e&&d&&(b=new Zqd,a=a.C.C,0<a.length&&N(b,2,a[0]),b.setContext(d.mDc()),a=d.nib().start,N(b,3,a),d=d.nib().end,N(b,4,d),ai(f,66,b));return pi(oi(new ni,1),f).build()};
p.Sa=function(){Ard.$.Sa.call(this);ap(this.Ka,"docs-spellcheckslidingdialog");var a=this.Ba();this.Pa=a.getElement("docs-spellcheckslidingdialog-loading");this.Oa=a.getElement("docs-spellcheckslidingdialog-content");this.pb=a.getElement("docs-spellcheckslidingdialog-no-misspellings");this.Tb=a.getElement("docs-spellcheckslidingdialog-no-misspellings-footer");this.ib=a.getElement("docs-spellcheckslidingdialog-misspellings");this.F=a.getElement("docs-spellcheckslidingdialog-replacement-input");this.O=
new Yq(this.F);this.bd=a.getElement("docs-spellcheckslidingdialog-original-word");this.bb.mb(a.getElement("docs-spellcheckslidingdialog-replacement-context"));this.H.mb(this.F);this.Ca.mb(a.getElement("docs-spellcheckslidingdialog-button-change"));this.gb.mb(a.getElement("docs-spellcheckslidingdialog-button-ignore"));Crd(this.Ac,this.Ca,"docs-spellcheckslidingdialog-button-change-menu",P.Mha,this.L,a);Crd(this.Kc,this.gb,"docs-spellcheckslidingdialog-button-ignore-menu",P.Oha,this.L,a);this.D.mb(a.getElement("docs-spellcheckslidingdialog-suggestion-list"));
this.D.Ri(!0);yrd(this.D);Mt(this.L,this.gb,P.j6,Nt,u(this.J.Oa,this.J),u(this.m$,this));Mt(this.L,this.Ca,P.JW,Nt,u(this.djb,this),u(this.m$,this));this.Z=new ms(null,this.Ba());this.Ia=new Fs(a);this.Ib=new Ls(null,this.Ia,qH.getInstance(),a);this.Wa(this.Z);this.Wa(this.Ib);this.Z.mb(a.getElement("docs-spellcheckslidingdialog-button-dictionary"));Drd(this,this.Z,P.K6,!0);Crd(this.Ib,this.Z,"docs-spellcheckslidingdialog-button-dictionary-menu",P.Nha,this.L,a);var a=new Pq("View personal dictionary..."),
b=rc(Nt);delete b["node-label"];delete b.label;Mt(this.L,a,P.kF,b,u(this.h$,this,this.J));this.Ia.Wa(a,!0);yrd(this.Ia);this.getHandler().R(this.D.getElement(),Mc?Wba:"focus",this.KEb);this.Xa=new Ho(this.getElement());F(this,this.Xa);a=sxa("Ctrl+single-quote",!1);b=sxa("Ctrl+semicolon",!1);wxa(this.Xa,P.i7,[a]);wxa(this.Xa,P.j7,[b])};p.focus=function(){Dp(this.ib)?this.H.Tl():this.pb.focus()};
function Crd(a,b,c,d,e,f){c=f.getElement(c);a.mb(c);xS(a,1);CTb(a,b.getElement());xS(b,2);b=new Wr(c,a.Sf()?1:5);Uhc(a,b);Mt(e,a,d,Nt)}p.DPb=function(a){for(;0<this.V.kd();)this.V.Hn(0).dispose();var b=Hl("SPAN","docs-spellcheckslidingdialog-menu-text","Change all");a=Hl("SPAN","docs-spellcheckslidingdialog-count",0>a?"":"("+(a+" found)"));var c=[];c.push(b);c.push(a);b=new Pq(c);Mt(this.L,b,P.m5,void 0,u(this.O8a,this),u(this.m$,this));this.V.Wa(b,!0)};
p.EPb=function(a,b){for(;0<this.qa.kd();)this.qa.Hn(0).dispose();a=Hl("SPAN","docs-spellcheckslidingdialog-menu-text","Ignore all");b=Hl("SPAN","docs-spellcheckslidingdialog-count",0>b?"":"("+(b+" found)"));var c=[];c.push(a);c.push(b);a=new Pq(c);Drd(this,a,P.k6,!1);this.qa.Wa(a,!0)};function Erd(a){var b=a.H.Za();a=new srd(b,a.h$(a.J),a.J);P.JW.Cc(a)}p.dxb=function(){Erd(this)};p.$Na=function(){var a=this.Ba().Vs(this.F);ap(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};
p.ZNa=function(){var a=this.Ba().Vs(this.F);cp(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};p.aOa=function(a){13==a.keyCode&&Erd(this)};p.KEb=function(){for(var a=0;a<this.D.kd();a++){var b=this.D.qd(a);if(b.isChecked()){b.Hg(!0);return}}0<this.D.kd()&&this.D.hk(0)};function Frd(a){for(var b=0;b<a.D.kd();b++)a.D.qd(b).vc(!1)}p.bOa=function(){Frd(this);this.Xb.C(!0)};p.iGb=function(a){var b=a.target.Za();Frd(this);this.H.fb(b);(a=a.target)&&1<this.D.kd()&&a.vc(!0);this.H.Tl()};
p.djb=function(){var a=this.H.Za();return new srd(a,this.h$(this.J),this.J)};p.O8a=function(){var a=this.J,a=a.C?a.C.C:null;return new rrd(this.H.Za(),a)};function Drd(a,b,c,d){Mt(a.L,b,c,d?Nt:void 0,u(a.h$,a,a.J),u(a.m$,a))}p.h$=function(a){return(a=a.C)?a.C.Zv():null};p.Ja=function(){Fi(this.zb);G(this.O);Ard.$.Ja.call(this)};function Brd(a,b){Fs.call(this,a,b)}w(Brd,Fs);Brd.prototype.fk=function(a){return 27==a.keyCode?!1:Brd.$.fk.call(this,a)};function Grd(a,b){this.H=a;this.C=b;this.D=0}Grd.prototype.F=function(a){this.H.F(a);a=Gr(S(drd,{DW:a}),P.Kn.getLabel(),u(this.L,this,a),"info",!0,1E4);Er(this.C,this.D);this.D=this.C.postMessage(a)};Grd.prototype.L=function(a){this.H.L(a);a=Gr(S(erd,{DW:a}),P.Kn.getLabel(),u(this.F,this,a),"info",!0,1E4);Er(this.C,this.D);this.D=this.C.postMessage(a)};function Hrd(a,b,c,d,e,f,h){I.call(this);this.Db=a;this.H=b;this.J=c;this.D=e;this.ob=h||new xl;this.C=new Ard(this.H,this.D,this.J,d,f,this.ob);F(this,this.C);this.Ra=new J(this);F(this,this.Ra)}w(Hrd,I);Hrd.prototype.F=function(){this.Ra.Oc(this.C,"close",this.F);this.dispatchEvent("docs-text-spellcheckdialogcontroller-closed");TCa(Ps.getInstance())||this.Db.Rb(3);if(!P.Zk.isEnabled()){var a=Dr.getInstance(),b=Fr("Spellcheck will be unavailable until you reconnect.","info",!0,1E4);a.postMessage(b)}};function Ird(a){E.call(this);this.D=a;this.C={};this.cb=new J(this);F(this,this.cb);this.cb.R(a,"X",this.F)}w(Ird,E);function vrd(a,b,c){if(a=a.C[""+c.Yc])if(c=a.Cf(c.Vc.y,c.Vc.x))return!!c.contains(b.toLowerCase());return!1}Ird.prototype.F=function(a){G(this.C[""+a.Si]);delete this.C[""+a.Si]};function b6(){A.call(this)}w(b6,A);var Jrd=null;b6.prototype.rangeCount=function(){return zc(this,2)};function c6(){A.call(this)}w(c6,A);var Krd=null;c6.prototype.wc=function(){return B(this,1)};function d6(){A.call(this)}w(d6,A);var Lrd=null;function e6(){A.call(this)}w(e6,A);var Mrd=null;e6.prototype.JL=function(){return B(this,2)};function f6(){A.call(this)}w(f6,A);var Nrd=null;f6.prototype.Zv=function(){return B(this,1)};f6.prototype.ZS=function(){return B(this,5)};
b6.prototype.Qa=function(){var a=Jrd;a||(Jrd=a=Fc(b6,{0:{name:"SpellcheckRequest",Nb:"ritzproto.SpellcheckRequest"},1:{name:"start_searching_column",Ma:5,type:Number},2:{name:"range",Ma:11,type:Md},3:{name:"search_all_sheets",Ma:8,type:Boolean},4:{name:"active_filter_views",Uc:!0,Ma:11,type:c6}}));return a};b6.Qa=b6.prototype.Qa;
c6.prototype.Qa=function(){var a=Krd;a||(Krd=a=Fc(c6,{0:{name:"FilterViewDataProto",Nb:"ritzproto.FilterViewDataProto"},1:{name:"grid_id",Ma:9,type:String},2:{name:"filter_view_id",Ma:9,type:String}}));return a};c6.Qa=c6.prototype.Qa;
d6.prototype.Qa=function(){var a=Lrd;a||(Lrd=a=Fc(d6,{0:{name:"SpellcheckResponse",Nb:"ritzproto.SpellcheckResponse"},1:{name:"last_row_searched",Ma:5,type:Number},2:{name:"last_column_searched",Ma:5,type:Number},3:{name:"last_grid_id_searched",Ma:9,type:String},4:{name:"searched_all_sheets",Ma:8,type:Boolean},6:{name:"searched_whole_range",Ma:8,type:Boolean},5:{name:"cell_suggestions",Uc:!0,Ma:11,type:e6}}));return a};d6.Qa=d6.prototype.Qa;
e6.prototype.Qa=function(){var a=Mrd;a||(Mrd=a=Fc(e6,{0:{name:"CellSuggestionsProto",Nb:"ritzproto.CellSuggestionsProto"},1:{name:"phrase_suggestions",Uc:!0,Ma:11,type:f6},2:{name:"cell",Ma:11,type:be}}));return a};e6.Qa=e6.prototype.Qa;
f6.prototype.Qa=function(){var a=Nrd;a||(Nrd=a=Fc(f6,{0:{name:"PhraseSuggestionsProto",Nb:"ritzproto.PhraseSuggestionsProto"},1:{name:"original_word",Ma:9,type:String},2:{name:"offset_start_index",Ma:5,type:Number},3:{name:"offset_end_index",Ma:5,type:Number},4:{name:"suggestions",Uc:!0,Ma:9,type:String},5:{name:"spelling_language",Ma:9,type:String}}));return a};f6.Qa=f6.prototype.Qa;function Ord(a,b,c){this.D=a;this.F=c||null;this.C=b}Ord.prototype.Zv=g("D");Ord.prototype.ZS=g("F");Ord.prototype.equals=function(a){var b=a.Zv(),c=a.ZS();a=a.C;return this.D==b&&this.F==c&&Vb(this.C,a)};function Prd(a,b,c){this.Vc=a;this.Yc=b;this.zg=c}Prd.prototype.equals=function(a){return this===a?!0:a instanceof Prd?Og(a.Vc,this.Vc)&&a.Yc==this.Yc&&Qga(a.zg,this.zg):!1};function g6(a,b,c,d,e){this.H=a;this.gb=b;this.ib=c;this.bb=d;this.Xa=e;this.D=this.J=this.C=null;this.O=!1;this.L=[];this.qa=[];this.cb=new J(this);F(this,this.cb);this.V=null;this.Z="RANGE";this.Ia=new th;this.Ia.tv=!0;this.Ca=new th;this.Ca.tv=!1}w(g6,E);g6.prototype.Oa=g("C");
function wrd(a,b,c){PC(a.V);a.cb.Ic();a.Z=b;a.F=c;a.O=!1;a.L=[];a.qa=[];switch(b){case "WORKBOOK":a.J=new Ng(-1,0);(b=a.H.v$(-1,0,!1,!0))?a.D=""+b.Jb():(a.D=null,a.O=!0);break;case "SHEET":a.J=new Ng(-1,0);a.D=""+c.Yc;break;case "RANGE":a.J=new Ng(c.rect.left-1,c.rect.top),a.D=""+c.Yc}}function Qrd(a,b){var c=b.getSelection(),d=Uy(a.H,c.Yc),e;(e=!d)||(d=d.Qc(),e=c.Vc,e=!(IA(Ev(d,"r"),e.y)&&IA(Ev(d,"c"),e.x)));if(e)return!1;c=c.zg;a=Rrd(a,b);b=b.C.Zv();return a.substring(c.start,c.end)==b}
function Rrd(a,b){a=Srd(a,b);return Na(a,"'")?a.substring(1):a}function Trd(a,b){a=Srd(a,b);return Na(a,"'")}function Srd(a,b){b=b.getSelection();var c=b.Vc,d=b.Yc;a=Uy(a.H,d).Qc();a.Qt(dh(b.Vc));return Bv(a.Lf(c.y,c.x),d,c.y,c.x)}
function Urd(a,b){if(a.D){var c=new b6,d=new Md;C(d,1,a.D);C(d,2,a.J.y);switch(a.Z){case "WORKBOOK":C(c,3,!0);Od(d,0);var e=V_a(a.H);for(var f=0;f<e.length;f++)0==e[f].getSheetType()&&Vrd(c,e[f]);break;case "SHEET":Od(d,0);e=Uy(a.H,a.F.Yc);Vrd(c,e);break;case "RANGE":Od(d,a.F.rect.jc()),Nd(d,a.F.rect.Lc()),Pd(d,a.F.rect.Sc()),e=Uy(a.H,a.F.Yc),Vrd(c,e)}C(c,2,d);C(c,1,a.J.x+1);Pj(Qj(Bk(Rj(a.gb.Tf("/spell"),{data:a.Ia.serialize(c)}),"POST"),function(a){this.Pk(a,b)},a),function(){this.Pk(null,b)},a).$e()}else Wrd(a,
b,!1)}function Vrd(a,b){if(b){var c=b.Qc().H;if(Vu(c)){b=""+b.Jb();var c=Yu(c),d=new c6;C(d,1,b);C(d,2,c);Ac(a,4,d)}}}
g6.prototype.Pk=function(a,b){if(a){a=this.Ca.cd(d6.Qa(),a.vg());this.J=new Ng(B(a,2),B(a,1));this.D=B(a,3);this.O=B(a,6);a=Dc(a,5);for(var c=0;c<a.length;c++)for(var d=a[c],e=d.JL().Fz(),f=d.JL().getColumnIndex(),e=new Ng(f,e),f=parseInt(d.JL().Jb(),10),d=Dc(d,1),h=0;h<d.length;h++){var k=d[h],l=k.Zv(),m=B(k,2),q=B(k,3),r=k.ZS(),m=new Prd(e,f,new Rg(m,q));Xrd(this,l,m)||(k=Dc(k,4),this.L.push(new qrd(new Ord(l,k,r),m)))}}xrd(this,b,!1)};
function xrd(a,b,c){if(c){var d=a.qa;var e=u(d.pop,d)}else d=a.L,e=u(d.shift,d);for(;0<d.length;){var f=e(),h=f.C.Zv();if(!Xrd(a,h,f.getSelection())){e=c;h=f.getSelection();c=Uy(a.H,h.Yc);d=c.Qc();h=dh(h.Vc);f=u(a.Pa,a,f,b,e);d.Qt(h)?f():(PC(a.V),a.V=ez(c.D,h).addCallback(f));return}}Wrd(a,b,c)}function Wrd(a,b,c){a.O||c?(a.C=null,b(null)):Urd(a,b)}g6.prototype.Pa=function(a,b,c){Qrd(this,a)?(this.C=a,b(a.C)):xrd(this,b,c)};
function Xrd(a,b,c){return a.bb.C.contains(b.toLowerCase())||vrd(a.Xa,b,c)||a.ib.C.contains(b.toLowerCase())}g6.prototype.Ja=function(){g6.$.Ja.call(this);PC(this.V)};function Yrd(a,b,c,d){this.D=a;this.F=b;this.C=c;this.H=d}
function urd(a,b){var c=b.D.C;if(Qrd(a.C,c)){var d=c.getSelection(),e=d.Yc,f=d.zg,h=Uy(a.D,e).Qc(),k=Trd(a.C,c),c=Rrd(a.C,c),l=new aG(h,dh(d.Vc),(k?"'":"")+c.substring(0,f.start)+b.C+c.substring(f.end));Wx(l,u(function(a){if(a){a=this.C;for(var c=b.C,e=0;e<a.L.length;e++){var f=a.L[e].getSelection();if(Og(f.Vc,d.Vc)&&f.Yc==d.Yc&&f.zg.start>d.zg.end){var h=Sg(d.zg)-c.length;f.zg.start-=h;f.zg.end-=h}}}},a));sS(a.D,new qh(e,"",dh(d.Vc)),u(function(){this.F.C(l)},a))}}
function zrd(a,b){b&&sS(a.D,new qh(b.Yc,"",dh(b.Vc)))};function Zrd(a){this.qn=new Hnc(a)}Zrd.prototype.C=function(a){var b=new yf,c=new Md;C(c,2,a.Vc.y);Nd(c,a.Vc.y+1);Od(c,a.Vc.x);Pd(c,a.Vc.x+1);C(c,1,""+a.Yc);Ac(b,2,c);c=new be;C(c,1,""+a.Yc);C(c,2,a.Vc.y);C(c,3,a.Vc.x);C(b,1,c);return this.qn.C(new Ah(b))};function $rd(a,b,c,d,e,f,h,k){UU.call(this,"docs-spellcheckslidingdialog-id",c,u(this.Fwa,this));this.qa=a;this.Oa=new Grd(W5.getInstance(),Dr.getInstance());this.Z=new prd;this.V=new Ird(a);this.H=new g6(a,e,W5.getInstance(),this.Z,this.V);this.Ia=new Yrd(a,b,this.H,this.V);b=wl();a=new Hrd(c,(new eL).build(),new Zrd(a),new $qd("trigger-text",!1),this.H,k,b);F(this,a);this.O=a.C;this.D=new trd(a,this.Z,this.H,this.Ia,d,this.Oa);this.F=b.Ga("DIV",{style:"margin-top: 10px"});this.J=QN("Search the rest of the sheet",
b);this.J.render(this.F);this.getHandler().R(this.J,"action",this.DTb);this.L=QN("Search all sheets",b);this.L.render(this.F);this.getHandler().R(this.L,"action",u(this.Fwa,this,"WORKBOOK"));ZC(h,W5.getInstance(),"docs-user_dictionary");P.j6.subscribe("action",this.D.xpb,this.D);P.k6.subscribe("action",this.D.Jub,this.D);P.K6.subscribe("action",this.D.Gzb,this.D);P.JW.subscribe("action",this.D.Cab,this.D);P.m5.subscribe("action",this.D.Knb,this.D);P.i7.subscribe("action",u(this.D.CNa,this.D,!1));
P.j7.subscribe("action",u(this.D.CNa,this.D,!0));P.kF.setVisible(!0);P.kF.subscribe("action",nrd(f,Pf(this.O)))}w($rd,UU);p=$rd.prototype;p.B0=g("O");p.By=function(){$rd.$.By.call(this);this.getHandler().R(this.C,"close",this.b0b).R(this.qa,"ba",this.c0b)};p.b0b=function(){this.kG()};p.c0b=function(){this.C.Lu();this.kG()};
p.Fwa=function(a,b){var c=b||null,d;a||((b=this.qa.C)?0==b.getSheetType()?(c=b.Qc().Pc(),1<c.Hh()?(a="RANGE",c=new qh(b.Jb(),b.C,c)):(a="SHEET",c=new qh(b.Jb(),b.C,null))):a="WORKBOOK":a="WORKBOOK");"WORKBOOK"!=a&&(d=15E3);switch(a){case "RANGE":this.J.setVisible(!0);this.L.setVisible(!0);Q(this.F,!0);break;case "SHEET":this.J.setVisible(!1);this.L.setVisible(!0);Q(this.F,!0);break;case "WORKBOOK":Q(this.F,!1)}wrd(this.H,a,c);a=this.O;a.Qb=this.F;a.gc=d?d:5E3;a=this.D;P.Jha.zd(!0);a.Ra.R(a.F,"docs-text-spellcheckdialogcontroller-closed",
a.mMa);d=a.F;a=u(a.qLb,a);b=d.D.C;d.C.mc()||d.C.render(gm(d.ob,"docs-spellcheckslidingdialog-id"));(c=d.C.kL)&&b?d.C.focus():(c||d.Ra.R(d.C,"close",d.F),a())};p.DTb=function(){var a=this.H.F;this.Fwa("SHEET",new qh(a.Yc,a.wi,null))};function asd(){E.call(this)}w(asd,gn);asd.prototype.C=function(a,b,c,d,e,f,h,k){return new $rd(a,b,c,d,e,f,h,k)};un("spellcheck",asd);
